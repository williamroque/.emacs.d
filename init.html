<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-11-22 Tue 11:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs Config</title>
<meta name="author" content="William Aguiar Roque" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
<!--/*--><![CDATA[/*><!--*/
@font-face {
  font-family: 'RomanAlternate';
  src: local('Times New Roman');
  unicode-range: U+0026;
}

@font-face {
    font-family: 'Ampersand';
    src: local('Fira Code');
	unicode-range: U+0370-03FF, U+1F00-1FFF;
}

body {
    padding: 0;
    margin: 0;
    flex-direction: column;
    display: flex;
    align-items: center;
}

h1.title {
    background: #121112;
    color: #ffffff;
    padding: 10px;
    text-align: center;
    margin: 0;
    width: 100%;
}

div#content {
    width: 96%;
    padding: 30px;
    max-width: 800px;
}

#content div:first-child h2 {
    margin-top: 0;
}

body .anchor {
    float: left;
    line-height: 1;
    margin-left: -20px;
    padding-right: 4px;
}

body .anchor:focus {
    outline: none;
}

body h1:hover .anchor,
body h2:hover .anchor,
body h3:hover .anchor,
body h4:hover .anchor,
body h5:hover .anchor,
body h6:hover .anchor {
    text-decoration: none;
}

body {
    -ms-text-size-adjust: 100%;
    -webkit-text-size-adjust: 100%;
    line-height: 1.5;
    color: #24292e;
    font-family: 'Optima', 'Noto Serif Hebrew';
    font-size: 16px;
    line-height: 1.5;
    word-wrap: break-word;
}

body details {
    display: block;
}

body summary {
    display: list-item;
}

body a {
    background-color: initial;
}

body a:active,
body a:hover {
    outline-width: 0;
}

body strong {
    font-weight: inherit;
    font-weight: bolder;
}

body h1 {
    font-size: 2em;
    margin: .67em 0;
}

body img {
    border-style: none;
}

body code,
body kbd,
body pre {
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 1em;
}

body hr {
    box-sizing: initial;
    height: 0;
    overflow: visible;
}

body input {
    font: inherit;
    margin: 0;
}

body input {
    overflow: visible;
}

body [type=checkbox] {
    box-sizing: border-box;
    padding: 0;
}

body * {
    box-sizing: border-box;
}

body input {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
}

body a {
    color: #0366d6;
    text-decoration: none;
}

body a:hover {
    text-decoration: underline;
}

body strong {
    font-weight: 600;
}

body hr {
    height: 0;
    margin: 15px 0;
    overflow: hidden;
    background: transparent;
    border: 0;
    border-bottom: 1px solid #dfe2e5;
}

body hr:after,
body hr:before {
    display: table;
    content: "";
}

body hr:after {
    clear: both;
}

body table {
    border-spacing: 0;
    border-collapse: collapse;
}

tbody {
    border-bottom: solid 2px #b0b0b0;
}

body td,
body th {
    padding: 0;
}

body details summary {
    cursor: pointer;
}

body kbd {
    display: inline-block;
    padding: 3px 5px;
    font: 11px 'Ampersand', 'Victor Mono';
    line-height: 10px;
    color: #444d56;
    vertical-align: middle;
    background-color: #fafbfc;
    border: 1px solid #d1d5da;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #d1d5da;
}

body h1,
body h2,
body h3,
body h4,
body h5,
body h6 {
    margin-top: 0;
    margin-bottom: 0;
    font-weight: normal !important;
    page-break-after: avoid !important;
}

body h1 {
    font-size: 32px;
}

body h1,
body h2 {
    font-weight: 600;
}

body h2 {
    font-size: 24px;
}

body h3 {
    font-size: 20px;
}

body h3,
body h4 {
    font-weight: 600;
}

body h4 {
    font-size: 16px;
}

body h5 {
    font-size: 14px;
}

body h5,
body h6 {
    font-weight: 600;
}

body h6 {
    font-size: 12px;
}

body blockquote {
    margin: 0;
}

body ol,
body ul {
    padding-left: 0;
    margin-top: 0;
    margin-bottom: 0;
}

body ul {
    list-style-type: '– ';
}

body ul ul {
    list-style-type: '↳ ';
}

body ol ol,
body ul ol {
    list-style-type: lower-roman;
}

body ol ol ol,
body ol ul ol,
body ul ol ol,
body ul ul ol {
    list-style-type: lower-alpha;
}

body dd {
    margin-left: 0;
}

body code,
body pre {
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 12px;
}

body pre {
    margin-top: 0;
    margin-bottom: 0;
}

body input::-webkit-inner-spin-button,
body input::-webkit-outer-spin-button {
    margin: 0;
    -webkit-appearance: none;
    appearance: none;
}

body :checked+.radio-label {
    position: relative;
    z-index: 1;
    border-color: #0366d6;
}

body .border {
    border: 1px solid #e1e4e8!important;
}

body .border-0 {
    border: 0!important;
}

body .border-bottom {
    border-bottom: 1px solid #e1e4e8!important;
}

body .rounded-1 {
    border-radius: 3px!important;
}

body .bg-white {
    background-color: #fff!important;
}

body .bg-gray-light {
    background-color: #fafbfc!important;
}

body .text-gray-light {
    color: #6a737d!important;
}

body .mb-0 {
    margin-bottom: 0!important;
}

body .my-2 {
    margin-top: 8px!important;
    margin-bottom: 8px!important;
}

body .pl-0 {
    padding-left: 0!important;
}

body .py-0 {
    padding-top: 0!important;
    padding-bottom: 0!important;
}

body .pl-1 {
    padding-left: 4px!important;
}

body .pl-2 {
    padding-left: 8px!important;
}

body .py-2 {
    padding-top: 8px!important;
    padding-bottom: 8px!important;
}

body .pl-3,
body .px-3 {
    padding-left: 16px!important;
}

body .px-3 {
    padding-right: 16px!important;
}

body .pl-4 {
    padding-left: 24px!important;
}

body .pl-5 {
    padding-left: 32px!important;
}

body .pl-6 {
    padding-left: 40px!important;
}

body .f6 {
    font-size: 12px!important;
}

body .lh-condensed {
    line-height: 1.25!important;
}

body .text-bold {
    font-weight: 600!important;
}

body .pl-c {
    color: #6a737d;
}

body .pl-c1,
body .pl-s .pl-v {
    color: #005cc5;
}

body .pl-e,
body .pl-en {
    color: #6f42c1;
}

body .pl-s .pl-s1,
body .pl-smi {
    color: #24292e;
}

body .pl-ent {
    color: #22863a;
}

body .pl-k {
    color: #d73a49;
}

body .pl-pds,
body .pl-s,
body .pl-s .pl-pse .pl-s1,
body .pl-sr,
body .pl-sr .pl-cce,
body .pl-sr .pl-sra,
body .pl-sr .pl-sre {
    color: #032f62;
}

body .pl-smw,
body .pl-v {
    color: #e36209;
}

body .pl-bu {
    color: #b31d28;
}

body .pl-ii {
    color: #fafbfc;
    background-color: #b31d28;
}

body .pl-c2 {
    color: #fafbfc;
    background-color: #d73a49;
}

body .pl-c2:before {
    content: "^M";
}

body .pl-sr .pl-cce {
    font-weight: 700;
    color: #22863a;
}

body .pl-ml {
    color: #735c0f;
}

body .pl-mh,
body .pl-mh .pl-en,
body .pl-ms {
    font-weight: 700;
    color: #005cc5;
}

body .pl-mi {
    font-style: italic;
    color: #24292e;
}

body .pl-mb {
    font-weight: 700;
    color: #24292e;
}

body .pl-md {
    color: #b31d28;
    background-color: #ffeef0;
}

body .pl-mi1 {
    color: #22863a;
    background-color: #f0fff4;
}

body .pl-mc {
    color: #e36209;
    background-color: #ffebda;
}

body .pl-mi2 {
    color: #f6f8fa;
    background-color: #005cc5;
}

body .pl-mdr {
    font-weight: 700;
    color: #6f42c1;
}

body .pl-ba {
    color: #586069;
}

body .pl-sg {
    color: #959da5;
}

body .pl-corl {
    text-decoration: underline;
    color: #032f62;
}

body .mb-0 {
    margin-bottom: 0!important;
}

body .my-2 {
    margin-bottom: 8px!important;
}

body .my-2 {
    margin-top: 8px!important;
}

body .pl-0 {
    padding-left: 0!important;
}

body .py-0 {
    padding-top: 0!important;
    padding-bottom: 0!important;
}

body .pl-1 {
    padding-left: 4px!important;
}

body .pl-2 {
    padding-left: 8px!important;
}

body .py-2 {
    padding-top: 8px!important;
    padding-bottom: 8px!important;
}

body .pl-3 {
    padding-left: 16px!important;
}

body .pl-4 {
    padding-left: 24px!important;
}

body .pl-5 {
    padding-left: 32px!important;
}

body .pl-6 {
    padding-left: 40px!important;
}

body .pl-7 {
    padding-left: 48px!important;
}

body .pl-8 {
    padding-left: 64px!important;
}

body .pl-9 {
    padding-left: 80px!important;
}

body .pl-10 {
    padding-left: 96px!important;
}

body .pl-11 {
    padding-left: 112px!important;
}

body .pl-12 {
    padding-left: 128px!important;
}

body hr {
    border-bottom-color: #eee;
}

body kbd {
    display: inline-block;
    padding: 3px 5px;
    font: 11px 'Ampersand', 'Victor Mono';
    line-height: 10px;
    color: #444d56;
    vertical-align: middle;
    background-color: #fafbfc;
    border: 1px solid #d1d5da;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #d1d5da;
}

body:after,
body:before {
    display: table;
    content: "";
}

body:after {
    clear: both;
}

body>:first-child {
    margin-top: 0!important;
}

body>:last-child {
    margin-bottom: 0!important;
}

body a:not([href]) {
    color: inherit;
    text-decoration: none;
}

body blockquote,
body details,
body dl,
body ol,
body p,
body pre,
body table,
body ul {
    margin-top: 0;
    margin-bottom: 16px;
}

body hr {
    height: .25em;
    padding: 0;
    margin: 24px 0;
    background-color: #e1e4e8;
    border: 0;
}

body blockquote {
    padding: 0 1em;
    color: #6a737d;
    border-left: .25em solid #dfe2e5;
}

body blockquote>:first-child {
    margin-top: 0;
}

body blockquote>:last-child {
    margin-bottom: 0;
}

body h1,
body h2,
body h3,
body h4,
body h5,
body h6 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
}

body h1 {
    font-size: 2em;
}

body h1,
body h2 {
    padding-bottom: .3em;
    border-bottom: 1px solid #eaecef;
}

body h2 {
    font-size: 1.5em;
}

body h3 {
    font-size: 1.25em;
}

body h4 {
    font-size: 1em;
}

body h5 {
    font-size: .875em;
}

body h6 {
    font-size: .85em;
    color: #6a737d;
}

body ol,
body ul {
    padding-left: 2em;
}

body ol ol,
body ol ul,
body ul ol,
body ul ul {
    margin-top: 0;
    margin-bottom: 0;
}

body li {
    word-wrap: break-all;
    text-align: left;
    hyphens: auto;
    -webkit-hyphens: auto;
}

body p {
    word-wrap: break-all;
    hyphens: auto;
}

body li>p {
    margin-top: 16px;
}

body li+li {
    margin-top: .25em;
}

body dl {
    padding: 0;
}

body dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
    font-weight: 600;
}

body dl dd {
    padding: 0 16px;
    margin-bottom: 16px;
}

body table {
    display: block;
    width: 100%;
    overflow: auto;
}

body table th {
    font-weight: 600;
}

body table td,
body table th {
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
}

body table tr {
    background-color: #fff;
    border-top: 1px solid #c6cbd1;
}

body table tr:nth-child(2n) {
    background-color: #f6f8fa;
}

body img {
    max-width: 100%;
    box-sizing: initial;
    background-color: #fff;
    margin-left: auto;
    margin-right: auto;
    display: flex;
}

body img[align=right] {
    padding-left: 20px;
}

body img[align=left] {
    padding-right: 20px;
}

body code {
    padding: .2em .4em;
    margin: 0;
    font-size: 85%;
    background-color: rgb(70 144 217 / 26%);
    border-radius: 3px;
}

body pre {
    word-wrap: normal;
}

body pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
}

body .highlight {
    margin-bottom: 16px;
}

body .highlight pre {
    margin-bottom: 0;
    word-break: normal;
}

body .highlight pre,
body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    color: #e7e7e7;
    background: #121112;
    font-weight: 400;
}

body pre code {
    display: inline;
    max-width: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    line-height: inherit;
    word-wrap: normal;
    background-color: initial;
    border: 0;
}

body .commit-tease-sha {
    display: inline-block;
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 90%;
    color: #444d56;
}

body .full-commit .btn-outline:not(:disabled):hover {
    color: #005cc5;
    border-color: #005cc5;
}

body .blob-wrapper {
    overflow-x: auto;
    overflow-y: hidden;
}

body .blob-wrapper-embedded {
    max-height: 240px;
    overflow-y: auto;
}

body .blob-num {
    width: 1%;
    min-width: 50px;
    padding-right: 10px;
    padding-left: 10px;
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 12px;
    line-height: 20px;
    color: rgba(27,31,35,.3);
    text-align: right;
    white-space: nowrap;
    vertical-align: top;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

body .blob-num:hover {
    color: rgba(27,31,35,.6);
}

body .blob-num:before {
    content: attr(data-line-number);
}

body .blob-code {
    position: relative;
    padding-right: 10px;
    padding-left: 10px;
    line-height: 20px;
    vertical-align: top;
}

body .blob-code-inner {
    overflow: visible;
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 12px;
    color: #24292e;
    word-wrap: normal;
    white-space: pre;
}

body .pl-token.active,
body .pl-token:hover {
    cursor: pointer;
    background: #ffea7f;
}

body .tab-size[data-tab-size="1"] {
    -moz-tab-size: 1;
    tab-size: 1;
}

body .tab-size[data-tab-size="2"] {
    -moz-tab-size: 2;
    tab-size: 2;
}

body .tab-size[data-tab-size="3"] {
    -moz-tab-size: 3;
    tab-size: 3;
}

body .tab-size[data-tab-size="4"] {
    -moz-tab-size: 4;
    tab-size: 4;
}

body .tab-size[data-tab-size="5"] {
    -moz-tab-size: 5;
    tab-size: 5;
}

body .tab-size[data-tab-size="6"] {
    -moz-tab-size: 6;
    tab-size: 6;
}

body .tab-size[data-tab-size="7"] {
    -moz-tab-size: 7;
    tab-size: 7;
}

body .tab-size[data-tab-size="8"] {
    -moz-tab-size: 8;
    tab-size: 8;
}

body .tab-size[data-tab-size="9"] {
    -moz-tab-size: 9;
    tab-size: 9;
}

body .tab-size[data-tab-size="10"] {
    -moz-tab-size: 10;
    tab-size: 10;
}

body .tab-size[data-tab-size="11"] {
    -moz-tab-size: 11;
    tab-size: 11;
}

body .tab-size[data-tab-size="12"] {
    -moz-tab-size: 12;
    tab-size: 12;
}

body .task-list-item {
    list-style-type: none;
}

body .task-list-item+.task-list-item {
    margin-top: 3px;
}

body .task-list-item input {
    margin: 0 .2em .25em -1.6em;
    vertical-align: middle;
}

table {
    border: none !important;
}

.MathJax {
    /* I really don't know what to do here */
}

.underline {
    text-decoration: underline;
}

h2.footnotes {
    display: none;
}

div#footnotes {
    /* position: absolute; */
    /* bottom: 10px; */
}

.footdef {
    display: inline-flex;
    width: 100%;
}

.footpara {
    margin-left: 5px;
    width: 97%;
    hyphens: auto;
    text-align: justify;
}

a.footref {
    font-size: 8pt;
}

.example {
    background-color: white !important;
    color: #24292e !important;
}

#table-of-contents h2 {
    font-size: 14pt;
    border-bottom: solid 1px #636363;
}

#table-of-contents {
    border-bottom: solid 1px #636363;
}

#table-of-contents ul {
    counter-reset: item;
}

#table-of-contents li {
    display: block;
}

#table-of-contents li:before {
    content: counters(item, ".") " \2002";
    counter-increment: item;
}

.figure p {
    text-align: center;
}
/*]]>*/-->
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('table.currency td.org-right').forEach(elem => {
        const text = elem.innerText;
        if (!isNaN(text)) {
            let num = (Math.round(parseFloat(text) * 100) / 100).toFixed(2);
            elem.innerText = '$' + num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
    });
});
</script>
</head>
<body>
<h1 class="title">Emacs Config</h1>
<div id="content" class="content">
<p>
Welcome to my Emacs config! Emacs is a beautiful piece of software
that allows you control over virtually every aspect of itself.
Typically, I only change what bothers me. As I&rsquo;m sure you&rsquo;ll find,
however, that&rsquo;s quite a bit.
</p>

<p>
I cannot guarantee that this will work on your machine out of the
box. If you&rsquo;re on a Mac, however, copying the entire <code>.emacs.d</code>
directory should work.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org288afad">Startup</a>
<ul>
<li><a href="#org1557743">Setup</a></li>
<li><a href="#org671d571">Scratch</a></li>
</ul>
</li>
<li><a href="#org9e1e860">Utilities</a></li>
<li><a href="#org1f2c3d9">User interface</a>
<ul>
<li><a href="#org290a170">Theme</a></li>
<li><a href="#org5893e88">Line numbers</a></li>
<li><a href="#orgda69786">Window/frame</a></li>
<li><a href="#org05a3311">Mode line</a></li>
<li><a href="#org6d59860">Encoding</a></li>
<li><a href="#org72dea83">Prettify symbols</a></li>
</ul>
</li>
<li><a href="#orgc5b77cf">Evil</a>
<ul>
<li><a href="#orgb27e604">Evil leader</a></li>
<li><a href="#org7ffe22d">Evil surround</a></li>
<li><a href="#org9efb699">Evil collection</a></li>
<li><a href="#org00dc8f5">Evil args</a></li>
<li><a href="#org1faf644">Evil embrace</a></li>
<li><a href="#org197896d">Evil owl</a></li>
<li><a href="#org143270b">Evil commentary</a></li>
<li><a href="#org3d5f238">Evil little word</a></li>
<li><a href="#org71a008b">Evil indent plus</a></li>
</ul>
</li>
<li><a href="#org500de0d">Navigation</a>
<ul>
<li><a href="#org3edbf21">Buffer ring</a></li>
<li><a href="#org0ae95d1">Helm</a></li>
</ul>
</li>
<li><a href="#orge3c7135">Editing</a>
<ul>
<li><a href="#orgb1ff976">Snippets</a></li>
<li><a href="#orga8506b3">Spelling</a></li>
<li><a href="#org1e647ad">Smartparens</a></li>
<li><a href="#org340fe96">Templating</a></li>
<li><a href="#orga0ff749">Macros</a></li>
<li><a href="#org1dcfcc7">Undo tree</a></li>
</ul>
</li>
<li><a href="#orgd03df28">Shell</a></li>
<li><a href="#orgdddca7f">Remote</a>
<ul>
<li><a href="#org15f1622">Tramp</a></li>
<li><a href="#org68220c3">Git</a></li>
</ul>
</li>
<li><a href="#orgc5e4db7">Programming</a>
<ul>
<li><a href="#org251b726">Flycheck</a></li>
<li><a href="#org92b0ac5">Flymake</a></li>
<li><a href="#org1956636">Company</a></li>
<li><a href="#org9c68a76">Languages</a></li>
<li><a href="#orgba6b944">Python</a></li>
<li><a href="#orgd405a5f">Rust</a></li>
<li><a href="#orgd32ef48">Elisp</a></li>
<li><a href="#org189c1a6">SGML/HTML</a></li>
<li><a href="#orge9ac5e6">Auctex/latex</a></li>
<li><a href="#org956a5ba">Scripts</a></li>
</ul>
</li>
<li><a href="#org4e657ea">Mail</a></li>
<li><a href="#orgf19d7e9">Files</a>
<ul>
<li><a href="#org1a6ac07">Dired</a></li>
<li><a href="#orgffec9e0">PDFs/images</a></li>
</ul>
</li>
<li><a href="#org845e59c">Org</a>
<ul>
<li><a href="#org7ace70b">Compilation</a></li>
<li><a href="#org6422c73">Capture</a></li>
<li><a href="#org70b3808">User interface</a></li>
<li><a href="#orgf5bc744">Editing</a></li>
<li><a href="#orgb296ad8">Key bindings</a></li>
<li><a href="#org7995c7e">Packages</a></li>
<li><a href="#org1070d2f">External applications</a></li>
<li><a href="#orgc067a0a">References</a></li>
<li><a href="#org92d7cff">Export</a></li>
<li><a href="#org81a3928">Miscellaneous</a></li>
</ul>
</li>
<li><a href="#org08f3b01">Ichthys</a></li>
<li><a href="#orge78cda2">Games</a>
<ul>
<li><a href="#orgfa9ea85">Gomoku</a></li>
<li><a href="#org331e39e">Pong</a></li>
</ul>
</li>
<li><a href="#orgb1163ed">Miscellaneous</a>
<ul>
<li><a href="#org9f1706f">Calendar</a></li>
<li><a href="#org4ab39e3">Mac-specific</a></li>
<li><a href="#org93577da">Edit with Emacs</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org288afad" class="outline-2">
<h2 id="org288afad">Startup</h2>
<div class="outline-text-2" id="text-org288afad">
</div>
<div id="outline-container-org1557743" class="outline-3">
<h3 id="org1557743">Setup</h3>
<div class="outline-text-3" id="text-org1557743">
<p>
Personal information.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> user-full-name <span style="color: #b5bd68;">"William Aguiar Roque"</span>)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> user-mail-address <span style="color: #b5bd68;">"william.aroque@gmail.com"</span>)
</pre>
</div>

<p>
Add package repositories.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">package</span>)
(add-to-list 'package-archives
             '(<span style="color: #b5bd68;">"melpa"</span> . <span style="color: #b5bd68;">"https://melpa.org/packages/"</span>)
             '(<span style="color: #b5bd68;">"melpa-stable"</span> . <span style="color: #b5bd68;">"https://stable.melpa.org/packages/"</span>))
(package-initialize)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">unless</span> (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package)
  (<span style="color: #CC6666; font-weight: bold;">eval-when-compile</span> (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">use-package</span>)))
</pre>
</div>

<p>
Make sure all packages are ensured by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> use-package-always-ensure t)
</pre>
</div>

<p>
Make sure environment variables are set up properly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">when</span> (memq window-system '(mac ns x))
  (exec-path-from-shell-initialize))
</pre>
</div>

<p>
Set garbage collection threshold to a more reasonable value.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> gc-cons-threshold (* 8 1024 1024))
</pre>
</div>

<p>
Set default directory to home
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq</span> default-directory (concat (getenv <span style="color: #b5bd68;">"HOME"</span>) <span style="color: #b5bd68;">"/"</span>))
</pre>
</div>

<p>
Remove startup screen
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> inhibit-startup-screen t)
</pre>
</div>

<p>
Stop showing &ldquo;when done with this frame&#x2026;&rdquo;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">with-eval-after-load</span> <span style="color: #b5bd68;">"server"</span>
  (<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">server-execute</span> (proc files nowait commands dontkill frame tty-name)
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">This is run from timers and process-filters, i.e. "asynchronously".</span>
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">But w.r.t the user, this is not really asynchronous since the timer</span>
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">is run after 0s and the process-filter is run in response to the</span>
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">user running `</span><span style="color: #CC6666; font-style: italic;">emacsclient</span><span style="color: #5a5b5a; font-style: italic;">'.  So it is OK to override the</span>
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">inhibit-quit flag, which is good since `</span><span style="color: #CC6666; font-style: italic;">commands</span><span style="color: #5a5b5a; font-style: italic;">' (as well as</span>
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">find-file-noselect via the major-mode) can run arbitrary code,</span>
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">including code that needs to wait.</span>
    (<span style="color: #CC6666; font-weight: bold;">with-local-quit</span>
      (<span style="color: #CC6666; font-weight: bold;">condition-case</span> err
          (<span style="color: #CC6666; font-weight: bold;">let</span> ((buffers (server-visit-files files proc nowait)))
            (mapc 'funcall (nreverse commands))
            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">If we were told only to open a new client, obey</span>
            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">`</span><span style="color: #CC6666; font-style: italic;">initial-buffer-choice</span><span style="color: #5a5b5a; font-style: italic;">' if it specifies a file</span>
            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">or a function.</span>
            (<span style="color: #CC6666; font-weight: bold;">unless</span> (<span style="color: #CC6666; font-weight: bold;">or</span> files commands)
              (<span style="color: #CC6666; font-weight: bold;">let</span> ((buf
                     (<span style="color: #CC6666; font-weight: bold;">cond</span> ((stringp initial-buffer-choice)
                            (find-file-noselect initial-buffer-choice))
                           ((functionp initial-buffer-choice)
                            (funcall initial-buffer-choice)))))
                (switch-to-buffer
                 (<span style="color: #CC6666; font-weight: bold;">if</span> (buffer-live-p buf) buf (get-buffer-create <span style="color: #b5bd68;">"*scratch*"</span>))
                 'norecord)))

            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Delete the client if necessary.</span>
            (<span style="color: #CC6666; font-weight: bold;">cond</span>
             (nowait
              <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Client requested nowait; return immediately.</span>
              (server-log <span style="color: #b5bd68;">"Close nowait client"</span> proc)
              (server-delete-client proc))
             ((<span style="color: #CC6666; font-weight: bold;">and</span> (not dontkill) (null buffers))
              <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">This client is empty; get rid of it immediately.</span>
              (server-log <span style="color: #b5bd68;">"Close empty client"</span> proc)
              (server-delete-client proc)))
            (<span style="color: #CC6666; font-weight: bold;">cond</span>
             ((<span style="color: #CC6666; font-weight: bold;">or</span> isearch-mode (minibufferp))
              nil)
             ((<span style="color: #CC6666; font-weight: bold;">and</span> frame (null buffers))
              (run-hooks 'server-after-make-frame-hook))
             ((not (null buffers))
              (run-hooks 'server-after-make-frame-hook)
              (server-switch-buffer (car buffers) nil (cdr (car files)))
              (run-hooks 'server-switch-hook)
              (<span style="color: #CC6666; font-weight: bold;">unless</span> nowait)))
            (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span> frame (null tty-name))
              (server-unselect-display frame)))
        ((quit error)
         (<span style="color: #CC6666; font-weight: bold;">when</span> (eq (car err) 'quit)
           (message <span style="color: #b5bd68;">"Quit emacsclient request"</span>))
         (server-return-error proc err))))))

</pre>
</div>

<p>
Stop showing auto save message.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> auto-save-no-message t)
</pre>
</div>

<p>
Make sure customization is saved to desktop instead of <code>.emacs.d</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> custom-file <span style="color: #b5bd68;">"~/Desktop/custom.el"</span>)
</pre>
</div>

<p>
Make sure Emacs uses UTF-8.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> locale-coding-system 'utf-8)
(set-selection-coding-system 'utf-8)
(prefer-coding-system 'utf-8)
(set-default-coding-systems 'utf-8)
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
</pre>
</div>

<p>
Stop showing sentinel exit messages with <code>async-shell-command</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">shell-command-sentinel</span> (process signal)
  (<span style="color: #CC6666; font-weight: bold;">when</span> (memq (process-status process) '(exit signal))
    (shell-command-set-point-after-cmd (process-buffer process))
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((inhibit-message t))
      (message <span style="color: #b5bd68;">"%s: %s."</span>
             (car (cdr (cdr (process-command process))))
             (substring signal 0 -1)))))
</pre>
</div>

<p>
Set <code>.emacs.d</code> directory.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">emacs-configuration-directory</span> (file-name-directory (<span style="color: #CC6666; font-weight: bold;">or</span> load-file-name (buffer-file-name)))
  <span style="color: #717171; font-style: italic;">"Get directory of emacs configuration."</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org671d571" class="outline-3">
<h3 id="org671d571">Scratch</h3>
<div class="outline-text-3" id="text-org671d571">
<p>
Remove initial message from scratch buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> initial-scratch-message <span style="color: #b5bd68;">""</span>)
</pre>
</div>

<p>
Use org mode in scratch buffer by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq</span> initial-major-mode 'org-mode)
</pre>
</div>

<p>
Toggle org mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">with-eval-after-load</span> 'org
  (define-key lisp-interaction-mode-map (kbd <span style="color: #b5bd68;">"C-c t"</span>) 'org-mode)
  (define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-c t"</span>) 'lisp-interaction-mode))
</pre>
</div>

<p>
Kill all buffers except for scratch.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">kill-all-buffers-except-scratch</span> ()
  <span style="color: #717171; font-style: italic;">"Kill all buffers except for *scratch*."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (mapc 'kill-buffer 
        (delete (get-buffer <span style="color: #b5bd68;">"*scratch*"</span>) (buffer-list)))
  (message <span style="color: #b5bd68;">"Killed all buffers except *scratch*."</span>))
</pre>
</div>

<p>
Use <code>scratch</code> extension to open new language-specific scratch buffers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">scratch</span>
  <span style="color: #81a2be;">:config</span>
  (global-set-key (kbd <span style="color: #b5bd68;">"C-c s"</span>) #'scratch))
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">create scratch buffer</span>
(evil-leader/set-key <span style="color: #b5bd68;">"b"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>) (switch-to-buffer <span style="color: #b5bd68;">"*scratch*"</span>)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make the scratch buffer the only one</span>
(evil-leader/set-key <span style="color: #b5bd68;">"B"</span> #'kill-all-buffers-except-scratch)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9e1e860" class="outline-2">
<h2 id="org9e1e860">Utilities</h2>
<div class="outline-text-2" id="text-org9e1e860">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">for debugging lists</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">print-elements-of-list</span> (list)
  <span style="color: #717171; font-style: italic;">"Print each element of LIST on a line of its own."</span>
  (<span style="color: #CC6666; font-weight: bold;">while</span> list
    (print (car list))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> list (cdr list))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">to add after index of list</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">insert-after</span> (lst index newelt)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">or</span> (null lst) (&gt;= index (length lst)))
      (<span style="color: #CC6666; font-weight: bold;">push</span> newelt lst)
    (<span style="color: #CC6666; font-weight: bold;">push</span> newelt (cdr (nthcdr index lst))))
  lst)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">easy way to wrap function for keyboard shortcut</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">wrap-fun</span> (fun <span style="color: #6CA17A;">&amp;rest</span> args)
  `(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
     (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
     (apply #',fun ',args)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-keyword-activep</span> (keyword <span style="color: #6CA17A;">&amp;optional</span> default-value)
  (<span style="color: #CC6666; font-weight: bold;">pcase</span> (org-collect-keywords (list keyword))
    (`((,keyword . ,val))
     (not (equal (car val) <span style="color: #b5bd68;">"nil"</span>)))
    (- default-value)))


(<span style="color: #CC6666; font-weight: bold;">defmacro</span> <span style="color: #6CA17A;">with-suppressed-message</span> (<span style="color: #6CA17A;">&amp;rest</span> body)
  <span style="color: #717171; font-style: italic;">"Suppress new messages temporarily in the echo area and the `</span><span style="color: #CC6666; font-style: italic;">*Messages*</span><span style="color: #717171; font-style: italic;">' buffer while BODY is evaluated."</span>
  (<span style="color: #CC6666; font-weight: bold;">declare</span> (indent 0))
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((message-log-max nil))
    `(<span style="color: #CC6666; font-weight: bold;">with-temp-message</span> (<span style="color: #CC6666; font-weight: bold;">or</span> (current-message) <span style="color: #b5bd68;">""</span>) ,@body)))


(<span style="color: #CC6666; font-weight: bold;">defmacro</span> <span style="color: #6CA17A;">define-and-bind-text-object</span> (key start-regex end-regex)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((inner-name (make-symbol <span style="color: #b5bd68;">"inner-name"</span>))
        (outer-name (make-symbol <span style="color: #b5bd68;">"outer-name"</span>)))
    `(<span style="color: #CC6666; font-weight: bold;">progn</span>
       (<span style="color: #CC6666; font-weight: bold;">evil-define-text-object</span> ,inner-name (count <span style="color: #6CA17A;">&amp;optional</span> beg end type)
         (evil-select-paren ,start-regex ,end-regex beg end type count nil))
       (<span style="color: #CC6666; font-weight: bold;">evil-define-text-object</span> ,outer-name (count <span style="color: #6CA17A;">&amp;optional</span> beg end type)
         (evil-select-paren ,start-regex ,end-regex beg end type count t))
       (define-key evil-inner-text-objects-map ,key (<span style="color: #CC6666; font-weight: bold;">quote</span> ,inner-name))
       (define-key evil-outer-text-objects-map ,key (<span style="color: #CC6666; font-weight: bold;">quote</span> ,outer-name)))))


(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">ox-json</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f2c3d9" class="outline-2">
<h2 id="org1f2c3d9">User interface</h2>
<div class="outline-text-2" id="text-org1f2c3d9">
<p>
General UI config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">colorscheme stuff</span>
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">ansi-color-names-vector</span>
  [<span style="color: #b5bd68;">"#3c3836"</span> <span style="color: #b5bd68;">"#fb4933"</span> <span style="color: #b5bd68;">"#b8bb26"</span> <span style="color: #b5bd68;">"#fabd2f"</span> <span style="color: #b5bd68;">"#83a598"</span> <span style="color: #b5bd68;">"#d3869b"</span> <span style="color: #b5bd68;">"#8ec07c"</span> <span style="color: #b5bd68;">"#ebdbb2"</span>])
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">pdf-view-midnight-colors</span> '(<span style="color: #b5bd68;">"#fdf4c1"</span> . <span style="color: #b5bd68;">"#1d2021"</span>))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set theme</span>
(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">doom-themes</span>
  <span style="color: #81a2be;">:config</span>
  (load-theme 'doom-tomorrow-night t))
</pre>
</div>
</div>

<div id="outline-container-org290a170" class="outline-3">
<h3 id="org290a170">Theme</h3>
<div class="outline-text-3" id="text-org290a170">
<p>
Colors.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-background</span>        <span style="color: #b5bd68;">"#121112"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-light-background</span>  <span style="color: #b5bd68;">"#1D1F21"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-foreground</span>        <span style="color: #b5bd68;">"#FDF4C1"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-light-subdued</span>     <span style="color: #b5bd68;">"#EBDBB2"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-dark-subdued</span>      <span style="color: #b5bd68;">"#313533"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-darkish-subdued</span>   <span style="color: #b5bd68;">"#515553"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-medium-subdued</span>    <span style="color: #b5bd68;">"#717171"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-red</span>               <span style="color: #b5bd68;">"#CC6666"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-light-red</span>         <span style="color: #b5bd68;">"#886950"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-orange</span>            <span style="color: #b5bd68;">"#FE8019"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-light-orange</span>      <span style="color: #b5bd68;">"#F0C674"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-green</span>             <span style="color: #b5bd68;">"#6CA17A"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-light-green</span>       <span style="color: #b5bd68;">"#B5BD68"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-yellow</span>            <span style="color: #b5bd68;">"#E0DBA9"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-blue</span>              <span style="color: #b5bd68;">"#81A2BE"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-light-blue</span>        <span style="color: #b5bd68;">"#41728E"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-brown</span>             <span style="color: #b5bd68;">"#BD9977"</span>)
(<span style="color: #CC6666; font-weight: bold;">defconst</span> <span style="color: #E0DBA9;">color-dark-brown</span>        <span style="color: #b5bd68;">"#605846"</span>)
</pre>
</div>

<p>
Faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'default nil
                    <span style="color: #81a2be;">:weight</span> 'medium
                    <span style="color: #81a2be;">:height</span> 140
                    <span style="color: #81a2be;">:width</span> 'normal
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Victor Mono"</span>
                    <span style="color: #81a2be;">:background</span> color-background
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#fdf4c1"</span>)


(set-face-attribute 'fixed-pitch nil
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Victor Mono"</span>
                    <span style="color: #81a2be;">:height</span> 140)


(set-face-attribute 'variable-pitch nil
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>
                    <span style="color: #81a2be;">:height</span> 160)


(set-face-attribute 'font-lock-preprocessor-face nil
                    <span style="color: #81a2be;">:inherit</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-red)


(set-face-attribute 'mode-line nil
                    <span style="color: #81a2be;">:box</span> nil
                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#121112"</span>
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued)


(set-face-attribute 'mode-line-buffer-id nil
                    <span style="color: #81a2be;">:weight</span> 'bold)


(set-face-attribute 'mode-line-inactive nil
                    <span style="color: #81a2be;">:box</span> nil
                    <span style="color: #81a2be;">:background</span> color-light-background
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued)


(set-face-attribute 'font-lock-keyword-face nil
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-red)


(set-face-attribute 'font-lock-comment-face nil
                    <span style="color: #81a2be;">:slant</span> 'italic)


(set-face-attribute 'font-lock-function-name-face nil
                    <span style="color: #81a2be;">:foreground</span> color-green)


(set-face-attribute 'font-lock-constant-face nil
                    <span style="color: #81a2be;">:foreground</span> color-red)


(set-face-attribute 'font-lock-variable-name-face nil
                    <span style="color: #81a2be;">:foreground</span> color-yellow)


(set-face-attribute 'font-lock-type-face nil
                    <span style="color: #81a2be;">:foreground</span> color-green)


(set-face-attribute 'lazy-highlight nil 
                    <span style="color: #81a2be;">:weight</span> 'normal
                    <span style="color: #81a2be;">:background</span> color-light-blue
                    <span style="color: #81a2be;">:foreground</span> color-foreground)


(set-face-attribute 'line-number nil
                    <span style="color: #81a2be;">:background</span> color-background)


(set-face-attribute 'line-number-current-line nil
                    <span style="color: #81a2be;">:background</span> color-background
                    <span style="color: #81a2be;">:foreground</span> color-orange)


(set-face-attribute 'shadow nil
                    <span style="color: #81a2be;">:foreground</span> color-dark-subdued)


(<span style="color: #CC6666; font-weight: bold;">with-eval-after-load</span> 'hl-line
  (set-face-attribute 'hl-line nil
                      <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#1e1e1e"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5893e88" class="outline-3">
<h3 id="org5893e88">Line numbers</h3>
<div class="outline-text-3" id="text-org5893e88">
<p>
Set hybrid line numbers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">toggle-line-numbers</span> ()
  <span style="color: #717171; font-style: italic;">"Toggle line numbers."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">setq-local</span> display-line-numbers
              (<span style="color: #CC6666; font-weight: bold;">if</span> (equal display-line-numbers nil) 'relative nil)))


(add-hook 'prog-mode-hook #'toggle-line-numbers)
(add-hook 'LaTeX-mode-hook #'toggle-line-numbers)
</pre>
</div>

<p>
Added option for temporary line numbers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">began-line-toggle</span> nil
  <span style="color: #717171; font-style: italic;">"Whether line numbers have currently been toggled."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">cautious-line-toggle</span> ()
  <span style="color: #717171; font-style: italic;">"Toggle line numbers temporarily if began-line-toggle is nil"</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (not began-line-toggle) (not (derived-mode-p 'prog-mode)))
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (toggle-line-numbers)
        (<span style="color: #CC6666; font-weight: bold;">setq</span> began-line-toggle t))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">show line numbers when using numerical prefix </span>
<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">(add-hook 'prefix-command-preserve-state-hook #'cautious-line-toggle)</span>


(add-hook 'pre-command-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                (<span style="color: #CC6666; font-weight: bold;">if</span> began-line-toggle
                                    (<span style="color: #CC6666; font-weight: bold;">progn</span>
                                      (toggle-line-numbers)
                                      (<span style="color: #CC6666; font-weight: bold;">setq</span> began-line-toggle nil)))))
</pre>
</div>

<p>
Hide line numbers for term.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'term-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">setq-local</span> display-line-numbers nil)))
</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span style="color: #b5bd68;">"N"</span> #'cautious-line-toggle)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgda69786" class="outline-3">
<h3 id="orgda69786">Window/frame</h3>
<div class="outline-text-3" id="text-orgda69786">
<p>
Clean interface.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">remove menu and tool bar</span>
(tool-bar-mode -1)
(menu-bar-mode -1)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">remove scrollbar</span>
(toggle-scroll-bar -1)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">remove title</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">erase-title</span> ()
  (<span style="color: #CC6666; font-weight: bold;">setq</span> frame-title-format
        (<span style="color: #CC6666; font-weight: bold;">if</span> (equal frame-title-format <span style="color: #b5bd68;">""</span>) <span style="color: #b5bd68;">"\n"</span> <span style="color: #b5bd68;">""</span>)))

(run-with-timer 0 5 #'erase-title)
</pre>
</div>

<p>
Resize frame natively (cf. by columns/rows).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> frame-resize-pixelwise t)
</pre>
</div>

<p>
Set margins.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(fringe-mode 0)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> left-margin-width 2)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> right-margin-width 2)
</pre>
</div>

<p>
Hide macOS &ldquo;frame&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'default-frame-alist '(ns-transparent-titlebar . t))
(add-to-list 'default-frame-alist '(ns-appearance . dark))

(<span style="color: #CC6666; font-weight: bold;">setq-default</span> ns-use-proxy-icon nil)
</pre>
</div>

<p>
Set default frame size.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">if</span> (window-system) (set-frame-size (selected-frame) 110 30))
</pre>
</div>

<p>
Raise frame by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'server-switch-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (select-frame-set-input-focus (selected-frame))))
</pre>
</div>

<p>
Make sure client loading doesn&rsquo;t make Emacs forget this whole
configuration thing ever happened.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">default-frame-height</span> 30)
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">default-frame-width</span> 110)

(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">default-frame-pixel-height</span> nil)
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">default-frame-pixel-width</span> nil)


(add-to-list 'after-make-frame-functions
             #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (frame)
                 (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">or</span> (not default-frame-pixel-height) (not default-frame-width))
                   (<span style="color: #CC6666; font-weight: bold;">setq-default</span> default-frame-pixel-height (frame-outer-height frame))
                   (<span style="color: #CC6666; font-weight: bold;">setq-default</span> default-frame-pixel-width (frame-outer-width frame)))))


(add-hook 'before-make-frame-hook
          #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
              (add-to-list 'default-frame-alist '(vertical-scroll-bars . nil))
              (add-to-list 'default-frame-alist `(height . ,default-frame-height))
              (add-to-list 'default-frame-alist `(width  . ,default-frame-width))))
</pre>
</div>

<p>
Center window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">should-center-frame</span> t)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">center-frame</span> (frame)
  (<span style="color: #CC6666; font-weight: bold;">if</span> should-center-frame
      (modify-frame-parameters
       frame '((user-position . t) (top . 0.5) (left . 0.5)))))

(add-to-list 'after-make-frame-functions #'center-frame)
</pre>
</div>

<p>
Close current window (vim-style).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #b5bd68;">"M-w"</span>) 'evil-quit)
</pre>
</div>

<p>
Transpose frame.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key global-map (kbd <span style="color: #b5bd68;">"M-t"</span>) #'transpose-frame)
</pre>
</div>

<p>
Navigate between windows (splits).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #b5bd68;">"M-h"</span>) 'evil-window-left)
(global-set-key (kbd <span style="color: #b5bd68;">"M-j"</span>) 'evil-window-down)
(global-set-key (kbd <span style="color: #b5bd68;">"M-k"</span>) 'evil-window-up)
(global-set-key (kbd <span style="color: #b5bd68;">"M-l"</span>) 'evil-window-right)
</pre>
</div>

<p>
Autoselect window with mouse on it.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> mouse-autoselect-window t)
</pre>
</div>

<p>
Split vertically by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> split-width-threshold 0)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> split-height-threshold nil)
</pre>
</div>

<p>
Transpose frame.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">transpose-frame</span>)
</pre>
</div>

<p>
Resize window more easily.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #b5bd68;">"C-c w"</span>) #'evil-window-set-width)
(global-set-key (kbd <span style="color: #b5bd68;">"C-c h"</span>) #'evil-window-set-height)
</pre>
</div>

<p>
Begin crusade against popup windows.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> pop-up-windows nil)
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open non-fullscreen window</span>
(evil-leader/set-key (kbd <span style="color: #b5bd68;">"-"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                   (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                   (make-frame '((user-position . t) (top . 0.5) (left . 0.5)))
                                   (run-at-time .2 nil (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                         (set-frame-parameter nil 'fullscreen nil)
                                                         (center-frame (selected-frame))))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open fullscreen window</span>
(evil-leader/set-key (kbd <span style="color: #b5bd68;">"_"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                   (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                   (make-frame '((fullscreen . fullboth)))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">switch frames easily</span>
(evil-leader/set-key <span style="color: #b5bd68;">"O"</span> #'other-frame)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">balance out window sizes</span>
(evil-leader/set-key <span style="color: #b5bd68;">"W"</span> #'balance-windows)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">recenter frame</span>
(evil-leader/set-key <span style="color: #b5bd68;">"0"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (set-frame-parameter nil 'width default-frame-width)
                             (set-frame-parameter nil 'height default-frame-height)
                             (center-frame (selected-frame))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">quit emacs -- shouldn't technically be here</span>
(evil-leader/set-key (kbd <span style="color: #b5bd68;">"q"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                   (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                   (kill-all-buffers-except-scratch)
                                   (<span style="color: #CC6666; font-weight: bold;">when</span> (yes-or-no-p <span style="color: #b5bd68;">"Truly really truly quit Emacs? "</span>)
                                     (kill-emacs))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">toggle fullscreen more easily</span>
(evil-leader/set-key (kbd <span style="color: #b5bd68;">"RET"</span>) #'toggle-frame-fullscreen)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">swap window sides</span>
(evil-leader/set-key (kbd <span style="color: #b5bd68;">"y"</span>) #'window-swap-states)
</pre>
</div>
</div>
</div>

<div id="outline-container-org05a3311" class="outline-3">
<h3 id="org05a3311">Mode line</h3>
<div class="outline-text-3" id="text-org05a3311">
<p>
Mode line config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(mood-line-mode)

(<span style="color: #CC6666; font-weight: bold;">setq-default</span> display-time-default-load-average nil)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> display-time-day-and-date t)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> display-time-format <span style="color: #b5bd68;">" %H:%M"</span>)
(display-time)
</pre>
</div>

<p>
Custom faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'mood-line-buffer-name nil
                    <span style="color: #81a2be;">:inherit</span> 'mode-line-buffer-id
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-major-mode nil
                    <span style="color: #81a2be;">:inherit</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-modified nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-error nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-info nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-neutral nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-success nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-warning nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-unimportant nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#ebdbb2"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">mood-line</span>
  <span style="color: #81a2be;">:config</span>
  &lt;&lt;mode-line-config&gt;&gt;
  &lt;&lt;mood-line-faces&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d59860" class="outline-3">
<h3 id="org6d59860">Encoding</h3>
<div class="outline-text-3" id="text-org6d59860">
<p>
Sort of inelegant (but seemingly standard) way of adding ligature
support.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">let</span> ((alist `((?! . ,(regexp-opt '(<span style="color: #b5bd68;">"!!"</span> <span style="color: #b5bd68;">"!="</span> <span style="color: #b5bd68;">"!=="</span>)))
               (?# . ,(regexp-opt '(<span style="color: #b5bd68;">"##"</span> <span style="color: #b5bd68;">"###"</span> <span style="color: #b5bd68;">"####"</span> <span style="color: #b5bd68;">"#("</span> <span style="color: #b5bd68;">"#?"</span> <span style="color: #b5bd68;">"#["</span> <span style="color: #b5bd68;">"#_"</span> <span style="color: #b5bd68;">"#_("</span> <span style="color: #b5bd68;">"#{"</span>)))
               (?$ . ,(regexp-opt '(<span style="color: #b5bd68;">"$&gt;"</span>)))
               (?% . ,(regexp-opt '(<span style="color: #b5bd68;">"%%"</span>)))
               (?&amp; . ,(regexp-opt '(<span style="color: #b5bd68;">"&amp;&amp;"</span>)))
               (?* . ,(regexp-opt '(<span style="color: #b5bd68;">"*"</span> <span style="color: #b5bd68;">"**"</span> <span style="color: #b5bd68;">"***"</span> <span style="color: #b5bd68;">"**/"</span> <span style="color: #b5bd68;">"*/"</span> <span style="color: #b5bd68;">"*&gt;"</span>)))
               (?+ . ,(regexp-opt '(<span style="color: #b5bd68;">"+"</span> <span style="color: #b5bd68;">"++"</span> <span style="color: #b5bd68;">"+++"</span> <span style="color: #b5bd68;">"+&gt;"</span>)))
               (?- . ,(regexp-opt '(<span style="color: #b5bd68;">"--"</span> <span style="color: #b5bd68;">"---"</span> <span style="color: #b5bd68;">"--&gt;"</span> <span style="color: #b5bd68;">"-&lt;"</span> <span style="color: #b5bd68;">"-&lt;&lt;"</span> <span style="color: #b5bd68;">"-&gt;"</span> <span style="color: #b5bd68;">"-&gt;&gt;"</span> <span style="color: #b5bd68;">"-}"</span> <span style="color: #b5bd68;">"-~"</span>)))
               (?. . ,(regexp-opt '(<span style="color: #b5bd68;">".-"</span> <span style="color: #b5bd68;">".."</span> <span style="color: #b5bd68;">"..."</span> <span style="color: #b5bd68;">"..&lt;"</span> <span style="color: #b5bd68;">".="</span>)))
               (?/ . ,(regexp-opt '(<span style="color: #b5bd68;">"/*"</span> <span style="color: #b5bd68;">"/**"</span> <span style="color: #b5bd68;">"//"</span> <span style="color: #b5bd68;">"///"</span> <span style="color: #b5bd68;">"/="</span> <span style="color: #b5bd68;">"/=="</span> <span style="color: #b5bd68;">"/&gt;"</span>)))
               (?: . ,(regexp-opt '(<span style="color: #b5bd68;">":"</span> <span style="color: #b5bd68;">"::"</span> <span style="color: #b5bd68;">":::"</span> <span style="color: #b5bd68;">":="</span>)))
               (?\; . ,(regexp-opt '(<span style="color: #b5bd68;">";;"</span>)))
               (?&lt; . ,(regexp-opt '(<span style="color: #b5bd68;">"&lt;!--"</span> <span style="color: #b5bd68;">"&lt;$"</span> <span style="color: #b5bd68;">"&lt;$&gt;"</span> <span style="color: #b5bd68;">"&lt;*"</span> <span style="color: #b5bd68;">"&lt;*&gt;"</span> <span style="color: #b5bd68;">"&lt;+"</span> <span style="color: #b5bd68;">"&lt;+&gt;"</span> <span style="color: #b5bd68;">"&lt;-"</span> <span style="color: #b5bd68;">"&lt;--"</span> <span style="color: #b5bd68;">"&lt;-&gt;"</span> <span style="color: #b5bd68;">"&lt;/"</span> <span style="color: #b5bd68;">"&lt;/&gt;"</span> <span style="color: #b5bd68;">"&lt;&lt;"</span> <span style="color: #b5bd68;">"&lt;&lt;-"</span> <span style="color: #b5bd68;">"&lt;&lt;&lt;"</span> <span style="color: #b5bd68;">"&lt;&lt;="</span> <span style="color: #b5bd68;">"&lt;="</span> <span style="color: #b5bd68;">"&lt;="</span> <span style="color: #b5bd68;">"&lt;=&lt;"</span> <span style="color: #b5bd68;">"&lt;=="</span> <span style="color: #b5bd68;">"&lt;=&gt;"</span> <span style="color: #b5bd68;">"&lt;&gt;"</span> <span style="color: #b5bd68;">"&lt;|"</span> <span style="color: #b5bd68;">"&lt;|&gt;"</span> <span style="color: #b5bd68;">"&lt;~"</span> <span style="color: #b5bd68;">"&lt;~~"</span>)))
               (?= . ,(regexp-opt '(<span style="color: #b5bd68;">"=/="</span> <span style="color: #b5bd68;">"=:="</span> <span style="color: #b5bd68;">"=&lt;&lt;"</span> <span style="color: #b5bd68;">"=="</span> <span style="color: #b5bd68;">"==="</span> <span style="color: #b5bd68;">"==&gt;"</span> <span style="color: #b5bd68;">"=&gt;"</span> <span style="color: #b5bd68;">"=&gt;&gt;"</span>)))
               (?&gt; . ,(regexp-opt '(<span style="color: #b5bd68;">"&gt;-"</span> <span style="color: #b5bd68;">"&gt;="</span> <span style="color: #b5bd68;">"&gt;=&gt;"</span> <span style="color: #b5bd68;">"&gt;&gt;"</span> <span style="color: #b5bd68;">"&gt;&gt;-"</span> <span style="color: #b5bd68;">"&gt;&gt;="</span> <span style="color: #b5bd68;">"&gt;&gt;&gt;"</span>)))
               (?? . ,(regexp-opt '(<span style="color: #b5bd68;">"??"</span> <span style="color: #b5bd68;">"?="</span>)))
               (?\[ . ,(regexp-opt '(<span style="color: #b5bd68;">"[]"</span>)))
               (?\\ . ,(regexp-opt '(<span style="color: #b5bd68;">"\\\\"</span> <span style="color: #b5bd68;">"\\\\\\"</span>)))
               (?^ . ,(regexp-opt '(<span style="color: #b5bd68;">"^="</span>)))
               (?w . ,(regexp-opt '(<span style="color: #b5bd68;">"www"</span>)))
               (?x . ,(regexp-opt '(<span style="color: #b5bd68;">"x"</span>)))
               (?{ . ,(regexp-opt '(<span style="color: #b5bd68;">"{-"</span>)))
               (?| . ,(regexp-opt '(<span style="color: #b5bd68;">"|="</span> <span style="color: #b5bd68;">"|&gt;"</span> <span style="color: #b5bd68;">"||"</span> <span style="color: #b5bd68;">"||="</span>)))
               (?~ . ,(regexp-opt '(<span style="color: #b5bd68;">"~-"</span> <span style="color: #b5bd68;">"~="</span> <span style="color: #b5bd68;">"~&gt;"</span> <span style="color: #b5bd68;">"~@"</span> <span style="color: #b5bd68;">"~~"</span> <span style="color: #b5bd68;">"~~&gt;"</span>)))
               <span style="color: #5a5b5a; font-style: italic;">;;;</span><span style="color: #5a5b5a; font-style: italic;">(?F . ,(regexp-opt '("F_vec")))</span>
               )))
  (<span style="color: #CC6666; font-weight: bold;">dolist</span> (char-regexp alist)
    (set-char-table-range composition-function-table (car char-regexp)
                          `([,(cdr char-regexp) 0 font-shape-gstring]))))
</pre>
</div>

<p>
Use fira code for Greek letters in vterm.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'vterm-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (set-fontset-font (face-attribute 'default <span style="color: #81a2be;">:fontset</span>)
                                               '(#x0370 . #x03FF) (font-spec <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Fira Code"</span>) nil 'prepend)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org72dea83" class="outline-3">
<h3 id="org72dea83">Prettify symbols</h3>
<div class="outline-text-3" id="text-org72dea83">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">add-visual-replacement</span> (from to)
  <span style="color: #717171; font-style: italic;">"Make `</span><span style="color: #CC6666; font-style: italic;">prettify-symbols-mode</span><span style="color: #717171; font-style: italic;">' replace string FROM with string TO.</span>

<span style="color: #717171; font-style: italic;">Updates `</span><span style="color: #CC6666; font-style: italic;">prettify-symbols-alist</span><span style="color: #717171; font-style: italic;">'.  You may need to toggle</span>
<span style="color: #717171; font-style: italic;">`</span><span style="color: #CC6666; font-style: italic;">prettify-symbols-mode</span><span style="color: #717171; font-style: italic;">' to make the changes take effect.</span>

<span style="color: #717171; font-style: italic;">Each character of TO is vertically aligned using the baseline,</span>
<span style="color: #717171; font-style: italic;">such that base-left of the character is aligned with base-right</span>
<span style="color: #717171; font-style: italic;">of the preceding character.  Refer to `</span><span style="color: #CC6666; font-style: italic;">reference-point-alist</span><span style="color: #717171; font-style: italic;">'</span>
<span style="color: #717171; font-style: italic;">for more information."</span>
  (<span style="color: #CC6666; font-weight: bold;">push</span> (cons from (<span style="color: #CC6666; font-weight: bold;">let</span> ((composition nil))
                     (<span style="color: #CC6666; font-weight: bold;">dolist</span> (char (string-to-list to)
                                   (nreverse (cdr composition)))
                       (<span style="color: #CC6666; font-weight: bold;">push</span> char composition)
                       (<span style="color: #CC6666; font-weight: bold;">push</span> '(Br . Bl) composition))))
        prettify-symbols-alist))


(add-hook 'org-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                           (add-visual-replacement <span style="color: #b5bd68;">"---"</span> <span style="color: #b5bd68;">"&#9472;&#9472;"</span>)

                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\sqrt"</span> . <span style="color: #b5bd68;">"&#8730;"</span>) prettify-symbols-alist)

                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\text"</span> . <span style="color: #b5bd68;">"&#8203;"</span>) prettify-symbols-alist)

                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\left("</span> . <span style="color: #b5bd68;">"("</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\right)"</span> . <span style="color: #b5bd68;">")"</span>) prettify-symbols-alist)
                           (add-visual-replacement <span style="color: #b5bd68;">"\\right)^2"</span> <span style="color: #b5bd68;">")&#178;"</span>)
                           (add-visual-replacement <span style="color: #b5bd68;">"\\right)^3"</span> <span style="color: #b5bd68;">")&#179;"</span>)

                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\left|"</span> . <span style="color: #b5bd68;">"|"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\right|"</span> . <span style="color: #b5bd68;">"|"</span>) prettify-symbols-alist)
                           (add-visual-replacement <span style="color: #b5bd68;">"\\right|^2"</span> <span style="color: #b5bd68;">"|&#178;"</span>)
                           (add-visual-replacement <span style="color: #b5bd68;">"\\right|^3"</span> <span style="color: #b5bd68;">"|&#179;"</span>)

                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\left["</span> .  <span style="color: #b5bd68;">"["</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\right]"</span> . <span style="color: #b5bd68;">"]"</span>) prettify-symbols-alist)
                           (add-visual-replacement <span style="color: #b5bd68;">"\\right]^2"</span> <span style="color: #b5bd68;">"]&#178;"</span>)
                           (add-visual-replacement <span style="color: #b5bd68;">"\\right]^3"</span> <span style="color: #b5bd68;">"]&#179;"</span>)

                           (add-visual-replacement <span style="color: #b5bd68;">"\\left\\Vert"</span> <span style="color: #b5bd68;">"||"</span>)
                           (add-visual-replacement <span style="color: #b5bd68;">"\\right\\Vert"</span> <span style="color: #b5bd68;">"||"</span>)

                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\vecb{a}"</span> . <span style="color: #b5bd68;">"&#119938;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\vecb{b}"</span> . <span style="color: #b5bd68;">"&#119939;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\vecb{c}"</span> . <span style="color: #b5bd68;">"&#119940;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\vecb{u}"</span> . <span style="color: #b5bd68;">"&#119958;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\vecb{v}"</span> . <span style="color: #b5bd68;">"&#119959;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\vecb{r}"</span> . <span style="color: #b5bd68;">"&#119955;"</span>) prettify-symbols-alist)

                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\left\\langle"</span> .  <span style="color: #b5bd68;">"&#12296;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"\\right\\rangle"</span> .  <span style="color: #b5bd68;">"&#12297;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"[ ]"</span> .  <span style="color: #b5bd68;">"&#9744;"</span>) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"[X]"</span> . <span style="color: #b5bd68;">"&#9745;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"[-]"</span> . <span style="color: #b5bd68;">"&#10061;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+BEGIN_SRC"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+END_SRC"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+BEGIN_EXAMPLE"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+END_EXAMPLE"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+BEGIN_QUOTE"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+END_QUOTE"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+BEGIN_VERSE"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+END_VERSE"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+begin_verse"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+end_verse"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+begin_quote"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+end_quote"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+begin_example"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+end_example"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+begin_src"</span> . <span style="color: #b5bd68;">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+end_src"</span> . <span style="color: #b5bd68;">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> '(<span style="color: #b5bd68;">"#+title: "</span> . <span style="color: #b5bd68;">"&#8203;"</span> ) prettify-symbols-alist)
                           (prettify-symbols-mode)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc5b77cf" class="outline-2">
<h2 id="orgc5b77cf">Evil</h2>
<div class="outline-text-2" id="text-orgc5b77cf">
<p>
Set all the necessary init variables.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-want-keybinding nil)         <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">evil-collection compatibility</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-search-module 'evil-search)  <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">use vim-style searching</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-undo-system 'undo-tree)      <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">use better undo system based on vim</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-vsplit-window-right t)       <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">split right</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-split-window-below t)        <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">split down</span>


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">new digraphs</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-digraphs-table-user '(((?r ?a) . ?\x2192)
                                         ((?  ? ) . ?\x200b)
                                         ((?t ?h) . ?\x03b8)
                                         ((?p ?i) . ?\x03c0)
                                         ((?p ?h) . ?\x03c6)
                                         ((?l ?a) . ?\x03bb)
                                         ((?o ?m) . ?\x03c9)
                                         ((?n ?u) . ?\x03bd)
                                         ((?b ?e) . ?\x03b2)
                                         ((?g ?a) . ?\x03b3)
                                         ((?t ?a) . ?\x03c4)
                                         ((?a ?l) . ?\x03b1)
                                         ((?r ?h) . ?\x03c1)
                                         ((?m ?m) . ?\x03bc)
                                         ((?. ?.) . ?\x0307)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">change cursor colors based on mode (state)</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-emacs-state-cursor '(<span style="color: #b5bd68;">"white"</span> box))
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-normal-state-cursor '(<span style="color: #b5bd68;">"#fdf4c1"</span> box))
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-visual-state-cursor '(<span style="color: #b5bd68;">"orange"</span> box))
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-insert-state-cursor '(<span style="color: #b5bd68;">"#fdf4c1"</span> bar))
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-replace-state-cursor '(<span style="color: #b5bd68;">"orange"</span> hollow))
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-operator-state-cursor '(<span style="color: #b5bd68;">"orange"</span> hollow))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set state change messages</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-insert-state-message <span style="color: #b5bd68;">""</span>)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-visual-state-message <span style="color: #b5bd68;">""</span>)
</pre>
</div>

<p>
Face configuration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'evil-ex-search nil
                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#81a2be"</span>
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#0d0d0d"</span>
                    <span style="color: #81a2be;">:weight</span> 'normal)
</pre>
</div>

<p>
General evil-mode config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-mode 1)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use vim-style paragraphs</span>
(<span style="color: #CC6666; font-weight: bold;">defadvice</span> <span style="color: #6CA17A;">forward-evil-paragraph</span> (around default-values activate)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((paragraph-start (default-value 'paragraph-start))
        (paragraph-separate (default-value 'paragraph-separate)))
    ad-do-it))
</pre>
</div>

<p>
General key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">key-chord</span>
  <span style="color: #81a2be;">:load-path</span> <span style="color: #b5bd68;">"lisp/"</span>
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> key-chord-two-keys-delay 0.2)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">redefine chord definition so that keys can't be reversed</span>
  (<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">key-chord-define</span> (keymap keys command)
    <span style="color: #717171; font-style: italic;">"Define in KEYMAP, a key-chord of the two keys in KEYS starting a COMMAND.</span>

<span style="color: #717171; font-style: italic;">KEYS can be a string or a vector of two elements. Currently only</span>
<span style="color: #717171; font-style: italic;">elements that corresponds to ascii codes in the range 32 to 126</span>
<span style="color: #717171; font-style: italic;">can be used.</span>

<span style="color: #717171; font-style: italic;">COMMAND can be an interactive function, a string, or nil.</span>
<span style="color: #717171; font-style: italic;">If COMMAND is nil, the key-chord is removed."</span>
    (<span style="color: #CC6666; font-weight: bold;">if</span> (/= 2 (length keys))
        (<span style="color: #f0c674;">error</span> <span style="color: #b5bd68;">"Key-chord keys must have two elements"</span>))
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Exotic chars in a string are &gt;255 but define-key wants 128..255</span>
    <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">for those.</span>
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((key1 (logand 255 (aref keys 0)))
          (key2 (logand 255 (aref keys 1))))
      (define-key keymap (vector 'key-chord key1 key2) command)))


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">bind jk to normal state</span>
  (key-chord-define evil-insert-state-map <span style="color: #b5bd68;">"jk"</span> 'evil-normal-state)
  (key-chord-mode 1)


  (add-hook 'input-method-deactivate-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> () (key-chord-mode 1))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure C-j executes in the command window</span>
(define-key evil-command-window-mode-map (kbd <span style="color: #b5bd68;">"C-j"</span>) 'evil-command-window-execute)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">remap Y to sensible function</span>
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"Y"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                (evil-yank (point) (line-end-position))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient macro execution</span>
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"RET"</span>) (kbd <span style="color: #b5bd68;">"@q"</span>))
(define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"RET"</span>) (kbd <span style="color: #b5bd68;">"@q"</span>))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">select contents of last paste</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">evil-select-pasted</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((start-marker (evil-get-marker ?\[))
        (end-marker (evil-get-marker ?\])))
    (evil-visual-select start-marker end-marker)))

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"g b"</span>) #'evil-select-pasted)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">increment/decrement at point</span>
(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-numbers</span>
  <span style="color: #81a2be;">:config</span>
  (define-key global-map (kbd <span style="color: #b5bd68;">"C-9"</span>) #'evil-numbers/dec-at-pt)
  (define-key global-map (kbd <span style="color: #b5bd68;">"C-0"</span>) #'evil-numbers/inc-at-pt))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">go to beginning and end of visual line by default</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"0"</span>) #'evil-beginning-of-visual-line)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"$"</span>) #'evil-end-of-visual-line)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient remap for ex state</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> nil evil-normal-state-map <span style="color: #b5bd68;">";"</span> 'evil-ex)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> nil evil-visual-state-map <span style="color: #b5bd68;">";"</span> 'evil-ex)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal 'dired-mode-map <span style="color: #b5bd68;">";"</span> 'evil-ex)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil</span>
  <span style="color: #81a2be;">:init</span>
  &lt;&lt;evil-variables&gt;&gt;

  <span style="color: #81a2be;">:config</span>
  &lt;&lt;evil-faces&gt;&gt;
  &lt;&lt;evil-leader&gt;&gt;
  &lt;&lt;evil-config&gt;&gt;
  &lt;&lt;evil-keybindings&gt;&gt;)
</pre>
</div>
</div>

<div id="outline-container-orgb27e604" class="outline-3">
<h3 id="orgb27e604">Evil leader</h3>
<div class="outline-text-3" id="text-orgb27e604">
<p>
Let other parts of config create keybindings with evil
leader. Remember to update this with the noweb reference in order to
include bindings. Also, note that this will be evaluated after evil
mode&rsquo;s variables are set and right before the rest of the evil config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">I may eventually move this out</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">kill-all-other-buffers</span> ()
  <span style="color: #717171; font-style: italic;">"Kill all buffers except for this and *scratch*."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (mapc 'kill-buffer 
        (delete (current-buffer)
                (delete (get-buffer <span style="color: #b5bd68;">"*scratch*"</span>) (buffer-list))))
  (message <span style="color: #b5bd68;">"Killed all buffers except this and *scratch*."</span>))


(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-leader</span>
  <span style="color: #81a2be;">:init</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-leader/in-all-states 1)

  <span style="color: #81a2be;">:config</span>
  (global-evil-leader-mode)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set leader</span>
  (evil-leader/set-leader <span style="color: #b5bd68;">"SPC"</span>)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient saving</span>
  (evil-leader/set-key <span style="color: #b5bd68;">"f"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                               (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                               (<span style="color: #CC6666; font-weight: bold;">cond</span>
                                ((string-prefix-p <span style="color: #b5bd68;">"*scratch"</span> (buffer-name)) (message <span style="color: #b5bd68;">"(No changes need to be saved)"</span>))
                                ((equal major-mode 'wdired-mode) (wdired-finish-edit))
                                ((equal major-mode 'org-agenda-mode)
                                 (org-save-all-org-buffers)
                                 (message <span style="color: #b5bd68;">"Org buffers saved."</span>)
                                 (progenda-publish-schedule))
                                (t
                                 (<span style="color: #CC6666; font-weight: bold;">if</span> (buffer-modified-p)
                                     (message <span style="color: #b5bd68;">"Wrote %s."</span> (<span style="color: #CC6666; font-weight: bold;">if</span> (null (buffer-file-name))
                                                              <span style="color: #b5bd68;">"file"</span>
                                                            (file-name-nondirectory (buffer-file-name))))
                                   (message <span style="color: #b5bd68;">"(No changes need to be saved)"</span>))
                                 (<span style="color: #CC6666; font-weight: bold;">with-suppressed-message</span>
                                     (call-interactively #'save-buffer))))))


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient exiting</span>
  (evil-leader/set-key <span style="color: #b5bd68;">"e"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                               (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                               (<span style="color: #CC6666; font-weight: bold;">if</span> (equal major-mode 'org-agenda-mode)
                                   (org-agenda-exit)
                                 (kill-this-buffer))))
  (evil-leader/set-key <span style="color: #b5bd68;">"E"</span> #'kill-all-other-buffers)
  (evil-leader/set-key <span style="color: #b5bd68;">"x"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                               (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                               (save-buffer)
                               (kill-this-buffer)))


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">delete current file</span>
  (evil-leader/set-key <span style="color: #b5bd68;">"D"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                               (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                               (<span style="color: #CC6666; font-weight: bold;">if</span> (yes-or-no-p <span style="color: #b5bd68;">"Really truly really delete this file? "</span>)
                                   (delete-file (buffer-file-name)))))


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">display current time</span>
  (evil-leader/set-key <span style="color: #b5bd68;">"j"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                               (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                               (message (format-time-string <span style="color: #b5bd68;">"%H:%M:%S &#8213; %d %b, %Y"</span>))))


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient way to evaluate buffer</span>
  (evil-leader/set-key <span style="color: #b5bd68;">"v"</span> #'eval-buffer)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient terminal opening</span>
  (evil-leader/set-key <span style="color: #b5bd68;">"t"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                               (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                               (vterm (format
                                       <span style="color: #b5bd68;">"*vterm-%s*"</span>
                                       (make-temp-name <span style="color: #b5bd68;">""</span>)))))


  &lt;&lt;calendar-leader&gt;&gt;
  &lt;&lt;capture-leader&gt;&gt;
  &lt;&lt;dictionary-leader&gt;&gt;
  &lt;&lt;dired-leader&gt;&gt;
  &lt;&lt;editing-leader&gt;&gt;
  &lt;&lt;git-leader&gt;&gt;
  &lt;&lt;helm-leader&gt;&gt;
  &lt;&lt;line-number-leader&gt;&gt;
  &lt;&lt;mac-leader&gt;&gt;
  &lt;&lt;mail-leader&gt;&gt;
  &lt;&lt;olivetti-leader&gt;&gt;
  &lt;&lt;org-agenda-leader&gt;&gt;
  &lt;&lt;org-mode-leader&gt;&gt;
  &lt;&lt;scratch-leader&gt;&gt;
  &lt;&lt;script-leader&gt;&gt;
  &lt;&lt;snippet-leader&gt;&gt;
  &lt;&lt;spelling-leader&gt;&gt;
  &lt;&lt;templating-leader&gt;&gt;
  &lt;&lt;window-frame-leader&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7ffe22d" class="outline-3">
<h3 id="org7ffe22d">Evil surround</h3>
<div class="outline-text-3" id="text-org7ffe22d">
<p>
Like tpope&rsquo;s <code>vim-surround</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-surround</span>
  <span style="color: #81a2be;">:config</span>
  (global-evil-surround-mode 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9efb699" class="outline-3">
<h3 id="org9efb699">Evil collection</h3>
<div class="outline-text-3" id="text-org9efb699">
<p>
This package adds evil keybindings to many different modes.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-collection</span>
  <span style="color: #81a2be;">:after</span> evil
  <span style="color: #81a2be;">:config</span>
  (evil-collection-init))
</pre>
</div>
</div>
</div>

<div id="outline-container-org00dc8f5" class="outline-3">
<h3 id="org00dc8f5">Evil args</h3>
<div class="outline-text-3" id="text-org00dc8f5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-args</span>
  <span style="color: #81a2be;">:config</span>
  (define-key evil-inner-text-objects-map <span style="color: #b5bd68;">"g"</span> 'evil-inner-arg)
  (define-key evil-outer-text-objects-map <span style="color: #b5bd68;">"g"</span> 'evil-outer-arg)
  (define-key evil-normal-state-map <span style="color: #b5bd68;">"L"</span> 'evil-forward-arg)
  (define-key evil-normal-state-map <span style="color: #b5bd68;">"H"</span> 'evil-backward-arg))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1faf644" class="outline-3">
<h3 id="org1faf644">Evil embrace</h3>
<div class="outline-text-3" id="text-org1faf644">
<p>
Evil hugs. Very nasty.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">add-general-embrace-pairs</span> ()
  (embrace-add-pair ?\( <span style="color: #b5bd68;">"( "</span> <span style="color: #b5bd68;">" )"</span>)
  (embrace-add-pair ?\) <span style="color: #b5bd68;">"("</span> <span style="color: #b5bd68;">")"</span>)
  (embrace-add-pair ?\[ <span style="color: #b5bd68;">"[ "</span> <span style="color: #b5bd68;">" ]"</span>)
  (embrace-add-pair ?\] <span style="color: #b5bd68;">"["</span> <span style="color: #b5bd68;">"]"</span>)
  (embrace-add-pair ?\{ <span style="color: #b5bd68;">"{ "</span> <span style="color: #b5bd68;">" }"</span>)
  (embrace-add-pair ?\} <span style="color: #b5bd68;">"{"</span> <span style="color: #b5bd68;">"}"</span>))


(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-embrace</span>
  <span style="color: #81a2be;">:ensure</span> t
  <span style="color: #81a2be;">:config</span>
  (evil-embrace-enable-evil-surround-integration)

  (add-hook 'prog-mode-hook #'add-general-embrace-pairs)
  (add-hook 'text-mode-hook #'add-general-embrace-pairs)

  &lt;&lt;latex-mode-embrace&gt;&gt;
  &lt;&lt;org-mode-embrace&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org197896d" class="outline-3">
<h3 id="org197896d">Evil owl</h3>
<div class="outline-text-3" id="text-org197896d">
<p>
Hire owls to report registers and marks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-owl</span>
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-owl-max-string-length 500)
  (add-to-list 'display-buffer-alist
               '(<span style="color: #b5bd68;">"*evil-owl*"</span>
                 (display-buffer-in-side-window)
                 (side . bottom)
                 (window-height . 0.3)))
  (evil-owl-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org143270b" class="outline-3">
<h3 id="org143270b">Evil commentary</h3>
<div class="outline-text-3" id="text-org143270b">
<p>
Better commenting based on tpope&rsquo;s vim-commentary.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-commentary</span>
  <span style="color: #81a2be;">:config</span>

  (evil-commentary-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d5f238" class="outline-3">
<h3 id="org3d5f238">Evil little word</h3>
<div class="outline-text-3" id="text-org3d5f238">
<p>
For short, hurtful comments. And camel case motion.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-little-word</span>
  <span style="color: #81a2be;">:load-path</span> <span style="color: #b5bd68;">"lisp/"</span>
  <span style="color: #81a2be;">:config</span>
  (define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"w"</span>) 'evil-forward-little-word-begin)
  (define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"b"</span>) 'evil-backward-little-word-begin)
  (define-key evil-operator-state-map (kbd <span style="color: #b5bd68;">"w"</span>) 'evil-forward-little-word-begin)
  (define-key evil-operator-state-map (kbd <span style="color: #b5bd68;">"b"</span>) 'evil-backward-little-word-begin)
  (define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"w"</span>) 'evil-forward-little-word-begin)
  (define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"b"</span>) 'evil-backward-little-word-begin)
  (define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"i w"</span>) 'evil-inner-little-word))
</pre>
</div>
</div>
</div>

<div id="outline-container-org71a008b" class="outline-3">
<h3 id="org71a008b">Evil indent plus</h3>
<div class="outline-text-3" id="text-org71a008b">
<p>
For indent-based text objects.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-indent-plus</span>
  <span style="color: #81a2be;">:config</span>
  (evil-indent-plus-default-bindings))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org500de0d" class="outline-2">
<h2 id="org500de0d">Navigation</h2>
<div class="outline-text-2" id="text-org500de0d">
<p>
Motion between and within lines.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">better line motion</span>
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"j"</span>) 'evil-next-visual-line)
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"k"</span>) 'evil-previous-visual-line)
(define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"j"</span>) 'evil-next-visual-line)
(define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"k"</span>) 'evil-previous-visual-line)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">repeat find char remap</span>
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"-"</span>) 'evil-repeat-find-char)
</pre>
</div>

<p>
Scrolling.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"J"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                  (scroll-up 3)))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"K"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                  (scroll-down 3)))

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual global-map (kbd <span style="color: #b5bd68;">"J"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                  (scroll-up 3)))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual global-map (kbd <span style="color: #b5bd68;">"K"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                  (scroll-down 3)))

<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">smooth scrolling</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> scroll-margin 5)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> scroll-conservatively 9999)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> scroll-step 1)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">allow horizontal scrolling with mouse</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> mouse-wheel-tilt-scroll t)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> mouse-wheel-flip-direction t)
</pre>
</div>

<p>
Searching.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use backslash to end search highlighting</span>
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"\\"</span>) #'evil-ex-nohighlight)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-j in isearch</span>
(define-key isearch-mode-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'isearch-exit)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">travel between isearch occurences</span>
(define-key isearch-mode-map (kbd <span style="color: #b5bd68;">"C-n"</span>) #'isearch-repeat-forward)
(define-key isearch-mode-map (kbd <span style="color: #b5bd68;">"C-p"</span>) #'isearch-repeat-backward)
</pre>
</div>

<p>
Jumping.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">swap ' and `</span>
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"`"</span>) #'evil-goto-mark-line)
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"'"</span>) #'evil-goto-mark)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">jump to word with ace-jump-mode</span>
(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">ace-jump-mode</span>
  <span style="color: #81a2be;">:config</span>
  (define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"C-f"</span>) #'ace-jump-word-mode)

  (set-face-attribute 'ace-jump-face-foreground nil
                      <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#cc6666"</span>))
</pre>
</div>
</div>

<div id="outline-container-org3edbf21" class="outline-3">
<h3 id="org3edbf21">Buffer ring</h3>
<div class="outline-text-3" id="text-org3edbf21">
<p>
Create a ring of buffers. I may turn this into a small minor mode in
the future. This also happens to be my first &ldquo;actual&rdquo; emacs lisp
program.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">buffer-toggle-ring</span> '())
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">buffer-toggle-ring-index</span> 0)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">display-buffer-toggle-ring</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (equal (length buffer-toggle-ring) 0)
      (message <span style="color: #b5bd68;">"Buffer ring empty."</span>)
    (message <span style="color: #b5bd68;">"%s"</span> (string-join
                   (mapcar (<span style="color: #CC6666; font-weight: bold;">lambda</span> (buffer)
                             (propertize (buffer-name buffer) 'face 'helm-buffer-file))
                           buffer-toggle-ring)
                   <span style="color: #b5bd68;">"\n"</span>))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">remove-current-from-buffer-ring</span> ()
  <span style="color: #717171; font-style: italic;">"Remove current buffer from buffer ring."</span>
  (<span style="color: #CC6666; font-weight: bold;">when</span> (member (current-buffer) buffer-toggle-ring)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> buffer-toggle-ring (delete (current-buffer) buffer-toggle-ring))
    (display-buffer-toggle-ring)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> buffer-toggle-ring-index (- buffer-toggle-ring-index 1))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">toggle-buffer-in-buffer-ring</span> ()
  <span style="color: #717171; font-style: italic;">"Add/remove current buffer from ring."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (member (current-buffer) buffer-toggle-ring)
      (remove-current-from-buffer-ring)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> buffer-toggle-ring (insert-after buffer-toggle-ring buffer-toggle-ring-index (current-buffer)))
    (display-buffer-toggle-ring)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> buffer-toggle-ring-index (+ buffer-toggle-ring-index 1))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">switch-to-next-buffer-in-ring</span> ()
  <span style="color: #717171; font-style: italic;">"Switch to next buffer in ring."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">when</span> (&gt; (length buffer-toggle-ring) 0)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> buffer-toggle-ring-index (mod (+ buffer-toggle-ring-index 1) (length buffer-toggle-ring)))
    (switch-to-buffer (nth buffer-toggle-ring-index buffer-toggle-ring))))


(add-hook 'kill-buffer-hook #'remove-current-from-buffer-ring)


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"&lt;S-backspace&gt;"</span>) #'toggle-buffer-in-buffer-ring)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"&lt;backspace&gt;"</span>) #'switch-to-next-buffer-in-ring)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"&lt;C-backspace&gt;"</span>) #'display-buffer-toggle-ring)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0ae95d1" class="outline-3">
<h3 id="org0ae95d1">Helm</h3>
<div class="outline-text-3" id="text-org0ae95d1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">helm</span>
  <span style="color: #81a2be;">:config</span>
  (helm-mode 1)

  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> helm-completion-style 'emacs)
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> helm-left-margin-width 1)
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> helm-buffers-left-margin-width 1)
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> helm-buffer-details-flag nil)

  &lt;&lt;helm-keys&gt;&gt;
  &lt;&lt;helm-faces&gt;&gt;)
</pre>
</div>

<p>
Define <code>evil-leader</code> bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open the minibuffer</span>
(evil-leader/set-key <span style="color: #b5bd68;">"k"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">let</span> ((pop-up-windows t))
                               (call-interactively #'helm-mini))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open command minibuffer</span>
(evil-leader/set-key <span style="color: #b5bd68;">";"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">let</span> ((pop-up-windows t))
                               (call-interactively #'helm-M-x))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">for helm-ag</span>
(evil-leader/set-key <span style="color: #b5bd68;">"g"</span> #'helm-ag)
</pre>
</div>

<p>
Customize helm appearance.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'helm-candidate-number nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#BAA659"</span>
                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#121112"</span>)


(set-face-attribute 'helm-header-line-left-margin nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#BAB771"</span>
                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#121112"</span>)


(set-face-attribute 'helm-selection nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#191919"</span>
                    <span style="color: #81a2be;">:weight</span> 'bold)


(set-face-attribute 'helm-ff-file-extension nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:foreground</span> 'unspecified)


(set-face-attribute 'helm-buffer-directory nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:background</span> 'unspecified
                    <span style="color: #81a2be;">:foreground</span> 'unspecified
                    <span style="color: #81a2be;">:underline</span> t
                    <span style="color: #81a2be;">:weight</span> 'bold)


(set-face-attribute 'helm-source-header nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#121112"</span>
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#7d7461"</span>
                    <span style="color: #81a2be;">:slant</span> 'italic
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Victor Mono"</span>)


(set-face-attribute 'helm-buffer-saved-out nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:background</span> 'unspecified
                    <span style="color: #81a2be;">:foreground</span> color-red)


(set-face-attribute 'helm-ff-denied nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:background</span> 'unspecified
                    <span style="color: #81a2be;">:foreground</span> color-red)
</pre>
</div>

<p>
Define key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key helm-map (kbd <span style="color: #b5bd68;">"M-]"</span>) 'helm-next-source)
(define-key helm-map (kbd <span style="color: #b5bd68;">"M-["</span>) 'helm-previous-source)


(define-key helm-map (kbd <span style="color: #b5bd68;">"C-j"</span>) 'helm-confirm-and-exit-minibuffer)
(define-key helm-map (kbd <span style="color: #b5bd68;">"C-k"</span>) 'helm-execute-persistent-action)


(define-key helm-map (kbd <span style="color: #b5bd68;">"C-M-j"</span>) 'helm-cr-empty-string)


(define-key helm-read-file-map (kbd <span style="color: #b5bd68;">"C-j"</span>) 'helm-ff-RET)


(global-set-key (kbd <span style="color: #b5bd68;">"M-x"</span>) 'helm-M-x)
</pre>
</div>

<p>
Redefine buffers list to be more careful.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">helm-buffer-list</span> ()
  <span style="color: #717171; font-style: italic;">"Return the current list of buffers.</span>
<span style="color: #717171; font-style: italic;">The list is reordered with `</span><span style="color: #CC6666; font-style: italic;">helm-buffer-list-reorder-fn</span><span style="color: #717171; font-style: italic;">'."</span>
  (helm-buffer-list-1))
</pre>
</div>
</div>

<div id="outline-container-orgae52012" class="outline-4">
<h4 id="orgae52012">Helm ag</h4>
<div class="outline-text-4" id="text-orgae52012">
<p>
Ensure <code>helm-ag</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">helm-ag</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org4d9cb85" class="outline-4">
<h4 id="org4d9cb85">Helm projectile</h4>
<div class="outline-text-4" id="text-org4d9cb85">
<p>
<code>helm-projectile</code> config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">helm-projectile</span>
  <span style="color: #81a2be;">:ensure</span> t
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> projectile-git-submodule-command nil)

  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">projectile not working until I figure it out</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> helm-mini-default-sources '(helm-source-bookmarks
                                            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">helm-source-projectile-recentf-list</span>
                                            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">helm-source-projectile-buffers-list</span>
                                            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">helm-source-projectile-projects</span>
                                            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">helm-source-projectile-files-list</span>
                                            helm-source-buffers-list
                                            helm-source-recentf)))
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orge3c7135" class="outline-2">
<h2 id="orge3c7135">Editing</h2>
<div class="outline-text-2" id="text-orge3c7135">
<p>
General editing config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">tab width</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> tab-width 4)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> c-basic-offset 4)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> indent-tabs-mode nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-j to join in visual mode</span>
(define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'evil-join)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop blinking, cursor. seriously.</span>
(blink-cursor-mode -1)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">show matching parenthesis</span>
(show-paren-mode t)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set fill column (obviously)</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> fill-column 75)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure sentences are not limited to those that are double-space-separated</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> sentence-end-double-space nil)
</pre>
</div>

<p>
Hooks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">disable auto-fill-mode when asked politely</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">enable-polite-auto-fill</span> ()
  (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (org-keyword-activep <span style="color: #b5bd68;">"AUTOFILL"</span> nil)
             (not (org-keyword-activep <span style="color: #b5bd68;">"LITERARY"</span>)))
    (auto-fill-mode 1)))


(add-hook 'text-mode-hook #'enable-polite-auto-fill)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">highlight current line</span>
(add-hook 'prog-mode-hook #'hl-line-mode)
</pre>
</div>

<p>
Split paragraph into sentences.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">last-paragraph-sentence-split</span> nil
  <span style="color: #717171; font-style: italic;">"Dotted list holding markers for the first and last paragraphs</span>
<span style="color: #717171; font-style: italic;">after using split-paragraph-into-sentences."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">split-paragraph-into-sentences</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (<span style="color: #CC6666; font-weight: bold;">let*</span> ((sentence-count 0)
           (paragraph-bounds (<span style="color: #CC6666; font-weight: bold;">if</span> (use-region-p)
                                 `(,(region-beginning) . ,(region-end))
                               (mark-paragraph)
                               `(,(point) . ,(mark))))
           (beginning-marker (<span style="color: #CC6666; font-weight: bold;">progn</span>
                               (goto-char (car paragraph-bounds))
                               (point-marker))))
      (forward-sentence)
      (<span style="color: #CC6666; font-weight: bold;">while</span> (&lt; (point) (cdr paragraph-bounds))
        (delete-char 1)
        (insert <span style="color: #b5bd68;">"\n\n"</span>)
        <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">(fill-paragraph)</span>
        (forward-sentence)
        (<span style="color: #CC6666; font-weight: bold;">setq</span> sentence-count (+ 1 sentence-count)))
      (<span style="color: #CC6666; font-weight: bold;">setq</span> last-paragraph-sentence-split
            `(,beginning-marker . ,(point-marker))))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">join-sentences-into-paragraph</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((start (marker-position (car last-paragraph-sentence-split)))
          (end (marker-position (cdr last-paragraph-sentence-split))))
      (goto-char start)
      (join-line nil (+ 1 start) end)
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">(fill-paragraph)</span>
      )
    (<span style="color: #CC6666; font-weight: bold;">setq</span> last-paragraph-sentence-split nil)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">toggle-sentence-split</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> last-paragraph-sentence-split
      (join-sentences-into-paragraph)
    (split-paragraph-into-sentences)))
</pre>
</div>

<p>
Rotate text (thanks, <a href="https://www.emacswiki.org/emacs/RotateText">Emacs Wiki</a>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">rotate-text-rotations</span>
  '((<span style="color: #b5bd68;">"true"</span> <span style="color: #b5bd68;">"false"</span>)
    (<span style="color: #b5bd68;">"True"</span> <span style="color: #b5bd68;">"False"</span>)
    (<span style="color: #b5bd68;">"yes"</span> <span style="color: #b5bd68;">"no"</span>)
    (<span style="color: #b5bd68;">"0"</span> <span style="color: #b5bd68;">"1"</span>)
    (<span style="color: #b5bd68;">"+"</span> <span style="color: #b5bd68;">"-"</span>))
  <span style="color: #717171; font-style: italic;">"List of text rotation sets."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">rotate-region</span> (beg end)
  <span style="color: #717171; font-style: italic;">"Rotate all matches in `</span><span style="color: #CC6666; font-style: italic;">rotate-text-rotations</span><span style="color: #717171; font-style: italic;">' between point and mark."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"r"</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((regexp (rotate-convert-rotations-to-regexp
         rotate-text-rotations))
    (end-mark (copy-marker end)))
    (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
      (goto-char beg)
      (<span style="color: #CC6666; font-weight: bold;">while</span> (re-search-forward regexp (marker-position end-mark) t)
    (<span style="color: #CC6666; font-weight: bold;">let*</span> ((found (match-string 0))
           (replace (rotate-next found)))
      (replace-match replace))))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">rotate-string</span> (string <span style="color: #6CA17A;">&amp;optional</span> rotations)
  <span style="color: #717171; font-style: italic;">"Rotate all matches in STRING using associations in ROTATIONS.</span>
<span style="color: #717171; font-style: italic;">If ROTATIONS are not given it defaults to `</span><span style="color: #CC6666; font-style: italic;">rotate-text-rotations</span><span style="color: #717171; font-style: italic;">'."</span>
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((regexp (rotate-convert-rotations-to-regexp
         (<span style="color: #CC6666; font-weight: bold;">or</span> rotations rotate-text-rotations)))
    (start 0))
    (<span style="color: #CC6666; font-weight: bold;">while</span> (string-match regexp string start)
      (<span style="color: #CC6666; font-weight: bold;">let*</span> ((found (match-string 0 string))
         (replace (rotate-next
               found
               (<span style="color: #CC6666; font-weight: bold;">or</span> rotations rotate-text-rotations))))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> start (+ (match-end 0)
               (- (length replace) (length found))))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> string (replace-match replace nil t string))))
    string))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">rotate-next</span> (string <span style="color: #6CA17A;">&amp;optional</span> rotations)
  <span style="color: #717171; font-style: italic;">"Return the next element after STRING in ROTATIONS."</span>
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((rots (rotate-get-rotations-for
           string
           (<span style="color: #CC6666; font-weight: bold;">or</span> rotations rotate-text-rotations))))
    (<span style="color: #CC6666; font-weight: bold;">if</span> (&gt; (length rots) 1)
    (<span style="color: #f0c674;">error</span> (format <span style="color: #b5bd68;">"Ambiguous rotation for %s"</span> string))
      (<span style="color: #CC6666; font-weight: bold;">if</span> (&lt; (length rots) 1)
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">If we get this far, this should not occur:</span>
      (<span style="color: #f0c674;">error</span> (format <span style="color: #b5bd68;">"Unknown rotation for %s"</span> string))
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((occurs-in-rots (member string (car rots))))
      (<span style="color: #CC6666; font-weight: bold;">if</span> (null occurs-in-rots)
          <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">If we get this far, this should *never* occur:</span>
          (<span style="color: #f0c674;">error</span> (format <span style="color: #b5bd68;">"Unknown rotation for %s"</span> string))
      (<span style="color: #CC6666; font-weight: bold;">if</span> (null (cdr occurs-in-rots))
          (caar rots)
        (cadr occurs-in-rots))))))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">rotate-get-rotations-for</span> (string <span style="color: #6CA17A;">&amp;optional</span> rotations)
  <span style="color: #717171; font-style: italic;">"Return the string rotations for STRING in ROTATIONS."</span>
  (remq nil (mapcar (<span style="color: #CC6666; font-weight: bold;">lambda</span> (rot) (<span style="color: #CC6666; font-weight: bold;">if</span> (member string rot) rot))
            (<span style="color: #CC6666; font-weight: bold;">or</span> rotations rotate-text-rotations))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">rotate-convert-rotations-to-regexp</span> (rotations)
  (regexp-opt (rotate-flatten-list rotations)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">rotate-flatten-list</span> (list-of-lists)
  <span style="color: #717171; font-style: italic;">"Flatten LIST-OF-LISTS to a single list.</span>
<span style="color: #717171; font-style: italic;">Example:</span>
<span style="color: #717171; font-style: italic;">  (rotate-flatten-list '((a b c) (1 ((2 3)))))</span>
<span style="color: #717171; font-style: italic;">    =&gt; (a b c 1 2 3)"</span>
  (<span style="color: #CC6666; font-weight: bold;">if</span> (null list-of-lists)
      list-of-lists
    (<span style="color: #CC6666; font-weight: bold;">if</span> (listp list-of-lists)
    (append (rotate-flatten-list (car list-of-lists))
        (rotate-flatten-list (cdr list-of-lists)))
      (list list-of-lists))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">rotate-word-at-point</span> ()
  <span style="color: #717171; font-style: italic;">"Rotate word at point based on sets in `</span><span style="color: #CC6666; font-style: italic;">rotate-text-rotations</span><span style="color: #717171; font-style: italic;">'."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((bounds (bounds-of-thing-at-point 'symbol))
        (opoint (point)))
    (<span style="color: #CC6666; font-weight: bold;">when</span> (consp bounds)
      (<span style="color: #CC6666; font-weight: bold;">let</span> ((beg (car bounds))
            (end (copy-marker (cdr bounds))))
        (rotate-region beg end)
        (goto-char (<span style="color: #CC6666; font-weight: bold;">if</span> (&gt; opoint end) end opoint))))))


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"g r r"</span>) #'rotate-word-at-point)
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-j for command prompt</span>
(define-key evil-ex-completion-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'exit-minibuffer)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">insert spaces without leaving normal mode</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal 'org-mode-map (kbd <span style="color: #b5bd68;">"z l"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                       (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                       (forward-char)
                                                       (insert <span style="color: #b5bd68;">" "</span>)))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal 'org-mode-map (kbd <span style="color: #b5bd68;">"z h"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                       (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                       (insert <span style="color: #b5bd68;">" "</span>)
                                                       (evil-backward-char)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">capitalization</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"g </span><span style="color: #f0c674;">\</span><span style="color: #b5bd68;">'"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                     (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                     (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                                                       (<span style="color: #CC6666; font-weight: bold;">if</span> (not (equal (char-before) ? ))
                                                           (evil-backward-word-begin 1))
                                                       (upcase-char 1))))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"g \""</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                     (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                     (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                                                       (<span style="color: #CC6666; font-weight: bold;">if</span> (not (equal (char-before) ? ))
                                                           (evil-backward-word-begin 1))
                                                       (downcase-word 1))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure C-j doesn't actually create a new line in normal state</span>
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'evil-ret)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">delete char the fast way</span>
(define-key key-translation-map (kbd <span style="color: #b5bd68;">"C-h"</span>) [127])


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-j as RET</span>
(global-set-key (kbd <span style="color: #b5bd68;">"C-j"</span>) #'newline)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set convenient line-opening</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">open-line-down</span> ()
  <span style="color: #717171; font-style: italic;">"Open and move to next line."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (call-interactively 'move-end-of-line)
  (newline))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">open-line-up</span> ()
  <span style="color: #717171; font-style: italic;">"Open and move to previous line."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (call-interactively 'move-beginning-of-line)
  (newline)
  (forward-line -1))


(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"z j"</span>) #'open-line-down)
(define-key evil-normal-state-map (kbd <span style="color: #b5bd68;">"z k"</span>) #'open-line-up)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">evil-shift-right-preserve</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (evil-shift-right evil-visual-beginning evil-visual-end)
  (evil-normal-state)
  (evil-visual-restore))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">evil-shift-left-preserve</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (evil-shift-left evil-visual-beginning evil-visual-end)
  (evil-normal-state)
  (evil-visual-restore))


(define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"&gt;"</span>) #'evil-shift-right-preserve)
(define-key evil-visual-state-map (kbd <span style="color: #b5bd68;">"&lt;"</span>) #'evil-shift-left-preserve)


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'insert global-map (kbd <span style="color: #b5bd68;">"C-M-\\"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (literal-string)
      (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"sInsert literal: "</span>)
      (insert literal-string)))
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">zoom in/out</span>
(evil-leader/set-key <span style="color: #b5bd68;">"="</span> #'text-scale-adjust)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">toggle sentence split</span>
(evil-leader/set-key <span style="color: #b5bd68;">"s"</span> #'toggle-sentence-split)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">switch input method</span>
(evil-leader/set-key <span style="color: #b5bd68;">"\\"</span> #'toggle-input-method)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">count occurrences</span>
(evil-leader/set-key <span style="color: #b5bd68;">"F"</span> #'count-matches)
</pre>
</div>
</div>

<div id="outline-container-orgb1ff976" class="outline-3">
<h3 id="orgb1ff976">Snippets</h3>
<div class="outline-text-3" id="text-orgb1ff976">
<p>
Enable YASnippet.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">yasnippet</span>
  <span style="color: #81a2be;">:ensure</span> t
  <span style="color: #81a2be;">:config</span>
  (yas-global-mode)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-, instead of tab to expand</span>
  (define-key yas-minor-mode-map [(tab)] nil)
  (define-key yas-minor-mode-map (kbd <span style="color: #b5bd68;">"TAB"</span>) nil)

  (define-key yas-minor-mode-map (kbd <span style="color: #b5bd68;">"C-b"</span>) #'yas-prev-field)

  (define-key yas-minor-mode-map (kbd <span style="color: #b5bd68;">"C-,"</span>)
              #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                  (<span style="color: #CC6666; font-weight: bold;">let</span> ((inhibit-message t))
                    (yas-expand)
                    (org-toggle-pretty-entities)
                    (org-toggle-pretty-entities))))
              


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">disable out-of-field modification warning (for laas)</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> yas-inhibit-overlay-modification-protection t) 


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure latex snippets work in org-mode</span>
  (add-hook 'org-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (yas-minor-mode)
                             (yas-activate-extra-mode 'latex-mode))))
</pre>
</div>

<p>
Matrix-like snippets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">insert-matrix-like</span> (env rows cols <span style="color: #6CA17A;">&amp;optional</span> arguments)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"sEnvironment: \nnRows: \nnColumns: "</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((beginning-marker (point-marker))
        (end-marker (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                      (goto-char (1+ (point)))))
        (matrix-string <span style="color: #b5bd68;">""</span>))
    (insert (format <span style="color: #b5bd68;">"\\begin{%s}%s\n"</span> env (<span style="color: #CC6666; font-weight: bold;">if</span> arguments arguments <span style="color: #b5bd68;">""</span>)))
    (<span style="color: #CC6666; font-weight: bold;">dotimes</span> (i rows)
      (<span style="color: #CC6666; font-weight: bold;">dotimes</span> (j cols)
        (<span style="color: #CC6666; font-weight: bold;">setq</span> matrix-string (concat matrix-string
                                    (format
                                     (<span style="color: #CC6666; font-weight: bold;">if</span> (equal j (1- cols)) <span style="color: #b5bd68;">"$%s"</span> <span style="color: #b5bd68;">"$%s &amp; "</span>)
                                     (+ 1 (* i cols) j)))))
      (<span style="color: #CC6666; font-weight: bold;">setq</span> matrix-string (concat matrix-string (<span style="color: #CC6666; font-weight: bold;">if</span> (equal i (1- rows)) (format <span style="color: #b5bd68;">"\n\\end{%s}"</span> env) <span style="color: #b5bd68;">"\\\\\\\n"</span>))))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> my/unhiding-current-line nil)
    (yas-expand-snippet matrix-string)
    (add-hook 'yas-after-exit-snippet-hook #'align-yasnippet-matrix)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">align-matrix</span> (start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"r"</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (not (region-active-p))
      (<span style="color: #CC6666; font-weight: bold;">save-mark-and-excursion</span>
        (<span style="color: #CC6666; font-weight: bold;">let</span> ((inhibit-message t))
          (er/mark-LaTeX-inside-environment))
        (<span style="color: #CC6666; font-weight: bold;">setq</span> start (point))
        (<span style="color: #CC6666; font-weight: bold;">setq</span> end (mark))))
  (<span style="color: #CC6666; font-weight: bold;">setq</span> my/unhiding-current-line nil)
  (align-regexp start end <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">\\s-*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;"> &amp;"</span> 1 1 t)
  (<span style="color: #CC6666; font-weight: bold;">setq</span> my/unhiding-current-line t))


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual org-mode-map (kbd <span style="color: #b5bd68;">"g r a"</span>) #'align-matrix)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g r a"</span>) #'align-matrix)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">align-yasnippet-matrix</span> ()
  (align-regexp yas-snippet-beg yas-snippet-end <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">\\s-*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;"> &amp;"</span> 1 1 t)
  (<span style="color: #CC6666; font-weight: bold;">setq</span> my/unhiding-current-line t)
  (remove-hook 'yas-after-exit-snippet-hook #'align-yasnippet-matrix))
</pre>
</div>

<p>
Piecewise case snippet.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">snippet-create-n-cases</span> (n)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((snippet-string <span style="color: #b5bd68;">""</span>)
        (yas-indent-line 'fixed)
        (yas-wrap-around-region 'nil))
    (<span style="color: #CC6666; font-weight: bold;">dotimes</span> (i n)
      (<span style="color: #CC6666; font-weight: bold;">setq</span> snippet-string (format <span style="color: #b5bd68;">"%s$%d &amp; \\text{if } $%d\\\\\\\n"</span>
                                   snippet-string
                                   (+ (* 2 i) 1)
                                   (+ (* 2 i) 2))))
    (yas-expand-snippet (format <span style="color: #b5bd68;">"\\begin{cases}\n%s\\end{cases}"</span> snippet-string))))

(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">snippet-create-cases</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((n (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
             (goto-char (- (point) 1))
             (number-at-point))))
    (<span style="color: #CC6666; font-weight: bold;">if</span> n
        (<span style="color: #CC6666; font-weight: bold;">progn</span>
          (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
            (goto-char (- (point) 1))
            (<span style="color: #CC6666; font-weight: bold;">let</span> ((bounds (bounds-of-thing-at-point 'number)))
              (delete-region (car bounds) (cdr bounds))))
          (snippet-create-n-cases n))
      (snippet-create-n-cases 2))))
</pre>
</div>

<p>
Automatic fraction snippets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">snippet-convert-fraction</span> (start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (<span style="color: #CC6666; font-weight: bold;">if</span> (region-active-p)
       (list (region-beginning) (region-end))
     '(nil nil)))

  (<span style="color: #CC6666; font-weight: bold;">if</span> (null start)
      (<span style="color: #CC6666; font-weight: bold;">if</span> (not (texmathp))
          (insert <span style="color: #b5bd68;">"/"</span>)
        (<span style="color: #CC6666; font-weight: bold;">pcase</span> (char-before)
          (?/
           (delete-backward-char 1)
           (yas-expand-snippet <span style="color: #b5bd68;">"\\dfrac{$1}{$2}$0"</span>))
          (?.
           (delete-backward-char 1)
           (insert <span style="color: #b5bd68;">"/"</span>))
          (?,
           (delete-backward-char 1)
           (insert <span style="color: #b5bd68;">"\\big/"</span>))
          (-
           (insert <span style="color: #b5bd68;">"/"</span>)

           (<span style="color: #CC6666; font-weight: bold;">let</span> ((found-brace 0)
                 (limit (point))
                 (match nil)
                 (match-start nil))
             (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
               (goto-char (1- (point)))
               (<span style="color: #CC6666; font-weight: bold;">while</span> (<span style="color: #CC6666; font-weight: bold;">and</span>
                       (texmathp)
                       (&gt; (point) (line-beginning-position))
                       (not (equal (char-after) ? ))
                       (not (equal (char-after) ?-))
                       (not (<span style="color: #CC6666; font-weight: bold;">and</span> (memq (char-after) '(?{ ?\()) (equal found-brace 0))))
                 (<span style="color: #CC6666; font-weight: bold;">pcase</span> (char-after)
                   ((<span style="color: #CC6666; font-weight: bold;">or</span> ?} ?\)) (<span style="color: #CC6666; font-weight: bold;">setq</span> found-brace (1+ found-brace)))
                   ((<span style="color: #CC6666; font-weight: bold;">or</span> ?{ ?\() (<span style="color: #CC6666; font-weight: bold;">setq</span> found-brace (1- found-brace))))
                 (goto-char (1- (point))))
               (<span style="color: #CC6666; font-weight: bold;">when</span> (re-search-forward <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(?:</span><span style="color: #b5bd68;">^</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(?1:</span><span style="color: #b5bd68;">.+</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">/</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(?:</span><span style="color: #b5bd68;">[ -{(]</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(?1:</span><span style="color: #b5bd68;">.+</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">/</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span> limit t)
                 (<span style="color: #CC6666; font-weight: bold;">setq</span> match (match-string 1))
                 (<span style="color: #CC6666; font-weight: bold;">setq</span> match-start (match-beginning 1))))

             (<span style="color: #CC6666; font-weight: bold;">when</span> match-start
               (delete-region match-start limit)
               (yas-expand-snippet (format <span style="color: #b5bd68;">"\\dfrac{%s}{$1}$0"</span> match)))))))
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((numerator (buffer-substring start end)))
      (evil-insert-state)
      (delete-region start end)
      (yas-expand-snippet (format <span style="color: #b5bd68;">"\\dfrac{%s}{$1}$0"</span> numerator)))))


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'insert org-mode-map (kbd <span style="color: #b5bd68;">"/"</span>) #'snippet-convert-fraction)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual org-mode-map (kbd <span style="color: #b5bd68;">"/"</span>) #'snippet-convert-fraction)
</pre>
</div>

<p>
Flip sides of equation.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">swap-equation-sides</span> (start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (<span style="color: #CC6666; font-weight: bold;">if</span> (region-active-p)
       (list (region-beginning) (region-end))
     `(,(line-beginning-position) ,(line-end-position))))
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (goto-char start)
    (re-search-forward <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">.*?</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[[:blank:]]*&amp;?=[[:blank:]]*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">.*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span> end)

    (<span style="color: #CC6666; font-weight: bold;">let</span> ((LHS (match-string 1))
          (equals (match-string 2))
          (RHS (match-string 3)))
      (delete-region start end)
      (insert (format <span style="color: #b5bd68;">"%s%s%s"</span> RHS equals LHS)))))

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual org-mode-map (kbd <span style="color: #b5bd68;">"="</span>) #'swap-equation-sides)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g ="</span>) #'swap-equation-sides)
</pre>
</div>

<p>
Variable substitution (not strictly a snippet).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">TODO Create stronger criteria for variable subsitution (maybe incorporating thing at point, with exceptions for numbers and other variables)</span>

(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">string-substitute-math-variables</span> (contents vars)
  (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
    (insert contents)
    (<span style="color: #CC6666; font-weight: bold;">dolist</span> (pair (split-string vars <span style="color: #b5bd68;">","</span>))
      (<span style="color: #CC6666; font-weight: bold;">-let</span> (((var value) (split-string pair <span style="color: #b5bd68;">"="</span>)))
        (<span style="color: #CC6666; font-weight: bold;">condition-case</span> nil
            (<span style="color: #CC6666; font-weight: bold;">while</span> (replace-regexp-in-region
                    var
                    (format <span style="color: #b5bd68;">"(%s)"</span> value)
                    (point-min) (point-max)))
          (<span style="color: #f0c674;">error</span> nil))))
    (buffer-string)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">substitute-math-variables</span> (vars start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (append (list (read-string <span style="color: #b5bd68;">"Enter variable-value pairs (e.g., \"x=4,y=7\"): "</span>))
           (<span style="color: #CC6666; font-weight: bold;">if</span> (use-region-p)
               (list (region-beginning) (region-end))
             (list (line-beginning-position) (line-end-position)))))

  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((contents (buffer-substring start end)))
      (goto-char end)
      (insert (string-substitute-math-variables contents vars)))
    (delete-region start end)))


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"g r s"</span>) #'substitute-math-variables)
</pre>
</div>

<p>
Anonymous snippets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">anonymous-snippet</span> <span style="color: #b5bd68;">""</span>
  <span style="color: #717171; font-style: italic;">"Stores a temporary-use snippet."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">create-anonymous-snippet</span> (snippet)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"sSnippet: "</span>)
  (<span style="color: #CC6666; font-weight: bold;">setq</span> anonymous-snippet snippet))


(define-key global-map (kbd <span style="color: #b5bd68;">"C-s"</span>) #'create-anonymous-snippet)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">expand-anonymous-snippet</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (yas-expand-snippet anonymous-snippet))
</pre>
</div>

<p>
Enable AAS.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">It may be interesting to note that the following combinations don't appear in</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">English: bx, cj, cv, cx, dx, fq, fx, gq, gx, hx, jc, jf, jg, jq, js, jv, jw,</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">jx, jz, kq, kx, mx, px, pz, qb, qc, qd, qf, qg, qh, qj, qk, ql, qm, qn, qp,</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">qs, qt, qv, qw, qx, qy, qz, sx, vb, vf, vh, vj, vm, vp, vq, vt, vw, vx, wx,</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">xj, xx, zj, zq, zx</span>


  (<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">aas</span>
    <span style="color: #81a2be;">:hook</span> (LaTeX-mode . aas-activate-for-major-mode)
    <span style="color: #81a2be;">:hook</span> (org-mode . aas-activate-for-major-mode)
    <span style="color: #81a2be;">:config</span>
    (aas-set-snippets 'text-mode
      <span style="color: #b5bd68;">";o-"</span> <span style="color: #b5bd68;">"&#333;"</span>
      <span style="color: #b5bd68;">";i-"</span> <span style="color: #b5bd68;">"&#299;"</span>
      <span style="color: #b5bd68;">";a-"</span> <span style="color: #b5bd68;">"&#257;"</span>
      <span style="color: #b5bd68;">";u-"</span> <span style="color: #b5bd68;">"&#363;"</span>
      <span style="color: #b5bd68;">";e-"</span> <span style="color: #b5bd68;">"&#275;"</span>
      <span style="color: #b5bd68;">"a-0"</span> #'expand-anonymous-snippet)

    (aas-set-snippets 'org-mode
      <span style="color: #b5bd68;">"js"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
             (yas-expand-snippet <span style="color: #b5bd68;">"\\\\( $1 \\\\)$0"</span>))
      <span style="color: #b5bd68;">"jf"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
             (yas-expand-snippet <span style="color: #b5bd68;">"\\begin{alignat*}{3}\n$0\n\\end{alignat*}"</span>)))

    (aas-set-snippets 'org-mode
      <span style="color: #81a2be;">:cond</span> #'texmathp
      <span style="color: #b5bd68;">"cas"</span> #'snippet-create-cases
      <span style="color: #b5bd68;">"=-0"</span> #'swap-equation-sides
      <span style="color: #b5bd68;">"3det"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"vmatrix"</span> 3 3))
      <span style="color: #b5bd68;">"2det"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"vmatrix"</span> 2 2))
      <span style="color: #b5bd68;">"3mat"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"bmatrix"</span> 3 3))
      <span style="color: #b5bd68;">"2mat"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"bmatrix"</span> 2 2))
      <span style="color: #b5bd68;">"2amat"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"amatrix"</span> 2 3 <span style="color: #b5bd68;">"{2}"</span>))
      <span style="color: #b5bd68;">"3amat"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"amatrix"</span> 3 4 <span style="color: #b5bd68;">"{3}"</span>))
      <span style="color: #b5bd68;">"4amat"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"amatrix"</span> 4 5 <span style="color: #b5bd68;">"{4}"</span>))
      <span style="color: #b5bd68;">"matr"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> (rows cols) (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"nRows: \nnColumns: "</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"bmatrix"</span> rows cols))
      <span style="color: #b5bd68;">"cmat"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> (rows) (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"nRows: "</span>)
               (insert-matrix-like <span style="color: #b5bd68;">"bmatrix"</span> rows 1))
      <span style="color: #b5bd68;">"2cv"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
              (insert-matrix-like <span style="color: #b5bd68;">"bmatrix"</span> 2 1))
      <span style="color: #b5bd68;">"3cv"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
              (insert-matrix-like <span style="color: #b5bd68;">"bmatrix"</span> 3 1))
      <span style="color: #b5bd68;">"4cv"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
              (insert-matrix-like <span style="color: #b5bd68;">"bmatrix"</span> 4 1))
      <span style="color: #b5bd68;">"amatr"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> (rows cols sep)
                (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"nRows: \nnColumns: \nnSeparate at: "</span>)
                (insert-matrix-like <span style="color: #b5bd68;">"aamatrix"</span> rows cols
                                    (format <span style="color: #b5bd68;">"{%s}{%s}"</span> sep (- cols sep))))
      <span style="color: #b5bd68;">"matl"</span> #'insert-matrix-like)

    (<span style="color: #CC6666; font-weight: bold;">let</span> ((snippets '((<span style="color: #b5bd68;">"sup"</span> . <span style="color: #b5bd68;">"^{$1$0"</span>)
                      (<span style="color: #b5bd68;">"ud"</span> . <span style="color: #b5bd68;">"_{$1$0"</span>)
                      (<span style="color: #b5bd68;">"jg"</span> . <span style="color: #b5bd68;">"^2$0"</span>)
                      (<span style="color: #b5bd68;">"jc"</span> . <span style="color: #b5bd68;">"^3$0"</span>)

                      (<span style="color: #b5bd68;">"gal"</span> . <span style="color: #b5bd68;">"\\alpha$0"</span>)
                      (<span style="color: #b5bd68;">"gbe"</span> . <span style="color: #b5bd68;">"\\beta$0"</span>)
                      (<span style="color: #b5bd68;">"gga"</span> . <span style="color: #b5bd68;">"\\gamma$0"</span>)
                      (<span style="color: #b5bd68;">"gde"</span> . <span style="color: #b5bd68;">"\\delta$0"</span>)
                      (<span style="color: #b5bd68;">"gep"</span> . <span style="color: #b5bd68;">"\\epsilon$0"</span>)
                      (<span style="color: #b5bd68;">"gze"</span> . <span style="color: #b5bd68;">"\\zeta$0"</span>)
                      (<span style="color: #b5bd68;">"geta"</span> . <span style="color: #b5bd68;">"\\eta$0"</span>)
                      (<span style="color: #b5bd68;">"gth"</span> . <span style="color: #b5bd68;">"\\theta$0"</span>)
                      (<span style="color: #b5bd68;">"gio"</span> . <span style="color: #b5bd68;">"\\iota$0"</span>)
                      (<span style="color: #b5bd68;">"gka"</span> . <span style="color: #b5bd68;">"\\kappa$0"</span>)
                      (<span style="color: #b5bd68;">"gla"</span> . <span style="color: #b5bd68;">"\\lambda$0"</span>)
                      (<span style="color: #b5bd68;">"gmu"</span> . <span style="color: #b5bd68;">"\\mu$0"</span>)
                      (<span style="color: #b5bd68;">"gnu"</span> . <span style="color: #b5bd68;">"\\nu$0"</span>)
                      (<span style="color: #b5bd68;">"gxi"</span> . <span style="color: #b5bd68;">"\\xi$0"</span>)
                      (<span style="color: #b5bd68;">"gmi"</span> . <span style="color: #b5bd68;">"\\omicron$0"</span>)
                      (<span style="color: #b5bd68;">"gpi"</span> . <span style="color: #b5bd68;">"\\pi$0"</span>)
                      (<span style="color: #b5bd68;">"grh"</span> . <span style="color: #b5bd68;">"\\rho$0"</span>)
                      (<span style="color: #b5bd68;">"gsi"</span> . <span style="color: #b5bd68;">"\\sigma$0"</span>)
                      (<span style="color: #b5bd68;">"gta"</span> . <span style="color: #b5bd68;">"\\tau$0"</span>)
                      (<span style="color: #b5bd68;">"gup"</span> . <span style="color: #b5bd68;">"\\upsilon$0"</span>)
                      (<span style="color: #b5bd68;">"gph"</span> . <span style="color: #b5bd68;">"\\phi$0"</span>)
                      (<span style="color: #b5bd68;">"gch"</span> . <span style="color: #b5bd68;">"\\chi$0"</span>)
                      (<span style="color: #b5bd68;">"gpsi"</span> . <span style="color: #b5bd68;">"\\psi$0"</span>)
                      (<span style="color: #b5bd68;">"gme"</span> . <span style="color: #b5bd68;">"\\omega$0"</span>)

                      (<span style="color: #b5bd68;">"Alpha"</span> . <span style="color: #b5bd68;">"\\Alpha$0"</span>)
                      (<span style="color: #b5bd68;">"Beta"</span> . <span style="color: #b5bd68;">"\\Beta$0"</span>)
                      (<span style="color: #b5bd68;">"Gamma"</span> . <span style="color: #b5bd68;">"\\Gamma$0"</span>)
                      (<span style="color: #b5bd68;">"Delta"</span> . <span style="color: #b5bd68;">"\\Delta$0"</span>)
                      (<span style="color: #b5bd68;">"Epsilon"</span> . <span style="color: #b5bd68;">"\\Epsilon$0"</span>)
                      (<span style="color: #b5bd68;">"Zeta"</span> . <span style="color: #b5bd68;">"\\Zeta$0"</span>)
                      (<span style="color: #b5bd68;">"Eta"</span> . <span style="color: #b5bd68;">"\\Eta$0"</span>)
                      (<span style="color: #b5bd68;">"Theta"</span> . <span style="color: #b5bd68;">"\\Theta$0"</span>)
                      (<span style="color: #b5bd68;">"Iota"</span> . <span style="color: #b5bd68;">"\\Iota$0"</span>)
                      (<span style="color: #b5bd68;">"Kappa"</span> . <span style="color: #b5bd68;">"\\Kappa$0"</span>)
                      (<span style="color: #b5bd68;">"Lambda"</span> . <span style="color: #b5bd68;">"\\Lambda$0"</span>)
                      (<span style="color: #b5bd68;">"Mu"</span> . <span style="color: #b5bd68;">"\\Mu$0"</span>)
                      (<span style="color: #b5bd68;">"Nu"</span> . <span style="color: #b5bd68;">"\\Nu$0"</span>)
                      (<span style="color: #b5bd68;">"Xi"</span> . <span style="color: #b5bd68;">"\\Xi$0"</span>)
                      (<span style="color: #b5bd68;">"Omicron"</span> . <span style="color: #b5bd68;">"\\Omicron$0"</span>)
                      (<span style="color: #b5bd68;">"Pi"</span> . <span style="color: #b5bd68;">"\\Pi$0"</span>)
                      (<span style="color: #b5bd68;">"Rho"</span> . <span style="color: #b5bd68;">"\\Rho$0"</span>)
                      (<span style="color: #b5bd68;">"Sigma"</span> . <span style="color: #b5bd68;">"\\Sigma$0"</span>)
                      (<span style="color: #b5bd68;">"Tau"</span> . <span style="color: #b5bd68;">"\\Tau$0"</span>)
                      (<span style="color: #b5bd68;">"Upsilon"</span> . <span style="color: #b5bd68;">"\\Upsilon$0"</span>)
                      (<span style="color: #b5bd68;">"Phi"</span> . <span style="color: #b5bd68;">"\\Phi$0"</span>)
                      (<span style="color: #b5bd68;">"Chi"</span> . <span style="color: #b5bd68;">"\\Chi$0"</span>)
                      (<span style="color: #b5bd68;">"Psi"</span> . <span style="color: #b5bd68;">"\\Psi$0"</span>)
                      (<span style="color: #b5bd68;">"Omega"</span> . <span style="color: #b5bd68;">"\\Omega$0"</span>)

                      (<span style="color: #b5bd68;">"ln"</span> . <span style="color: #b5bd68;">"\\ln $0"</span>)

                      (<span style="color: #b5bd68;">"cos"</span> . <span style="color: #b5bd68;">"\\cos{$1$0"</span>)
                      (<span style="color: #b5bd68;">"sec"</span> . <span style="color: #b5bd68;">"\\sec{$1$0"</span>)
                      (<span style="color: #b5bd68;">"sin"</span> . <span style="color: #b5bd68;">"\\sin{$1$0"</span>)
                      (<span style="color: #b5bd68;">"csc"</span> . <span style="color: #b5bd68;">"\\csc{$1$0"</span>)
                      (<span style="color: #b5bd68;">"tan"</span> . <span style="color: #b5bd68;">"\\tan{$1$0"</span>)
                      (<span style="color: #b5bd68;">"cot"</span> . <span style="color: #b5bd68;">"\\cot{$1$0"</span>)
                      (<span style="color: #b5bd68;">"acos"</span> . <span style="color: #b5bd68;">"\\arccos{$1$0"</span>)
                      (<span style="color: #b5bd68;">"asin"</span> . <span style="color: #b5bd68;">"\\arcsin{$1$0"</span>)
                      (<span style="color: #b5bd68;">"atan"</span> . <span style="color: #b5bd68;">"\\arctan{$1$0"</span>)

                      (<span style="color: #b5bd68;">"ncos"</span> . <span style="color: #b5bd68;">"\\cos^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"nsec"</span> . <span style="color: #b5bd68;">"\\sec^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"nsin"</span> . <span style="color: #b5bd68;">"\\sin^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"ncsc"</span> . <span style="color: #b5bd68;">"\\csc^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"ntan"</span> . <span style="color: #b5bd68;">"\\tan^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"ncot"</span> . <span style="color: #b5bd68;">"\\cot^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"nacos"</span> . <span style="color: #b5bd68;">"\\arccos^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"nasin"</span> . <span style="color: #b5bd68;">"\\arcsin^{$1{$2}$0"</span>)
                      (<span style="color: #b5bd68;">"natan"</span> . <span style="color: #b5bd68;">"\\arctan^{$1{$2}$0"</span>)

                      (<span style="color: #b5bd68;">"2cos"</span> . <span style="color: #b5bd68;">"\\cos^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2sec"</span> . <span style="color: #b5bd68;">"\\sec^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2sin"</span> . <span style="color: #b5bd68;">"\\sin^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2csc"</span> . <span style="color: #b5bd68;">"\\csc^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2tan"</span> . <span style="color: #b5bd68;">"\\tan^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2cot"</span> . <span style="color: #b5bd68;">"\\cot^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2acos"</span> . <span style="color: #b5bd68;">"\\arccos^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2asin"</span> . <span style="color: #b5bd68;">"\\arcsin^2{$2$0"</span>)
                      (<span style="color: #b5bd68;">"2atan"</span> . <span style="color: #b5bd68;">"\\arctan^2{$2$0"</span>)

                      (<span style="color: #b5bd68;">"exp"</span> . <span style="color: #b5bd68;">"\\exp$0"</span>)
                      (<span style="color: #b5bd68;">"log"</span> . <span style="color: #b5bd68;">"\\log$0"</span>)
                      (<span style="color: #b5bd68;">"ein"</span> . <span style="color: #b5bd68;">" \\in $0"</span>)

                      (<span style="color: #b5bd68;">"ooo"</span> . <span style="color: #b5bd68;">"\\infty$0"</span>)

                      (<span style="color: #b5bd68;">"par"</span> . <span style="color: #b5bd68;">"\\left( $1 \\right)$0"</span>)
                      (<span style="color: #b5bd68;">"bra"</span> . <span style="color: #b5bd68;">"\\left[ $1 \\right]$0"</span>)

                      (<span style="color: #b5bd68;">"cro"</span> . <span style="color: #b5bd68;">" \\times $0"</span>)
                      (<span style="color: #b5bd68;">"dot"</span> . <span style="color: #b5bd68;">" \\cdot $0"</span>)

                      (<span style="color: #b5bd68;">"3po"</span> . <span style="color: #b5bd68;">"\\left( $1, $2, $3 \\right)$0"</span>)
                      (<span style="color: #b5bd68;">"3ve"</span> . <span style="color: #b5bd68;">"\\left\\langle $1, $2, $3 \\right\\rangle$0"</span>)

                      (<span style="color: #b5bd68;">"2po"</span> . <span style="color: #b5bd68;">"\\left( $1, $2 \\right)$0"</span>)
                      (<span style="color: #b5bd68;">"2ve"</span> . <span style="color: #b5bd68;">"\\left\\langle $1, $2 \\right\\rangle$0"</span>)

                      (<span style="color: #b5bd68;">"kq"</span> . <span style="color: #b5bd68;">"\\sqrt{$1$0"</span>)

                      (<span style="color: #b5bd68;">"equ"</span> . <span style="color: #b5bd68;">" = $0"</span>)
                      (<span style="color: #b5bd68;">"&gt;&gt;"</span> . <span style="color: #b5bd68;">" \\&gt; $0"</span>)
                      (<span style="color: #b5bd68;">"nqu"</span> . <span style="color: #b5bd68;">" \\neq $0"</span>)
                      (<span style="color: #b5bd68;">"vm"</span> . <span style="color: #b5bd68;">" - $0"</span>)
                      (<span style="color: #b5bd68;">"vj"</span> . <span style="color: #b5bd68;">"-$0"</span>)
                      (<span style="color: #b5bd68;">"vp"</span> . <span style="color: #b5bd68;">" + $0"</span>)
                      (<span style="color: #b5bd68;">"seq"</span> . <span style="color: #b5bd68;">" &amp;= $0"</span>)
                      (<span style="color: #b5bd68;">"sim"</span> . <span style="color: #b5bd68;">"&amp;\\sim $0"</span>)
                      (<span style="color: #b5bd68;">"amp"</span> . <span style="color: #b5bd68;">" &amp; $0"</span>)
                      (<span style="color: #b5bd68;">"gtn"</span> . <span style="color: #b5bd68;">" &gt; $0"</span>)
                      (<span style="color: #b5bd68;">"sgt"</span> . <span style="color: #b5bd68;">" &amp;&gt; $0"</span>)
                      (<span style="color: #b5bd68;">"lst"</span> . <span style="color: #b5bd68;">" &lt; $0"</span>)
                      (<span style="color: #b5bd68;">"slt"</span> . <span style="color: #b5bd68;">" &amp;&lt; $0"</span>)
                      (<span style="color: #b5bd68;">"leq"</span> . <span style="color: #b5bd68;">" \\leq $0"</span>)
                      (<span style="color: #b5bd68;">"lseq"</span> . <span style="color: #b5bd68;">" &amp;\\leq $0"</span>)
                      (<span style="color: #b5bd68;">"geq"</span> . <span style="color: #b5bd68;">" \\geq $0"</span>)
                      (<span style="color: #b5bd68;">"rk"</span> . <span style="color: #b5bd68;">"\\\\\\\\"</span>)
                      (<span style="color: #b5bd68;">"gseq"</span> . <span style="color: #b5bd68;">" &amp;\\geq $0"</span>)
                      (<span style="color: #b5bd68;">"trip"</span> . <span style="color: #b5bd68;">" \\equiv $0"</span>)
                      (<span style="color: #b5bd68;">"strip"</span> . <span style="color: #b5bd68;">" &amp;\\equiv $0"</span>))))

      (<span style="color: #CC6666; font-weight: bold;">dolist</span> (snippet snippets)
        (aas-set-snippets 'org-mode
          <span style="color: #81a2be;">:cond</span> #'texmathp
          (car snippet) `(<span style="color: #CC6666; font-weight: bold;">lambda</span> () (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                           (yas-expand-snippet ',(cdr snippet)))))))

</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">visit snippet</span>
(evil-leader/set-key <span style="color: #b5bd68;">"V"</span> #'yas-visit-snippet-file)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">new snippet</span>
(evil-leader/set-key <span style="color: #b5bd68;">"n"</span> #'yas-new-snippet)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga8506b3" class="outline-3">
<h3 id="orga8506b3">Spelling</h3>
<div class="outline-text-3" id="text-orga8506b3">
<p>
Set path to spellcheck program.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> ispell-program-name <span style="color: #b5bd68;">"/usr/local/bin/aspell"</span>)
</pre>
</div>

<p>
Automatically correct words when pressing space bar.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">autocorrect-words-on-type</span> t
  <span style="color: #717171; font-style: italic;">"Whether to automatically correct a word after pressing space."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">correct-word-before-space</span> ()
  (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span>
       autocorrect-words-on-type
       (memq major-mode '(org-mode mail-mode text-mode))
       (null (get-char-property (point) 'face))
       (not (texmathp))
       (not (yas-active-snippets))
       (not (equal (TeX-current-macro) <span style="color: #b5bd68;">"text"</span>))
       (not (org-in-src-block-p)))
      (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span>
             (equal (char-before) ? )
             (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
               (goto-char (- (point) 1))
               (thing-at-point 'word)))
        (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
          (flyspell-auto-correct-word)))))


(add-hook 'post-self-insert-hook #'correct-word-before-space)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">avoid triggering autocorrect</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"S-SPC"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                           (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                           (insert ? )))


(define-key org-mode-map (kbd <span style="color: #b5bd68;">"&lt;f3&gt;"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                          (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                          (<span style="color: #CC6666; font-weight: bold;">if</span> autocorrect-words-on-type
                                              (<span style="color: #CC6666; font-weight: bold;">progn</span>
                                                (<span style="color: #CC6666; font-weight: bold;">setq</span> autocorrect-words-on-type nil)
                                                (message <span style="color: #b5bd68;">"Disabled autocorrect."</span>))
                                            (<span style="color: #CC6666; font-weight: bold;">setq</span> autocorrect-words-on-type t)
                                            (message <span style="color: #b5bd68;">"Enabled autocorrect."</span>))))
</pre>
</div>

<p>
Create a ring of dictionary languages.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">let</span> ((langs '(<span style="color: #b5bd68;">"american"</span> <span style="color: #b5bd68;">"brasileiro"</span>)))
  (<span style="color: #CC6666; font-weight: bold;">setq</span> lang-ring (make-ring (length langs)))
  (<span style="color: #CC6666; font-weight: bold;">dolist</span> (elem langs) (ring-insert lang-ring elem)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">cycle-ispell-languages</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((lang (ring-ref lang-ring -1)))
    (ring-insert lang-ring lang)
    (ispell-change-dictionary lang)))
</pre>
</div>

<p>
Only spellcheck comments.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> flyspell-prog-text-faces '(font-lock-comment-face font-lock-doc-face))
</pre>
</div>

<p>
Set evil-leader key bindings for spelling-related functions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">start flyspell</span>
(evil-leader/set-key <span style="color: #b5bd68;">"S"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (derived-mode-p 'prog-mode) (not (equal (buffer-name) <span style="color: #b5bd68;">"*scratch*"</span>)))
                                 (flyspell-prog-mode)
                               (<span style="color: #CC6666; font-weight: bold;">progn</span>
                                 (flyspell-mode)
                                 (<span style="color: #CC6666; font-weight: bold;">if</span> (equal (buffer-name) <span style="color: #b5bd68;">"*scratch*"</span>)
                                     (flycheck-mode -1))))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">cycle through ispell languages</span>
(evil-leader/set-key <span style="color: #b5bd68;">"C"</span> #'cycle-ispell-languages)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">save spelling</span>
(evil-leader/set-key <span style="color: #b5bd68;">"["</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">let</span> ((current-location (point))
                                   (word (flyspell-get-word)))
                               (<span style="color: #CC6666; font-weight: bold;">when</span> (consp word)
                                 (flyspell-do-correct 'save nil (car word) current-location (cadr word) (caddr word) current-location))
                               (<span style="color: #CC6666; font-weight: bold;">setq</span> ispell-pdict-modified-p nil))))
</pre>
</div>

<p>
Customize fLyspell faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'flyspell-duplicate nil
                    <span style="color: #81a2be;">:underline</span> color-blue)


(set-face-attribute 'flyspell-incorrect nil
                    <span style="color: #81a2be;">:underline</span> color-red)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">flyspell</span>
  <span style="color: #81a2be;">:config</span>
  &lt;&lt;flyspell-faces&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1e647ad" class="outline-3">
<h3 id="org1e647ad">Smartparens</h3>
<div class="outline-text-3" id="text-org1e647ad">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">smartparens</span>
  <span style="color: #81a2be;">:config</span>

  (smartparens-global-mode)

  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">disable pairing for single quotes in emacs lisp</span>
  (sp-local-pair 'emacs-lisp-mode <span style="color: #b5bd68;">"'"</span> nil <span style="color: #81a2be;">:actions</span> nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-org340fe96" class="outline-3">
<h3 id="org340fe96">Templating</h3>
<div class="outline-text-3" id="text-org340fe96">
<p>
Placeholder for generic templates.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">template-placeholder-text</span> <span style="color: #b5bd68;">"&lt;++&gt;"</span>
  <span style="color: #717171; font-style: italic;">"Placeholder text to be replaced by `</span><span style="color: #CC6666; font-style: italic;">edit-next-placeholder</span><span style="color: #717171; font-style: italic;">'."</span>)
</pre>
</div>

<p>
Find and edit next placeholder. Adapted from somewhere a long time
ago.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">edit-next-placeholder</span> ()
  <span style="color: #717171; font-style: italic;">"Jump to next `</span><span style="color: #CC6666; font-style: italic;">template-placeholder-text</span><span style="color: #717171; font-style: italic;">' and edit."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (search-forward template-placeholder-text nil t)
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (delete-backward-char (length template-placeholder-text))
        (evil-insert-state))))
</pre>
</div>

<p>
Bind keys.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #b5bd68;">"C-."</span>) #'edit-next-placeholder)
</pre>
</div>

<p>
Bind with <code>evil-leader</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span style="color: #b5bd68;">"r"</span> #'edit-next-placeholder)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga0ff749" class="outline-3">
<h3 id="orga0ff749">Macros</h3>
<div class="outline-text-3" id="text-orga0ff749">
<p>
Use this macro to turn <code>org-mode</code> lists into table rows (for English
class).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(fset 'org-list-to-row
      (kmacro-lambda-form [?v ?i ?p ?\; ?s ?/ ?\\ ?n ?  ?  ?/ ?  ?\C-j ?g ?v ?\; ?s ?/ ?- ?  ?\\ ?\( ?. ?* ?\\ ?\) ?/ ?| ?  ?\\ ?1 ?  return ?g ?v ?\C-j ?A ?| ?j ?k] 0 <span style="color: #b5bd68;">"%d"</span>))

(<span style="color: #CC6666; font-weight: bold;">with-eval-after-load</span> 'org
  (define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-c C-r"</span>) 'org-list-to-row))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1dcfcc7" class="outline-3">
<h3 id="org1dcfcc7">Undo tree</h3>
<div class="outline-text-3" id="text-org1dcfcc7">
<p>
Use undo tree.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">undo-tree</span>
  <span style="color: #81a2be;">:config</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop creating automatic backups</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> undo-tree-auto-save-history nil)


  (global-undo-tree-mode))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd03df28" class="outline-2">
<h2 id="orgd03df28">Shell</h2>
<div class="outline-text-2" id="text-orgd03df28">
<p>
<code>vterm</code> config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">vterm-send-escape</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (vterm-send-key <span style="color: #b5bd68;">"&lt;escape&gt;"</span>))


(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">vterm</span>
  <span style="color: #81a2be;">:ensure</span> t
  <span style="color: #81a2be;">:config</span>
  (define-key vterm-mode-map (kbd <span style="color: #b5bd68;">"M-h"</span>) 'evil-window-left)
  (define-key vterm-mode-map (kbd <span style="color: #b5bd68;">"M-j"</span>) 'evil-window-down)
  (define-key vterm-mode-map (kbd <span style="color: #b5bd68;">"M-k"</span>) 'evil-window-up)
  (define-key vterm-mode-map (kbd <span style="color: #b5bd68;">"M-l"</span>) 'evil-window-right)
  (<span style="color: #CC6666; font-weight: bold;">setq-local</span> evil-insert-state-cursor '(<span style="color: #b5bd68;">"#aaa"</span> box))


  (define-key vterm-mode-map (kbd <span style="color: #b5bd68;">"C-&lt;return&gt;"</span>) #'evil-normal-state)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-return to escape external insert state</span>
  (<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'insert vterm-mode-map (kbd <span style="color: #b5bd68;">"&lt;escape&gt;"</span>) #'vterm-send-escape))
</pre>
</div>

<p>
Use <code>M-§</code> to start running shell command.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #b5bd68;">"M-&#167;"</span>) 'shell-command)
</pre>
</div>

<p>
Insert file name with <code>C-o</code> in shell command prompt.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key minibuffer-local-map (kbd <span style="color: #b5bd68;">"C-o"</span>)
  (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
    (<span style="color: #CC6666; font-weight: bold;">interactive</span>) 
    (insert (buffer-name (window-buffer (minibuffer-selected-window))))))
</pre>
</div>

<p>
Use <code>C-n</code> and <code>C-p</code> to navigate shell command history (will work for lisp
eval too).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key minibuffer-local-map (kbd <span style="color: #b5bd68;">"C-p"</span>) 'previous-line-or-history-element)
(define-key minibuffer-local-map (kbd <span style="color: #b5bd68;">"C-n"</span>) 'next-line-or-history-element)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdddca7f" class="outline-2">
<h2 id="orgdddca7f">Remote</h2>
<div class="outline-text-2" id="text-orgdddca7f">
</div>
<div id="outline-container-org15f1622" class="outline-3">
<h3 id="org15f1622">Tramp</h3>
<div class="outline-text-3" id="text-org15f1622">
<p>
Make tramp play nice with Marylou.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> tramp-password-prompt-regexp <span style="color: #b5bd68;">"^.*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">Password</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">Verification</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">.*:&#0;? *"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org68220c3" class="outline-3">
<h3 id="org68220c3">Git</h3>
<div class="outline-text-3" id="text-org68220c3">
<p>
Use syntax highlighting in gitignore.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">gitignore-mode</span>
  <span style="color: #81a2be;">:load-path</span> <span style="color: #b5bd68;">"lisp/"</span>)
</pre>
</div>

<p>
Use magit. Obviously. 
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">magit</span>)
</pre>
</div>

<p>
Make sure magit opens in the same window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> magit-display-buffer-function
              (<span style="color: #CC6666; font-weight: bold;">lambda</span> (buffer)
                (display-buffer
                 buffer (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (derived-mode-p 'magit-mode)
                                 (memq (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> buffer major-mode)
                                       '(magit-process-mode
                                         magit-revision-mode
                                         magit-diff-mode
                                         magit-stash-mode
                                         magit-status-mode)))
                            nil
                          '(display-buffer-same-window)))))
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key (kbd <span style="color: #b5bd68;">"m"</span>) 'magit)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc5e4db7" class="outline-2">
<h2 id="orgc5e4db7">Programming</h2>
<div class="outline-text-2" id="text-orgc5e4db7">
</div>
<div id="outline-container-org251b726" class="outline-3">
<h3 id="org251b726">Flycheck</h3>
<div class="outline-text-3" id="text-org251b726">
<p>
Customize faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'flycheck-error nil
                    <span style="color: #81a2be;">:underline</span> color-red)


(set-face-attribute 'flycheck-info nil
                    <span style="color: #81a2be;">:underline</span> color-light-green)


(set-face-attribute 'flycheck-warning nil
                    <span style="color: #81a2be;">:underline</span> color-light-orange)
</pre>
</div>

<p>
Start up.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> flycheck-disabled-checkers '(emacs-lisp-checkdoc))

(global-flycheck-mode)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">flycheck</span>
  <span style="color: #81a2be;">:config</span>
  &lt;&lt;flycheck-faces&gt;&gt;
  &lt;&lt;flycheck-config&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org92b0ac5" class="outline-3">
<h3 id="org92b0ac5">Flymake</h3>
<div class="outline-text-3" id="text-org92b0ac5">
<p>
Customize faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'flymake-error nil
                    <span style="color: #81a2be;">:underline</span> color-red)


(set-face-attribute 'flymake-note nil
                    <span style="color: #81a2be;">:underline</span> color-light-green)


(set-face-attribute 'flymake-warning nil
                    <span style="color: #81a2be;">:underline</span> color-light-orange)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">flymake</span>
  <span style="color: #81a2be;">:config</span>
  &lt;&lt;flymake-faces&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1956636" class="outline-3">
<h3 id="org1956636">Company</h3>
<div class="outline-text-3" id="text-org1956636">
<p>
Company config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">company</span>
  <span style="color: #81a2be;">:init</span> (add-hook 'after-init-hook 'global-company-mode)
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> company-tooltip-align-annotations t)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use icons in company mode</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> company-format-margin-function 'company-vscode-dark-icons-margin)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-j to complete</span>
  (define-key company-active-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'company-complete-selection)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">change company faces</span>
  (set-face-attribute 'company-tooltip nil
                      <span style="color: #81a2be;">:inherit</span> 'default
                      <span style="color: #81a2be;">:background</span> color-background)


  (set-face-attribute 'company-scrollbar-fg nil
                      <span style="color: #81a2be;">:background</span> color-dark-subdued)


  (set-face-attribute 'company-scrollbar-bg nil
                      <span style="color: #81a2be;">:background</span> color-background)


  (set-face-attribute 'company-tooltip-mouse nil
                      <span style="color: #81a2be;">:background</span> color-dark-subdued)


  (set-face-attribute 'company-tooltip-selection nil
                      <span style="color: #81a2be;">:background</span> color-dark-subdued)


  (set-face-attribute 'company-tooltip-annotation nil
                      <span style="color: #81a2be;">:foreground</span> color-blue)


  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> company-idle-delay              0.1
                company-minimum-prefix-length   2
                company-show-numbers            t
                company-tooltip-limit           20
                company-dabbrev-downcase        nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9c68a76" class="outline-3">
<h3 id="org9c68a76">Languages</h3>
</div>

<div id="outline-container-orgba6b944" class="outline-3">
<h3 id="orgba6b944">Python</h3>
<div class="outline-text-3" id="text-orgba6b944">
<p>
Elpy config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">elpy</span>
  <span style="color: #81a2be;">:config</span>
  (elpy-enable)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop weird indentation guides from elpy</span>
  (add-hook 'elpy-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> () (highlight-indentation-mode -1)))


  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> elpy-rpc-backend <span style="color: #b5bd68;">"jedi"</span>)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use global environment</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> elpy-rpc-virtualenv-path 'current))
</pre>
</div>

<p>
Jedi config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">company-jedi</span>
  <span style="color: #81a2be;">:config</span>

  (add-hook 'python-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                  (add-to-list 'company-backends 'company-jedi))))
</pre>
</div>

<p>
Set variables.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">setting python executable</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> flycheck-python-flake8-executable <span style="color: #b5bd68;">"python"</span>)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> flycheck-python-pycompile-executable <span style="color: #b5bd68;">"python"</span>)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> flycheck-python-pylint-executable <span style="color: #b5bd68;">"python"</span>)

<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set python path</span>
(setenv <span style="color: #b5bd68;">"PYTHONPATH"</span> (shell-command-to-string <span style="color: #b5bd68;">"$SHELL --login -c 'echo -n $PYTHONPATH'"</span>))
</pre>
</div>

<p>
Add a font lock face for method calls.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defface</span> <span style="color: #E0DBA9;">method-call-lock</span>
  '((t <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#b5bd68"</span>))
  <span style="color: #717171; font-style: italic;">"Face for method calls."</span>
  <span style="color: #81a2be;">:group</span> 'python-mode)
</pre>
</div>

<p>
Add a font lock face for operators.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defface</span> <span style="color: #E0DBA9;">operator-lock</span>
  '((t <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#cc6666"</span>))
  <span style="color: #717171; font-style: italic;">"Face for operators."</span>
  <span style="color: #81a2be;">:group</span> 'python-mode)
</pre>
</div>

<p>
Define Python method calls and operators as font lock keywords.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(font-lock-add-keywords 'python-mode
                        `((,(concat
                             <span style="color: #b5bd68;">"\\."</span>
                             <span style="color: #b5bd68;">"\\&lt;</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[_a-zA-Z][_a-zA-Z0-9]*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">\\&gt;"</span>
                             <span style="color: #b5bd68;">"("</span>) <span style="color: #f0c674;">1 'method-call-lock keep t)</span>
                          (<span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[=+-/*&gt;&lt;]</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span> . 'operator-lock)))
</pre>
</div>

<p>
Remove <code>matplotlib</code> line from graph in HTML export.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">remove-ipython-matplotlib-line</span> (text backend info)
  (replace-regexp-in-string <span style="color: #b5bd68;">"&lt;pre class=\"example\"[[:ascii:][:nonascii:]]*?\\[&amp;lt;matplotlib.lines.Line2D at 0x[0-9a-f]*&amp;gt;\\][[:ascii:][:nonascii:]]*?&lt;/pre&gt;"</span> <span style="color: #b5bd68;">""</span> text))


(add-to-list 'org-export-filter-drawer-functions
             'remove-ipython-matplotlib-line)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">load python in org-mode</span>
(org-babel-do-load-languages
 'org-babel-load-languages
 '((python . t)))
</pre>
</div>

<p>
Add docstrings to embrace pairs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'python-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                              (embrace-add-pair ?d <span style="color: #b5bd68;">"\"\"\""</span> <span style="color: #b5bd68;">"\"\"\""</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd405a5f" class="outline-3">
<h3 id="orgd405a5f">Rust</h3>
<div class="outline-text-3" id="text-orgd405a5f">
<p>
Rust config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> lsp-rust-server 'rust-analyzer)

(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">rust-mode</span>
  <span style="color: #81a2be;">:config</span>
  (add-hook 'rust-mode-hook #'racer-mode)


  (define-key rust-mode-map (kbd <span style="color: #b5bd68;">"TAB"</span>) #'company-indent-or-complete-common)


  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> racer-rust-src-path
                (concat (string-trim
                         (shell-command-to-string <span style="color: #b5bd68;">"rustc --print sysroot"</span>))
                        <span style="color: #b5bd68;">"/lib/rustlib/src/rust/library"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd32ef48" class="outline-3">
<h3 id="orgd32ef48">Elisp</h3>
<div class="outline-text-3" id="text-orgd32ef48">
<p>
Convenient way to open lisp eval.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #b5bd68;">"C-;"</span>) 'eval-expression)
</pre>
</div>

<p>
Stop using <code>C-j</code> to evaluate line.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key lisp-interaction-mode-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'newline)
</pre>
</div>
</div>
</div>

<div id="outline-container-org189c1a6" class="outline-3">
<h3 id="org189c1a6">SGML/HTML</h3>
<div class="outline-text-3" id="text-org189c1a6">
<p>
Set indentation to 4 spaces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> sgml-basic-offset 4)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> sgml-specials nil)
</pre>
</div>

<p>
Emmet config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">emmet-mode</span>
  <span style="color: #81a2be;">:config</span>
  (add-hook 'html-mode-hook 'emmet-mode)

  (define-key emmet-mode-keymap (kbd <span style="color: #b5bd68;">"C-j"</span>) #'newline)
  (define-key emmet-mode-keymap (kbd <span style="color: #b5bd68;">"C-,"</span>) #'emmet-expand-line))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge9ac5e6" class="outline-3">
<h3 id="orge9ac5e6">Auctex/latex</h3>
<div class="outline-text-3" id="text-orge9ac5e6">
<p>
LaTeX config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">latex</span>
  <span style="color: #81a2be;">:ensure</span> auctex
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> TeX-auto-save t)
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> TeX-parse-self t)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">refresh PDF constantly</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> auto-revert-interval 0.5)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop showing revert messages</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> auto-revert-verbose nil)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">disable inline sub-/superscript --- gets annoying</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> font-latex-fontify-script nil)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">add math pairing</span>
  (sp-local-pair '(latex-mode org-mode) <span style="color: #b5bd68;">"$"</span> <span style="color: #b5bd68;">"$"</span>)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">add pairings for \left \right delimiters</span>
  (sp-local-pair '(latex-mode org-mode) <span style="color: #b5bd68;">"\\left("</span> <span style="color: #b5bd68;">"\\right)"</span>)
  (sp-local-pair '(latex-mode org-mode) <span style="color: #b5bd68;">"\\left["</span> <span style="color: #b5bd68;">"\\right]"</span>)
  (sp-local-pair '(latex-mode org-mode) <span style="color: #b5bd68;">"\\left\\langle"</span> <span style="color: #b5bd68;">"\\right\\rangle"</span>)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Use pdf-tools to open PDF files</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> TeX-view-program-selection '((output-pdf <span style="color: #b5bd68;">"PDF Tools"</span>))
                TeX-source-correlate-start-server t)


  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Update PDF buffers after successful LaTeX runs</span>
  (add-hook 'TeX-after-compilation-finished-functions
            #'TeX-revert-document-buffer))
</pre>
</div>

<p>
Add <code>evil-embrace</code> pairs to LaTeX mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">embrace-with-latex-environment</span> ()
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((cname (<span style="color: #CC6666; font-weight: bold;">or</span> (read-string <span style="color: #b5bd68;">"Environment: "</span>) <span style="color: #b5bd68;">""</span>)))
    (cons (format <span style="color: #b5bd68;">"\\begin{%s}\n"</span> cname) (format <span style="color: #b5bd68;">"\n\\end{%s}"</span> cname))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">embrace-with-latex-command</span> ()
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((cname (read-string <span style="color: #b5bd68;">"Command: "</span>)))
    (cons (format <span style="color: #b5bd68;">"\\%s{"</span> (<span style="color: #CC6666; font-weight: bold;">or</span> cname <span style="color: #b5bd68;">""</span>)) <span style="color: #b5bd68;">"}"</span>)))


(add-hook 'LaTeX-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (embrace-add-pair ?i <span style="color: #b5bd68;">"\\emph{"</span> <span style="color: #b5bd68;">"}"</span>)
                             (embrace-add-pair ?m <span style="color: #b5bd68;">"$"</span> <span style="color: #b5bd68;">"$"</span>)
                             (embrace-add-pair ?\[ <span style="color: #b5bd68;">"\\left["</span> <span style="color: #b5bd68;">"\\right]"</span>)
                             (embrace-add-pair ?\( <span style="color: #b5bd68;">"\\left("</span> <span style="color: #b5bd68;">"\\right)"</span>)
                             (embrace-add-pair ?\] <span style="color: #b5bd68;">"\\left[ "</span> <span style="color: #b5bd68;">" \\right]"</span>)
                             (embrace-add-pair ?\) <span style="color: #b5bd68;">"\\left( "</span> <span style="color: #b5bd68;">" \\right)"</span>)
                             (embrace-add-pair-regexp ?c <span style="color: #b5bd68;">"\\[</span><span style="color: #CC6666; font-weight: bold;">^</span><span style="color: #CC6666;">{</span><span style="color: #b5bd68;">]*?{"</span> <span style="color: #b5bd68;">"}"</span>
                                                      #'embrace-with-latex-command
                                                      (embrace-build-help <span style="color: #b5bd68;">"\\command{"</span> <span style="color: #b5bd68;">"}"</span>))
                             (embrace-add-pair-regexp ?e <span style="color: #b5bd68;">"\\begin{[</span><span style="color: #c5c8c6; font-weight: bold;">^</span><span style="color: #b5bd68;">{]*?}"</span> <span style="color: #b5bd68;">"\\end{[</span><span style="color: #c5c8c6; font-weight: bold;">^</span><span style="color: #b5bd68;">{]*?}"</span>
                                                      #'embrace-with-latex-environment
                                                      (embrace-build-help <span style="color: #b5bd68;">"\\begin{environment}"</span> <span style="color: #b5bd68;">"\\end{environment}"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org956a5ba" class="outline-3">
<h3 id="org956a5ba">Scripts</h3>
<div class="outline-text-3" id="text-org956a5ba">
<p>
Run Python script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">run-current-python</span> (arguments)
  <span style="color: #717171; font-style: italic;">"Run current Python file."</span>
  (shell-command-to-string
   (format
    <span style="color: #b5bd68;">"export PYTHONPATH='</span><span style="color: #CC6666;">${PYTHONPATH}:/Users/jetblack/maxwell/src/:/Users/jetblack/pyimports/</span><span style="color: #b5bd68;">' &amp;&amp; python '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">' %s"</span>
    (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run Node.js script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">run-current-javascript</span> (arguments)
  <span style="color: #717171; font-style: italic;">"Run current JavaScript file."</span>
  (shell-command-to-string
   (format
    <span style="color: #b5bd68;">"node '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">' %s"</span>
    (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run Julia script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">run-current-julia</span> (arguments)
  <span style="color: #717171; font-style: italic;">"Run current Python file."</span>
  (shell-command-to-string
   (format
    <span style="color: #b5bd68;">"export PYTHONPATH='</span><span style="color: #CC6666;">${PYTHONPATH}:/Users/jetblack/maxwell/src/</span><span style="color: #b5bd68;">' &amp;&amp; /Applications/Julia-1.6.app/Contents/Resources/julia/bin/julia '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">' %s"</span>
    (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run shell script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">run-current-shell</span> (arguments)
  <span style="color: #717171; font-style: italic;">"Run current shell script."</span>
  (shell-command-to-string (format <span style="color: #b5bd68;">"zsh '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">' %s"</span> (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run script based on current major mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">run-script-without-args</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">cond</span> ((equal major-mode 'dired-mode) (dired-find-file) (run-script-without-args))
        ((equal major-mode 'python-mode) (princ (run-current-python <span style="color: #b5bd68;">""</span>)))
        ((equal major-mode 'js-mode) (princ (run-current-javascript <span style="color: #b5bd68;">""</span>)))
        ((equal major-mode 'julia-mode) (princ (run-current-julia <span style="color: #b5bd68;">""</span>)))
        ((equal major-mode 'sh-mode) (princ (run-current-shell <span style="color: #b5bd68;">""</span>)))
        ((equal major-mode 'org-mode) (org-babel-execute-src-block))
        (t (message <span style="color: #b5bd68;">"File type not supported."</span>))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">run-script-with-args</span> (arguments)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"MArguments: "</span>)
  (<span style="color: #CC6666; font-weight: bold;">cond</span> ((equal major-mode 'dired-mode) (dired-find-file) (run-script-with-args arguments))
        ((equal major-mode 'python-mode) (princ (run-current-python arguments)))
        ((equal major-mode 'js-mode) (princ (run-current-javascript arguments)))
        ((equal major-mode 'julia-mode) (princ (run-current-julia arguments)))
        ((equal major-mode 'sh-mode) (princ (run-current-shell arguments)))
        ((equal major-mode 'org-mode) (org-babel-execute-src-block))
        (t (message <span style="color: #b5bd68;">"File type not supported."</span>))))
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">run scripts</span>
(evil-leader/set-key <span style="color: #b5bd68;">","</span> #'run-script-without-args)
(evil-leader/set-key <span style="color: #b5bd68;">"'"</span> #'run-script-without-args)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">run scripts with arguments</span>
(evil-leader/set-key <span style="color: #b5bd68;">"."</span> #'run-script-with-args)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4e657ea" class="outline-2">
<h2 id="org4e657ea">Mail</h2>
<div class="outline-text-2" id="text-org4e657ea">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">notmuch</span>
  <span style="color: #81a2be;">:config</span>
  &lt;&lt;notmuch-keybindings&gt;&gt;)
</pre>
</div>

<p>
Configure notmuch startup screen.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">hide ugly notmuch logo</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> notmuch-show-logo nil)
</pre>
</div>

<p>
Configure to work with msmtp.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> send-mail-function 'sendmail-query-once
              sendmail-program <span style="color: #b5bd68;">"/usr/sbin/sendmail"</span>
              mail-specify-envelope-from t
              message-sendmail-envelope-from 'header
              mail-envelope-from 'header)
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">bind C-j properly</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal notmuch-search-mode-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'notmuch-search-show-thread)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">search by tag in notmuch</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal notmuch-hello-mode-map (kbd <span style="color: #b5bd68;">"?"</span>) #'notmuch-search-by-tag)
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open send mail buffer</span>
(evil-leader/set-key <span style="color: #b5bd68;">"M"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (switch-to-buffer <span style="color: #b5bd68;">"*mail*"</span> nil t)
                             (mail-mode)
                             (company-mode -1)
                             (auto-fill-mode -1)
                             (distraction-free t)
                             (evil-insert-state)
                             (yas-minor-mode)
                             (yas-expand-snippet
                              <span style="color: #b5bd68;">"From: William Aguiar Roque <a href="mailto:william.aroque%40gmail.com">&lt;william.aroque@gmail.com&gt;</a></span>
<span style="color: #b5bd68;">To: $1</span>
<span style="color: #b5bd68;">Subject: $2</span>
<span style="color: #b5bd68;">--text follows this line--</span>
<span style="color: #b5bd68;">$0"</span>)))

<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open read mail buffer</span>
(evil-leader/set-key <span style="color: #b5bd68;">"1"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (refresh-email)
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
                             (<span style="color: #CC6666; font-weight: bold;">when</span> refresh-email
                               (message <span style="color: #b5bd68;">"Refreshing email..."</span>)
                               (shell-command-to-string <span style="color: #b5bd68;">"mbsync gmail; notmuch new"</span>))
                             (notmuch)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf19d7e9" class="outline-2">
<h2 id="orgf19d7e9">Files</h2>
<div class="outline-text-2" id="text-orgf19d7e9">
</div>
<div id="outline-container-org1a6ac07" class="outline-3">
<h3 id="org1a6ac07">Dired</h3>
<div class="outline-text-3" id="text-org1a6ac07">
<p>
Get a list of marked files from all Dired buffers. <a href="https://emacs.stackexchange.com/a/64591/33585">Thanks Drew!</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">get-all-marked-files-and-unmark</span> ()
  <span style="color: #717171; font-style: italic;">"Return a list of marked files from all Dired buffers."</span>
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((files  ())
        (here   ()))
    (<span style="color: #CC6666; font-weight: bold;">dolist</span> (buf  (mapcar #'cdr dired-buffers))
      (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> buf
        (<span style="color: #CC6666; font-weight: bold;">setq</span> here  (dired-get-marked-files nil nil nil t))
        (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">or</span> (null (cdr here))  (eq t (car here)))
          (<span style="color: #CC6666; font-weight: bold;">setq</span> here  (cdr here)))
        (<span style="color: #CC6666; font-weight: bold;">setq</span> files  (nconc here files))
        (<span style="color: #CC6666; font-weight: bold;">let</span> ((inhibit-message t))
          (dired-unmark-all-marks))))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> files  (delete-dups files))))
</pre>
</div>

<p>
Make dired update automatically.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-mode-hook #'auto-revert-mode)
</pre>
</div>

<p>
Close dired buffers by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> dired-kill-when-opening-new-dired-buffer t)
</pre>
</div>

<p>
Make dired stop showing as modified by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-after-readin-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> () (set-buffer-modified-p nil)))
</pre>
</div>
</div>

<div id="outline-container-orgecf1c71" class="outline-4">
<h4 id="orgecf1c71">User interface</h4>
<div class="outline-text-4" id="text-orgecf1c71">
<p>
Remove weird face in dired. I couldn&rsquo;t avoid <code>custom-set-faces</code> for this one.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(custom-set-faces
 '(bookmark-face ((t nil))))
</pre>
</div>

<p>
Show less information when opening dired (can be toggled with `(`).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-mode-hook 'dired-hide-details-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb2f6a7a" class="outline-4">
<h4 id="orgb2f6a7a">Backend</h4>
<div class="outline-text-4" id="text-orgb2f6a7a">
<p>
Use <code>gnu-ls</code> and numerical sorting.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> dired-use-ls-dired t)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> insert-directory-program <span style="color: #b5bd68;">"/usr/local/bin/gls"</span>)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> dired-listing-switches <span style="color: #b5bd68;">"-lGh1v --group-directories-first"</span>)


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">dired-show-hidden-files</span> nil
  <span style="color: #717171; font-style: italic;">"Whether to show hidden files in dired."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">toggle-dired-show-hidden-files</span> ()
  <span style="color: #717171; font-style: italic;">"Toggle showing hidden dired files."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> dired-show-hidden-files
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (<span style="color: #CC6666; font-weight: bold;">setq</span> dired-listing-switches <span style="color: #b5bd68;">"-lGh1v --group-directories-first"</span>)
        (<span style="color: #CC6666; font-weight: bold;">setq</span> dired-show-hidden-files nil)
        (message <span style="color: #b5bd68;">"Hiding hidden files."</span>))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> dired-listing-switches <span style="color: #b5bd68;">"-lAGh1v --group-directories-first"</span>)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> dired-show-hidden-files t)
    (message <span style="color: #b5bd68;">"Showing hidden files."</span>))
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((current-directory dired-directory))
    (kill-buffer)
    (dired current-directory)))
</pre>
</div>

<p>
Fix to open file in default application (macOS).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">dired-open-in-default</span> ()
  <span style="color: #717171; font-style: italic;">"Opens current file in default application.  `browse-url-of-dired-file` wasn't working."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((marked-files (dired-get-marked-files)))
    (<span style="color: #CC6666; font-weight: bold;">if</span> (null marked-files)
        (shell-command (format <span style="color: #b5bd68;">"open '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">'"</span> (dired-current-directory)))
      (dired-do-shell-command <span style="color: #b5bd68;">"open"</span> 1 marked-files))))

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal dired-mode-map <span style="color: #b5bd68;">"W"</span> #'dired-open-in-default)
</pre>
</div>
</div>
</div>

<div id="outline-container-org4384ad4" class="outline-4">
<h4 id="org4384ad4">Key bindings</h4>
<div class="outline-text-4" id="text-org4384ad4">
<p>
Make sure S-j, S-k, and C-j are bound correctly for dired.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal dired-mode-map <span style="color: #b5bd68;">"K"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                (scroll-down 3)))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal dired-mode-map <span style="color: #b5bd68;">"J"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                (scroll-up 3)))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal dired-mode-map (kbd <span style="color: #b5bd68;">"C-j"</span>) 'dired-find-file)
</pre>
</div>

<p>
Make sure <code>q</code> works in dired-mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal 'dired-mode-map <span style="color: #b5bd68;">"q"</span> 'evil-owl-record-macro)
</pre>
</div>

<p>
Toggle showing hidden files.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key dired-mode-map (kbd <span style="color: #b5bd68;">"&lt;f5&gt;"</span>) #'toggle-dired-show-hidden-files)
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open dired at cwd or go up directory</span>
(evil-leader/set-key <span style="color: #b5bd68;">"I"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> (equal major-mode 'dired-mode)
                                 (dired-up-directory)
                               (dired <span style="color: #b5bd68;">"."</span>))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">close current buffer and open dired at cwd or go up directory</span>
(evil-leader/set-key <span style="color: #b5bd68;">"i"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> (not (equal dired-directory <span style="color: #b5bd68;">"/"</span>))
                                 (<span style="color: #CC6666; font-weight: bold;">let</span> ((old-buffer (current-buffer)))
                                   (<span style="color: #CC6666; font-weight: bold;">if</span> (equal major-mode 'dired-mode)
                                       (<span style="color: #CC6666; font-weight: bold;">progn</span>
                                         (dired-up-directory)
                                         (kill-buffer old-buffer))
                                     (dired <span style="color: #b5bd68;">"."</span>))))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open marked files in dired</span>
(evil-leader/set-key <span style="color: #b5bd68;">"w"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (open-all-marked)
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> (null open-all-marked)
                                 (shell-command (format <span style="color: #b5bd68;">"open '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">'"</span> buffer-file-name))
                               (<span style="color: #CC6666; font-weight: bold;">let</span> ((files (get-all-marked-files-and-unmark)))
                                 (mapc #'browse-url files)
                                 (message <span style="color: #b5bd68;">"Unmarked %d files."</span> (length files))))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open desktop</span>
(evil-leader/set-key <span style="color: #b5bd68;">"?"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (find-file (expand-file-name <span style="color: #b5bd68;">"~/Desktop/"</span>))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open home</span>
(evil-leader/set-key <span style="color: #b5bd68;">"/"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (find-file (expand-file-name <span style="color: #b5bd68;">"~/"</span>))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgffec9e0" class="outline-3">
<h3 id="orgffec9e0">PDFs/images</h3>
<div class="outline-text-3" id="text-orgffec9e0">
<p>
Revert buffer without confirmation.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> revert-without-query '(<span style="color: #b5bd68;">".pdf"</span>))
(add-hook 'pdf-view-mode-hook #'auto-revert-mode)
</pre>
</div>

<p>
Use <code>pdf-tools</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">pdf-hiding-cursor</span> nil
  <span style="color: #717171; font-style: italic;">"Last buffer was a PDF and was hiding cursor."</span>)


(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">pdf-tools</span>
  <span style="color: #81a2be;">:config</span>
  (add-hook 'pdf-view-mode-hook
            #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                (add-to-list 'pdf-annot-default-annotation-properties '(text (icon . <span style="color: #b5bd68;">"Note"</span>)
                                                                             (color . <span style="color: #b5bd68;">"#fff"</span>)))
                (set (make-local-variable 'evil-normal-state-cursor) (list nil))))

  (pdf-tools-install))
</pre>
</div>

<p>
Scale images in image mode
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key image-mode-map (kbd <span style="color: #b5bd68;">"g ="</span>) 'image-increase-size)
(define-key image-mode-map (kbd <span style="color: #b5bd68;">"g -"</span>) 'image-decrease-size)
</pre>
</div>

<p>
Use light mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">pdf-has-set-light-mode</span> nil
  <span style="color: #717171; font-style: italic;">"Whether PDf view has turned on light mode."</span>)

(add-hook 'post-command-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                 (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (not (equal major-mode 'pdf-view-mode)) pdf-has-set-light-mode)
                                   (reset-temporary-face-attributes)
                                   (set-background-color color-background)
                                   (set-foreground-color color-foreground)
                                   (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-normal-state-cursor '(<span style="color: #b5bd68;">"#fdf4c1"</span> box))
                                   (<span style="color: #CC6666; font-weight: bold;">setq</span> pdf-has-set-light-mode nil))))

(add-hook 'post-command-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                 (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (equal major-mode 'pdf-view-mode)
                                            (equal (count-windows) 1))
                                   (<span style="color: #CC6666; font-weight: bold;">setq</span> pdf-has-set-light-mode t)
                                   (set-background-color <span style="color: #b5bd68;">"#FFF"</span>)
                                   (set-foreground-color color-background)
                                   (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-normal-state-cursor '(<span style="color: #b5bd68;">"#FFF"</span> box))

                                   (set-temporary-face-attributes
                                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#FFF"</span>
                                    '(header-line
                                      mode-line))

                                   (set-temporary-face-attributes
                                    <span style="color: #81a2be;">:foreground</span> color-background
                                    '(mode-line
                                      mood-line-buffer-name
                                      mood-line-major-mode
                                      mood-line-modified
                                      mood-line-status-error
                                      mood-line-status-info
                                      mood-line-status-neutral
                                      mood-line-status-success
                                      mood-line-status-warning
                                      mood-line-unimportant)))))
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual pdf-view-mode-map (kbd <span style="color: #b5bd68;">"g h"</span>) #'pdf-annot-add-highlight-markup-annotation)

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual pdf-view-mode-map (kbd <span style="color: #b5bd68;">"g t"</span>) #'pdf-annot-add-text-annotation)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal pdf-view-mode-map (kbd <span style="color: #b5bd68;">"g t"</span>) #'pdf-annot-add-text-annotation)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org845e59c" class="outline-2">
<h2 id="org845e59c">Org</h2>
<div class="outline-text-2" id="text-org845e59c">
<p>
Make sure all code is run after org mode is loaded.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">org</span>
  <span style="color: #81a2be;">:hook</span> ((org-mode . flyspell-mode)
         (text-mode . flyspell-mode))
  <span style="color: #81a2be;">:init</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-emphasis-regexp-components
                '(<span style="color: #b5bd68;">"   ('\"{\x200B"</span> <span style="color: #b5bd68;">"-     .,:!?;'\")}\\[\x200B"</span> <span style="color: #b5bd68;">" ,\"'"</span> <span style="color: #b5bd68;">"."</span> 20))
  
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">ox</span>)

  &lt;&lt;org-mode-variables&gt;&gt;
  &lt;&lt;org-mode-config&gt;&gt;
  &lt;&lt;org-mode-compilation&gt;&gt;
  &lt;&lt;org-mode-emphasis-markers&gt;&gt;
  &lt;&lt;org-mode-greek&gt;&gt;
  &lt;&lt;org-mode-keybindings&gt;&gt;
  &lt;&lt;org-mode-faces&gt;&gt;
  &lt;&lt;org-mode-references&gt;&gt;
  &lt;&lt;autocorrect-words&gt;&gt;
  &lt;&lt;python-babel&gt;&gt;
  &lt;&lt;org-capture-popup&gt;&gt;
  &lt;&lt;org-mode-extend-emphasis&gt;&gt;)
</pre>
</div>

<p>
Set defaults.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-return-follows-link nil)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-src-preserve-indentation t)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-src-window-setup 'current-window)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-src-tab-acts-natively t)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-html-htmlize-output-type 'inline-css)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">prevent org from splitting line on meta return       </span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-M-RET-may-split-line nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">pretty LaTeX entities for org mode</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-pretty-entities t)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">prevent confirmation prompt when executing code blocks</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-confirm-babel-evaluate nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">prevent section indentation</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-adapt-indentation nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use all agenda files as refile targets</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-refile-targets '((org-agenda-files <span style="color: #81a2be;">:maxlevel</span> . 1)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">prevent section numbering in exports</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-export-with-section-numbers nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">show markdown for org-mode</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-hide-emphasis-markers nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use different ellipsis for folded content</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-ellipsis <span style="color: #b5bd68;">" [...]"</span>)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure to color latex</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-highlight-latex-and-related '(native entities))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">latex formatting</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-format-latex-options '(<span style="color: #81a2be;">:foreground</span> default
                                                     <span style="color: #81a2be;">:background</span> default
                                                     <span style="color: #81a2be;">:scale</span> 1.0
                                                     <span style="color: #81a2be;">:html-foreground</span> <span style="color: #b5bd68;">"Black"</span>
                                                     <span style="color: #81a2be;">:html-background</span> <span style="color: #b5bd68;">"Transparent"</span>
                                                     <span style="color: #81a2be;">:html-scale</span> 0.4
                                                     <span style="color: #81a2be;">:matchers</span> (<span style="color: #b5bd68;">"begin"</span> <span style="color: #b5bd68;">"$1"</span> <span style="color: #b5bd68;">"$"</span> <span style="color: #b5bd68;">"$$"</span> <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">"</span> <span style="color: #b5bd68;">"\\["</span>)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">prevent html export from having postamble</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-html-postamble nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">remove table of contents from export</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-export-with-toc nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use smart quotation marks</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-export-with-smart-quotes t)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop displaying inline images in org-mode</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-startup-with-inline-images nil)
<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">(add-hook 'org-babel-after-execute-hook 'org-display-inline-images 'append)</span>


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">default image width </span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-image-actual-width 600)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">change MathJax formatting</span>
(<span style="color: #CC6666; font-weight: bold;">setf</span> org-html-mathjax-options
      '((path <span style="color: #b5bd68;">"https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_HTML"</span>)
        (scale <span style="color: #b5bd68;">"90"</span>) 
        (align <span style="color: #b5bd68;">"center"</span>) 
        (indent <span style="color: #b5bd68;">"2em"</span>)
        (mathml nil)
        (font <span style="color: #b5bd68;">"Neo-Euler"</span>)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">change custom date format</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-time-stamp-custom-formats '(<span style="color: #b5bd68;">"&lt;%A, %m/%d/%y&gt;"</span> . <span style="color: #b5bd68;">"&lt;%A, %m/%d/%y, %H:%M&gt;"</span>))
</pre>
</div>

<p>
Use section numbering.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-section-num-format</span> (numbering)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (= (length numbering) 1)
      (propertize (concat (mapconcat
                           #'number-to-string
                           numbering <span style="color: #b5bd68;">"."</span>) <span style="color: #f0c674;">" | "</span><span style="color: #f0c674;"> )</span>
                  'face `(<span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Victor Mono"</span>
                                  <span style="color: #81a2be;">:height</span> 140
                                  <span style="color: #81a2be;">:foreground</span> ,color-darkish-subdued))
    (propertize (concat (mapconcat
                         #'number-to-string
                         numbering <span style="color: #b5bd68;">"."</span>) <span style="color: #f0c674;">" &#8212; "</span><span style="color: #f0c674;"> )</span>
                'face `(<span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Victor Mono"</span>
                                <span style="color: #81a2be;">:height</span> 140
                                <span style="color: #81a2be;">:foreground</span> ,color-dark-subdued))))


(font-lock-add-keywords 'org-mode
                        `((<span style="color: #b5bd68;">"^*+ "</span> . 'org-meta-line)))


(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-num-format-function #'org-section-num-format)


(add-hook 'org-mode-hook #'org-num-mode)
</pre>
</div>
</div>

<div id="outline-container-org7ace70b" class="outline-3">
<h3 id="org7ace70b">Compilation</h3>
<div class="outline-text-3" id="text-org7ace70b">
<p>
Compile all org files with a given name into one file (recursive).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">replace-all</span> (regexp string)
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (goto-char (point-min))
    (<span style="color: #CC6666; font-weight: bold;">while</span> (re-search-forward regexp nil t)
      (replace-match string))))

(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-compile-files</span> (dir regexp title)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"DWhich directory? \nsWhich files? \nsWhat title? "</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((files (directory-files-recursively dir regexp))
        (output-path (concat dir <span style="color: #b5bd68;">"compilation.org"</span>)))
    (write-region (format <span style="color: #b5bd68;">"#+title: %s\n\n"</span> title) nil output-path)
    (mapc (<span style="color: #CC6666; font-weight: bold;">lambda</span> (file)
            (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
              (insert-file-contents file)
              (replace-all <span style="color: #b5bd68;">"^\\*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">\\** </span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span> <span style="color: #b5bd68;">"**\\1"</span>)
              (replace-all <span style="color: #b5bd68;">"#\\+title: </span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">.+</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span> <span style="color: #b5bd68;">"* \\1"</span>)
              (goto-char (point-max))
              (newline)
              (append-to-file (point-min) (point-max) output-path)))
          files)
    (find-file output-path)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6422c73" class="outline-3">
<h3 id="org6422c73">Capture</h3>
<div class="outline-text-3" id="text-org6422c73">
<p>
Stop creating bookmarks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-capture-bookmark nil)
</pre>
</div>

<p>
Make sure capture is the only window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-capture-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                     (delete-other-windows)
                                     (evil-insert-state)
                                     (<span style="color: #CC6666; font-weight: bold;">setq-local</span> header-line-format nil)))
</pre>
</div>

<p>
Customize org capture popup.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-capture-select-template</span> (<span style="color: #6CA17A;">&amp;optional</span> keys)
  <span style="color: #717171; font-style: italic;">"Select a capture template.</span>
<span style="color: #717171; font-style: italic;">Lisp programs can force the template by setting KEYS to a string."</span>
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((org-capture-templates
         (<span style="color: #CC6666; font-weight: bold;">or</span> (org-contextualize-keys
              (org-capture-upgrade-templates org-capture-templates)
              org-capture-templates-contexts)
             '((<span style="color: #b5bd68;">"t"</span> <span style="color: #b5bd68;">"Task"</span> entry (file+headline <span style="color: #b5bd68;">""</span> <span style="color: #b5bd68;">"Tasks"</span>)
                <span style="color: #b5bd68;">"* TODO %?\n  %u\n  %a"</span>)))))
    (<span style="color: #CC6666; font-weight: bold;">if</span> keys
        (<span style="color: #CC6666; font-weight: bold;">or</span> (assoc keys org-capture-templates)
            (<span style="color: #f0c674;">error</span> <span style="color: #b5bd68;">"No capture template referred to by \"%s\" keys"</span> keys))
      (org-mks org-capture-templates
               (concat
                <span style="color: #b5bd68;">"Select a capture template\n"</span>
                (make-string 25 9472))
               <span style="color: #b5bd68;">"Template key: "</span>
               '((<span style="color: #b5bd68;">"C"</span> <span style="color: #b5bd68;">"Customize org-capture-templates"</span>)
                 (<span style="color: #b5bd68;">"q"</span> <span style="color: #b5bd68;">"Abort"</span>))))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-mks</span> (table title <span style="color: #6CA17A;">&amp;optional</span> prompt specials)
  <span style="color: #717171; font-style: italic;">"Select a member of an alist with multiple keys.</span>

<span style="color: #717171; font-style: italic;">TABLE is the alist which should contain entries where the car is a string.</span>
<span style="color: #717171; font-style: italic;">There should be two types of entries.</span>

<span style="color: #717171; font-style: italic;">1. prefix descriptions like (\"a\" \"Description\")</span>
<span style="color: #717171; font-style: italic;">   This indicates that `</span><span style="color: #CC6666; font-style: italic;">a</span><span style="color: #717171; font-style: italic;">' is a prefix key for multi-letter selection, and</span>
<span style="color: #717171; font-style: italic;">   that there are entries following with keys like \"ab\", \"ax\"...</span>

<span style="color: #717171; font-style: italic;">2. Select-able members must have more than two elements, with the first</span>
<span style="color: #717171; font-style: italic;">   being the string of keys that lead to selecting it, and the second a</span>
<span style="color: #717171; font-style: italic;">   short description string of the item.</span>

<span style="color: #717171; font-style: italic;">The command will then make a temporary buffer listing all entries</span>
<span style="color: #717171; font-style: italic;">that can be selected with a single key, and all the single key</span>
<span style="color: #717171; font-style: italic;">prefixes.  When you press the key for a single-letter entry, it is selected.</span>
<span style="color: #717171; font-style: italic;">When you press a prefix key, the commands (and maybe further prefixes)</span>
<span style="color: #717171; font-style: italic;">under this key will be shown and offered for selection.</span>

<span style="color: #717171; font-style: italic;">TITLE will be placed over the selection in the temporary buffer,</span>
<span style="color: #717171; font-style: italic;">PROMPT will be used when prompting for a key.  SPECIALS is an</span>
<span style="color: #717171; font-style: italic;">alist with (\"key\" \"description\") entries.  When one of these</span>
<span style="color: #717171; font-style: italic;">is selected, only the bare key is returned."</span>
  (<span style="color: #CC6666; font-weight: bold;">save-window-excursion</span>
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((inhibit-quit t)
          (buffer (org-switch-to-buffer-other-window <span style="color: #b5bd68;">"*Org Select*"</span>))
          (prompt (<span style="color: #CC6666; font-weight: bold;">or</span> prompt <span style="color: #b5bd68;">"Select: "</span>))
          case-fold-search
          current)
      (<span style="color: #CC6666; font-weight: bold;">setq-local</span> olivetti-body-width 50)
      (olivetti-mode 1)
      (<span style="color: #CC6666; font-weight: bold;">unwind-protect</span>
          (<span style="color: #CC6666; font-weight: bold;">catch</span> '<span style="color: #CC6666;">exit</span>
            (<span style="color: #CC6666; font-weight: bold;">while</span> t
              (erase-buffer)
              (insert title <span style="color: #b5bd68;">"\n\n"</span>)
              (<span style="color: #CC6666; font-weight: bold;">let</span> ((des-keys nil)
                    (allowed-keys '(<span style="color: #b5bd68;">"\C-g"</span>))
                    (tab-alternatives '(<span style="color: #b5bd68;">"\s"</span> <span style="color: #b5bd68;">"\t"</span> <span style="color: #b5bd68;">"\r"</span>))
                    (cursor-type nil))
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Populate allowed keys and descriptions keys</span>
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">available with CURRENT selector.</span>
                (<span style="color: #CC6666; font-weight: bold;">let</span> ((re (format <span style="color: #b5bd68;">"\\`%s</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">.</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">\\'"</span>
                                  (<span style="color: #CC6666; font-weight: bold;">if</span> current (regexp-quote current) <span style="color: #b5bd68;">""</span>)))
                      (prefix (<span style="color: #CC6666; font-weight: bold;">if</span> current (concat current <span style="color: #b5bd68;">" "</span>) <span style="color: #b5bd68;">""</span>)))
                  (<span style="color: #CC6666; font-weight: bold;">dolist</span> (entry table)
                    (<span style="color: #CC6666; font-weight: bold;">pcase</span> entry
                      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Description.</span>
                      (`(,(<span style="color: #CC6666; font-weight: bold;">and</span> key (pred (string-match re))) ,desc)
                       (<span style="color: #CC6666; font-weight: bold;">let</span> ((k (match-string 1 key)))
                         (<span style="color: #CC6666; font-weight: bold;">push</span> k des-keys)
                         <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Keys ending in tab, space or RET are equivalent.</span>
                         (<span style="color: #CC6666; font-weight: bold;">if</span> (member k tab-alternatives)
                             (<span style="color: #CC6666; font-weight: bold;">push</span> <span style="color: #b5bd68;">"\t"</span> allowed-keys)
                           (<span style="color: #CC6666; font-weight: bold;">push</span> k allowed-keys))
                         (insert prefix <span style="color: #b5bd68;">"["</span> k <span style="color: #b5bd68;">"]"</span> <span style="color: #b5bd68;">"..."</span> <span style="color: #b5bd68;">"  "</span> desc <span style="color: #b5bd68;">"..."</span> <span style="color: #b5bd68;">"\n"</span>)))
                      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Usable entry.</span>
                      (`(,(<span style="color: #CC6666; font-weight: bold;">and</span> key (pred (string-match re))) ,desc . ,_)
                       (<span style="color: #CC6666; font-weight: bold;">let</span> ((k (match-string 1 key)))
                         (insert prefix <span style="color: #b5bd68;">"["</span> k <span style="color: #b5bd68;">"]"</span> <span style="color: #b5bd68;">"     "</span> desc <span style="color: #b5bd68;">"\n"</span>)
                         (<span style="color: #CC6666; font-weight: bold;">push</span> k allowed-keys)))
                      (_ nil))))
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Insert special entries, if any.</span>
                (<span style="color: #CC6666; font-weight: bold;">when</span> specials
                  (insert (concat <span style="color: #b5bd68;">"\n"</span> (make-string (- (window-width) 1) 9472) <span style="color: #b5bd68;">"\n"</span> <span style="color: #b5bd68;">"\n"</span>))
                  (<span style="color: #CC6666; font-weight: bold;">pcase-dolist</span> (`(,key ,description) specials)
                    (insert (format <span style="color: #b5bd68;">"[%s]     %s\n"</span> key description))
                    (<span style="color: #CC6666; font-weight: bold;">push</span> key allowed-keys)))
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Display UI and let user select an entry or</span>
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">a sub-level prefix.</span>
                (goto-char (point-min))
                (org-fit-window-to-buffer)
                (message <span style="color: #b5bd68;">""</span>) <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">With this line the prompt appears in</span>
                                        <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">the minibuffer. Else keystrokes may</span>
                                        <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">appear, which is spurious.</span>
                (<span style="color: #CC6666; font-weight: bold;">let</span> ((pressed (org--mks-read-key
                                allowed-keys prompt
                                (not (pos-visible-in-window-p (1- (point-max)))))))
                  (<span style="color: #CC6666; font-weight: bold;">setq</span> current (concat current pressed))
                  (<span style="color: #CC6666; font-weight: bold;">cond</span>
                   ((equal pressed <span style="color: #b5bd68;">"\C-g"</span>) (<span style="color: #f0c674;">user-error</span> <span style="color: #b5bd68;">"Abort"</span>))
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Selection is a prefix: open a new menu.</span>
                   ((member pressed des-keys))
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Selection matches an association: return it.</span>
                   ((<span style="color: #CC6666; font-weight: bold;">let</span> ((entry (assoc current table)))
                      (<span style="color: #CC6666; font-weight: bold;">and</span> entry (<span style="color: #CC6666; font-weight: bold;">throw</span> '<span style="color: #CC6666;">exit</span> entry))))
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Selection matches a special entry: return the</span>
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">selection prefix.</span>
                   ((assoc current specials) (<span style="color: #CC6666; font-weight: bold;">throw</span> '<span style="color: #CC6666;">exit</span> current))
                   (t (<span style="color: #f0c674;">error</span> <span style="color: #b5bd68;">"No entry available"</span>)))))))
        (<span style="color: #CC6666; font-weight: bold;">when</span> buffer (kill-buffer buffer))))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop opening new window</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-switch-to-buffer-other-window</span> (<span style="color: #6CA17A;">&amp;rest</span> args)
  <span style="color: #717171; font-style: italic;">"Switch to buffer in a second window on the current frame.</span>
<span style="color: #717171; font-style: italic;">In particular, do not allow pop-up frames.</span>
<span style="color: #717171; font-style: italic;">Returns the newly created buffer."</span>
  (<span style="color: #CC6666; font-weight: bold;">org-no-popups</span> (apply #'switch-to-buffer args)))
</pre>
</div>

<p>
Templates.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-capture-templates
              '((<span style="color: #b5bd68;">"g"</span> <span style="color: #b5bd68;">"General"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"General"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"m"</span> <span style="color: #b5bd68;">"Meeting"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"General"</span>)
                 <span style="color: #b5bd68;">"** %?  :meeting:"</span>)
                (<span style="color: #b5bd68;">"i"</span> <span style="color: #b5bd68;">"BYU IS"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"Work"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"r"</span> <span style="color: #b5bd68;">"Research"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"Research"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"v"</span> <span style="color: #b5bd68;">"Event"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"General"</span>)
                 <span style="color: #b5bd68;">"** %?  :event:"</span>)
                (<span style="color: #b5bd68;">"c"</span> <span style="color: #b5bd68;">"MATH 215"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"MATH 215"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"l"</span> <span style="color: #b5bd68;">"MATH 213"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"MATH 213"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"a"</span> <span style="color: #b5bd68;">"PHSCS 127"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"PHSCS 127"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"p"</span> <span style="color: #b5bd68;">"CS 111"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"CS 111"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"f"</span> <span style="color: #b5bd68;">"REL C 200"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"REL C 200"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"w"</span> <span style="color: #b5bd68;">"PHSCS 123"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"PHSCS 123"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"s"</span> <span style="color: #b5bd68;">"PHSCS 191"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"PHSCS 191"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"j"</span> <span style="color: #b5bd68;">"Major"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"Major"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)
                (<span style="color: #b5bd68;">"e"</span> <span style="color: #b5bd68;">"Emacs"</span> entry (file+headline <span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span> <span style="color: #b5bd68;">"Emacs"</span>)
                 <span style="color: #b5bd68;">"** TODO %?"</span>)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span style="color: #b5bd68;">"c"</span> #'org-capture)
</pre>
</div>
</div>
</div>

<div id="outline-container-org70b3808" class="outline-3">
<h3 id="org70b3808">User interface</h3>
<div class="outline-text-3" id="text-org70b3808">
<p>
Code to show emphasis markers using a particular face.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">change face for emphasis markers</span>
(<span style="color: #CC6666; font-weight: bold;">defface</span> <span style="color: #E0DBA9;">org-emphasis-marker</span> '((t (<span style="color: #81a2be;">:inherit</span> shadow)))
  <span style="color: #717171; font-style: italic;">"Face for Org emphasis markers"</span>
  <span style="color: #81a2be;">:group</span> 'org-faces)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-do-emphasis-faces</span> (limit)
  <span style="color: #717171; font-style: italic;">"Run through the buffer and emphasize strings."</span>
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">org-macs</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">org-compat</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((quick-re (format <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[%s]</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">^</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[~=*/_+]</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span>
                          (car org-emphasis-regexp-components))))
    (<span style="color: #CC6666; font-weight: bold;">catch</span> <span style="color: #CC6666;">:exit</span>
      (<span style="color: #CC6666; font-weight: bold;">while</span> (re-search-forward quick-re limit t)
        (<span style="color: #CC6666; font-weight: bold;">let*</span> ((marker (match-string 2))
               (verbatim? (member marker '(<span style="color: #b5bd68;">"~"</span> <span style="color: #b5bd68;">"="</span>))))
          (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                  (goto-char (match-beginning 0))
                  (<span style="color: #CC6666; font-weight: bold;">and</span>
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Do not match table hlines.</span>
                   (not (<span style="color: #CC6666; font-weight: bold;">and</span> (equal marker <span style="color: #b5bd68;">"+"</span>)
                             (org-match-line
                              <span style="color: #b5bd68;">"[ \t]*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">|[-+]+|?</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\+[-+]+\\+</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">[ \t]*$"</span>)))
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Do not match headline stars.  Do not consider</span>
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stars of a headline as closing marker for bold</span>
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">markup either.</span>
                   (not (<span style="color: #CC6666; font-weight: bold;">and</span> (equal marker <span style="color: #b5bd68;">"*"</span>)
                             (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                               (forward-char)
                               (skip-chars-backward <span style="color: #b5bd68;">"*"</span>)
                               (looking-at-p org-outline-regexp-bol))))
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Match full emphasis markup regexp.</span>
                   (looking-at (<span style="color: #CC6666; font-weight: bold;">if</span> verbatim? org-verbatim-re org-emph-re))
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Do not span over paragraph boundaries.</span>
                   (not (string-match-p org-element-paragraph-separate
                                        (match-string 2)))
                   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Do not span over cells in table rows.</span>
                   (not (<span style="color: #CC6666; font-weight: bold;">and</span> (<span style="color: #CC6666; font-weight: bold;">save-match-data</span> (org-match-line <span style="color: #b5bd68;">"[ \t]*|"</span>))
                             (string-match-p <span style="color: #b5bd68;">"|"</span> (match-string 4))))))
            (<span style="color: #CC6666; font-weight: bold;">pcase-let</span> ((`(,_ ,face ,_) (assoc marker org-emphasis-alist)))
              (font-lock-prepend-text-property
               (match-beginning 2) (match-end 2) 'face face)
              (<span style="color: #CC6666; font-weight: bold;">when</span> verbatim?
                (org-remove-flyspell-overlays-in
                 (match-beginning 0) (match-end 0))
                (remove-text-properties (match-beginning 2) (match-end 2)
                                        '(display t invisible t intangible t)))
              (add-text-properties (match-beginning 2) (match-end 2)
                                   '(font-lock-multiline t org-emphasis t)))

            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Begin new code</span>
            (font-lock-prepend-text-property
             (match-beginning 3) (match-end 3) 'face 'org-emphasis-marker)
            (font-lock-prepend-text-property
             (match-end 4) (match-beginning 5) 'face 'org-emphasis-marker)
            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">End new code</span>

            (<span style="color: #CC6666; font-weight: bold;">when</span> org-hide-emphasis-markers
              (add-text-properties (match-end 4) (match-beginning 5)
                                   '(invisible org-link))
              (add-text-properties (match-beginning 3) (match-end 3)
                                   '(invisible org-link))))
          (<span style="color: #CC6666; font-weight: bold;">throw</span> <span style="color: #CC6666;">:exit</span> t))))))

<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">thanks, https://www.reddit.com/r/emacs/comments/eipbvk/org_emphasis_marker_face/</span>
</pre>
</div>

<p>
Use other font for Greek text.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">not necessarily the best approach, but it works</span>
(add-hook 'org-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (set-fontset-font t 'greek (font-spec <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Helvetica"</span> <span style="color: #81a2be;">:weight</span> 'normal <span style="color: #81a2be;">:height</span> 0.75))))

</pre>
</div>

<p>
Use variable pitch in org buffers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">mixed-pitch</span>
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> mixed-pitch-set-height t)
  (set-face-attribute 'variable-pitch nil <span style="color: #81a2be;">:height</span> 1.15))
</pre>
</div>

<p>
Hide source blocks by default (thanks, <a href="https://emacs.stackexchange.com/a/7366">https://emacs.stackexchange.com/a/7366</a>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">org-blocks-hidden</span> nil)

(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-toggle-blocks</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> org-blocks-hidden
      (org-show-block-all)
    (org-hide-block-all))
  (<span style="color: #CC6666; font-weight: bold;">setq-local</span> org-blocks-hidden (not org-blocks-hidden)))

(add-hook 'org-mode-hook #'org-toggle-blocks)
</pre>
</div>

<p>
Indent <code>src</code> block header.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-src-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                 (<span style="color: #CC6666; font-weight: bold;">setq</span> header-line-format <span style="color: #b5bd68;">""</span>)))
</pre>
</div>

<p>
Customize faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'org-block-begin-line nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:background</span> color-background
                    <span style="color: #81a2be;">:foreground</span> color-dark-subdued)


(set-face-attribute 'org-block nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#fdf4c1"</span>
                    <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#121112"</span>)


(set-face-attribute 'org-code nil
                    <span style="color: #81a2be;">:inherit</span> 'shadow)


(set-face-attribute 'org-document-info-keyword nil
                    <span style="color: #81a2be;">:inherit</span> 'shadow)


(set-face-attribute 'org-document-title nil
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>
                    <span style="color: #81a2be;">:height</span> 190
                    <span style="color: #81a2be;">:foreground</span> color-foreground)


(set-face-attribute 'org-link nil
                    <span style="color: #81a2be;">:inherit</span> 'custom-link)


(set-face-attribute 'org-meta-line nil
                    <span style="color: #81a2be;">:foreground</span> color-dark-subdued)


(set-face-attribute 'org-property-value nil
                    <span style="color: #81a2be;">:inherit</span> nil
                    <span style="color: #81a2be;">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-special-keyword nil
                    <span style="color: #81a2be;">:inherit</span> 'font-lock-comment-face
                    <span style="color: #81a2be;">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-todo nil
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-dark-brown)


(set-face-attribute 'org-verbatim nil
                    <span style="color: #81a2be;">:inherit</span> 'shadow
                    <span style="color: #81a2be;">:foreground</span> color-light-green)


(set-face-attribute 'outline-1 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 180
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'outline-2 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 160
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'outline-3 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 160
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'outline-4 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 160
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'outline-5 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 160
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'outline-6 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 160
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'outline-7 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 160
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'outline-8 nil
                    <span style="color: #81a2be;">:extend</span> t
                    <span style="color: #81a2be;">:height</span> 160
                    <span style="color: #81a2be;">:weight</span> 'bold
                    <span style="color: #81a2be;">:foreground</span> color-light-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Optima"</span>)


(set-face-attribute 'org-emphasis-marker nil
                    <span style="color: #81a2be;">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-table nil
                    <span style="color: #81a2be;">:foreground</span> color-brown)


(set-face-attribute 'org-ellipsis nil
                    <span style="color: #81a2be;">:foreground</span> color-dark-subdued
                    <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Victor Mono"</span>
                    <span style="color: #81a2be;">:height</span> 120)


(set-face-attribute 'org-tag nil
                    <span style="color: #81a2be;">:foreground</span> color-dark-subdued
                    <span style="color: #81a2be;">:height</span> 140)


(set-face-attribute 'org-checkbox nil
                    <span style="color: #81a2be;">:foreground</span> color-brown
                    <span style="color: #81a2be;">:height</span> 140)


(set-face-attribute 'org-latex-and-related nil
                    <span style="color: #81a2be;">:foreground</span> color-green
                    <span style="color: #81a2be;">:weight</span> 'bold)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf5bc744" class="outline-3">
<h3 id="orgf5bc744">Editing</h3>
<div class="outline-text-3" id="text-orgf5bc744">
<p>
Add <code>evil-embrace</code> pairs to org mode and add text objects.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (delete ?b evil-embrace-evil-surround-keys)

                             (embrace-add-pair ?i <span style="color: #b5bd68;">"/"</span> <span style="color: #b5bd68;">"/"</span>)
                             (embrace-add-pair ?b <span style="color: #b5bd68;">"*"</span> <span style="color: #b5bd68;">"*"</span>)
                             (embrace-add-pair ?u <span style="color: #b5bd68;">"_"</span> <span style="color: #b5bd68;">"_"</span>)))


(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">evil-tex</span>
  <span style="color: #81a2be;">:config</span>
  (add-hook 'org-mode-hook #'evil-tex-mode)

  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-tex-surround-delimiters
                `((?m <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;"> "</span> . <span style="color: #b5bd68;">" </span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span>)
                  (?M <span style="color: #b5bd68;">"\\[ "</span> . <span style="color: #b5bd68;">" \\]"</span>)
                  (?c . ,#'evil-tex-surround-command-prompt)
                  (?e . ,#'evil-tex-surround-env-prompt)
                  (?d . ,#'evil-tex-surround-delim-prompt)
                  (?\; . ,#'evil-tex-surround-cdlatex-accents-prompt)
                  (?q <span style="color: #b5bd68;">"`"</span> . <span style="color: #b5bd68;">"'"</span>)
                  (?Q <span style="color: #b5bd68;">"``"</span> . <span style="color: #b5bd68;">"''"</span>)
                  (?^ <span style="color: #b5bd68;">"^{"</span> . <span style="color: #b5bd68;">"}"</span>)
                  (?_ <span style="color: #b5bd68;">"_{"</span> . <span style="color: #b5bd68;">"}"</span>)
                  (?T <span style="color: #b5bd68;">"&amp;"</span> . <span style="color: #b5bd68;">"&amp;"</span>)))

  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> evil-tex-delim-map
                (<span style="color: #CC6666; font-weight: bold;">let</span> ((keymap (make-sparse-keymap)))
                  (evil-tex-bind-to-delim-map
                   '((<span style="color: #b5bd68;">"P"</span>  <span style="color: #b5bd68;">"("</span> . <span style="color: #b5bd68;">")"</span>)
                     (<span style="color: #b5bd68;">"p"</span>  <span style="color: #b5bd68;">"\\left( "</span> . <span style="color: #b5bd68;">" \\right)"</span>)
                     (<span style="color: #b5bd68;">"S"</span>  <span style="color: #b5bd68;">"["</span> . <span style="color: #b5bd68;">"]"</span>)
                     (<span style="color: #b5bd68;">"s"</span>  <span style="color: #b5bd68;">"\\left[ "</span> . <span style="color: #b5bd68;">" \\right]"</span>)
                     (<span style="color: #b5bd68;">"C"</span>  <span style="color: #b5bd68;">"\\{ "</span> . <span style="color: #b5bd68;">" \\}"</span>)
                     (<span style="color: #b5bd68;">"c"</span>  <span style="color: #b5bd68;">"\\left\\{ "</span> . <span style="color: #b5bd68;">" \\right\\}"</span>)
                     (<span style="color: #b5bd68;">"R"</span>  <span style="color: #b5bd68;">"\\langle "</span> . <span style="color: #b5bd68;">" \\rangle"</span>)
                     (<span style="color: #b5bd68;">"r"</span>  <span style="color: #b5bd68;">"\\left\\langle "</span> . <span style="color: #b5bd68;">" \\right\\rangle"</span>)
                     (<span style="color: #b5bd68;">"v"</span> <span style="color: #b5bd68;">"\\left\\lvert "</span> . <span style="color: #b5bd68;">" \\right\\rvert"</span>)
                     (<span style="color: #b5bd68;">"V"</span> <span style="color: #b5bd68;">"\\lvert "</span> . <span style="color: #b5bd68;">" \\rvert"</span>)
                     (<span style="color: #b5bd68;">"n"</span> <span style="color: #b5bd68;">"\\left\\lVert "</span> . <span style="color: #b5bd68;">" \\right\\rVert"</span>) <span style="color: #5a5b5a; font-style: italic;">; </span><span style="color: #5a5b5a; font-style: italic;">(n for norm)</span>
                     (<span style="color: #b5bd68;">"N"</span> <span style="color: #b5bd68;">"\\lVert "</span> . <span style="color: #b5bd68;">" \\rVert"</span>))
                   keymap)
                  keymap)))
</pre>
</div>

<p>
Display entities in current line (thanks <a href="https://www.reddit.com/r/emacs/comments/i9pfld/disable_orgprettyentities_on_the_current_line/">Reddit</a>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">my/current-line</span> '(0 . 0)
  <span style="color: #717171; font-style: italic;">"(start . end) of current line in current buffer"</span>)
(make-variable-buffer-local 'my/current-line)


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">my/unhiding-current-line</span> t
  <span style="color: #717171; font-style: italic;">"Whether to unhide current line."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">my/unhide-current-line</span> (limit)
  <span style="color: #717171; font-style: italic;">"Font-lock function"</span>
  (<span style="color: #CC6666; font-weight: bold;">when</span> my/unhiding-current-line
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((start (max (point) (car my/current-line)))
          (end (min limit (cdr my/current-line))))
      (<span style="color: #CC6666; font-weight: bold;">when</span> (&lt; start end)
        (remove-text-properties start end '(invisible t display <span style="color: #b5bd68;">""</span> composition <span style="color: #b5bd68;">""</span>))
        (goto-char limit)
        t))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">my/refontify-on-linemove</span> ()
  <span style="color: #717171; font-style: italic;">"Post-command-hook"</span>
  (<span style="color: #CC6666; font-weight: bold;">let*</span> ((start (line-beginning-position))
         (end (line-beginning-position 2))
         (needs-update (not (equal start (car my/current-line)))))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> my/current-line (cons start end))
    (<span style="color: #CC6666; font-weight: bold;">when</span> needs-update
      (font-lock-fontify-block 2))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">my/entity-unhighlight</span> ()
  <span style="color: #717171; font-style: italic;">"Install"</span>
  (font-lock-add-keywords nil '((my/unhide-current-line)) t)
  (add-hook 'post-command-hook #'my/refontify-on-linemove nil t))

(add-hook 'org-mode-hook #'my/entity-unhighlight)
</pre>
</div>

<p>
Make sure emphasis works across multiple lines.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
</pre>
</div>

<p>
Copy text without newlines (useful due to auto-fill mode).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">evil-define-operator</span> <span style="color: #6CA17A;">evil-yank-no-newlines</span> (beg end type register yank-handler)
  <span style="color: #717171; font-style: italic;">"Yank text from BEG to END with TYPE while stripping newlines."</span>
  <span style="color: #81a2be;">:move-point</span> nil
  <span style="color: #81a2be;">:repeat</span> nil
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"&lt;R&gt;&lt;x&gt;&lt;y&gt;"</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((evil-was-yanked-without-register
         (<span style="color: #CC6666; font-weight: bold;">and</span> evil-was-yanked-without-register (not register))))
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((old-buffer (current-buffer)))
      (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
        (insert-buffer-substring old-buffer beg end)
        (<span style="color: #CC6666; font-weight: bold;">let</span> ((fill-column (point-max)))
          (fill-region (point-min) (point-max)))
      (<span style="color: #CC6666; font-weight: bold;">cond</span>
       ((eq type 'block)
        (evil-yank-rectangle (point-min) (point-max) register yank-handler))
       ((memq type '(line screen-line))
        (evil-yank-lines (point-min) (point-max) register yank-handler))
       (t
        (evil-yank-characters (point-min) (point-max) register yank-handler)))))))


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual org-mode-map <span style="color: #b5bd68;">"Y"</span> 'evil-yank-no-newlines)
</pre>
</div>

<p>
Blank table region (only works on one column at a time for now).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-table-blank-selected-fields</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let*</span> ((start (region-beginning))
         (end (region-end))
         (start-line (line-number-at-pos start))
         (end-line (line-number-at-pos end))
         (line-count (- end-line start-line)))
    (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
      (goto-char start)
      (<span style="color: #CC6666; font-weight: bold;">dotimes</span> (_ line-count)
        (org-table-blank-field)
        (next-line))
      (org-table-blank-field))))


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual org-mode-map (kbd <span style="color: #b5bd68;">"RET"</span>) #'org-table-blank-selected-fields)
</pre>
</div>

<p>
Auto-capitalize words.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">auto-capitalize</span>
  <span style="color: #81a2be;">:load-path</span> <span style="color: #b5bd68;">"lisp/"</span>
  <span style="color: #81a2be;">:hook</span> (org-mode . auto-capitalize-mode)

  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> auto-capitalize-predicate
                #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                    (<span style="color: #CC6666; font-weight: bold;">and</span> (not (texmathp))
                         (not (org-in-src-block-p))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb296ad8" class="outline-3">
<h3 id="orgb296ad8">Key bindings</h3>
<div class="outline-text-3" id="text-orgb296ad8">
<p>
Set key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure C-; works in org-mode</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-;"</span>) #'eval-expression)
(define-key flyspell-mode-map (kbd <span style="color: #b5bd68;">"C-;"</span>) #'eval-expression)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use RET for newline and to fill paragraph</span>
<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">(define-key org-mode-map (kbd "&lt;RET&gt;")</span>
<span style="color: #5a5b5a; font-style: italic;">;;   </span><span style="color: #5a5b5a; font-style: italic;">#'(lambda ()</span>
<span style="color: #5a5b5a; font-style: italic;">;;       </span><span style="color: #5a5b5a; font-style: italic;">(interactive)</span>
<span style="color: #5a5b5a; font-style: italic;">;;       </span><span style="color: #5a5b5a; font-style: italic;">(newline)</span>
<span style="color: #5a5b5a; font-style: italic;">;;       </span><span style="color: #5a5b5a; font-style: italic;">(when (equal (char-before (- (point) 1)) ?\C-j)</span>
<span style="color: #5a5b5a; font-style: italic;">;;         </span><span style="color: #5a5b5a; font-style: italic;">(fill-paragraph))))</span>


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">toggle link display</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"&lt;f8&gt;"</span>) #'org-toggle-link-display)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">compile org files</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"&lt;f4&gt;"</span>) #'org-compile-files)
(define-key dired-mode-map (kbd <span style="color: #b5bd68;">"&lt;f4&gt;"</span>) #'org-compile-files)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">define term in notes</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual org-mode-map (kbd <span style="color: #b5bd68;">"C-d"</span>) #'org-note-create-definition)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-d"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                      (org-note-create-definition nil nil)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure C-i works like TAB</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-c-i</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (texmathp)
      (yas-expand)
    (org-cycle)))

(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-i"</span>) #'org-c-i)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-i"</span>) #'org-c-i)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'visual org-mode-map (kbd <span style="color: #b5bd68;">"C-i"</span>) #'org-c-i)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">schedule todo items</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g s"</span>) #'org-schedule)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set todo item deadlines</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g d"</span>) #'org-deadline)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">schedule item without being a task</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g ."</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
        (<span style="color: #CC6666; font-weight: bold;">if</span> (equal (line-end-position) (point-max))
            (open-line-down))
        (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
          (org-previous-visible-heading 1)
          (goto-char (line-end-position))
          (insert (format <span style="color: #b5bd68;">"\n%s"</span> (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
                                   (org-time-stamp nil)))))
        (delete-region (1- (line-beginning-position)) (line-end-position)))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set tag</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g T"</span>) #'org-set-tags-command)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">save and close org capture</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-capture-mode-map (kbd <span style="color: #b5bd68;">"g f"</span>) #'org-capture-finalize)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">save and close org capture</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-capture-mode-map (kbd <span style="color: #b5bd68;">"g q"</span>) #'org-capture-kill)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use org-specific jump back</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-o"</span>) #'org-mark-ring-goto)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">fix paragraph navigation</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"] ]"</span> ) #'evil-forward-section-begin)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"[ ["</span> ) #'evil-backward-section-begin)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">move headings</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-M-k"</span>) #'org-metaup)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-M-j"</span>) #'org-metadown)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">meta return in normal mode</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g o"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                      (end-of-line)
                                                      (org-meta-return)
                                                      (evil-insert-state)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">create headings</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-n"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (org-insert-heading-respect-content)
      (evil-insert-state)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">create new todo haeding</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-t"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (org-insert-todo-heading-respect-content)
      (evil-insert-state)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">copy cell contents</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"C-c C-y"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (<span style="color: #CC6666; font-weight: bold;">when</span> (org-at-table-p)
        (kill-new
         (string-trim
          (substring-no-properties (org-table-get-field))))
        (message <span style="color: #b5bd68;">"Copied cell contents."</span>))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">toggle source block visibility </span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"&lt;f12&gt;"</span>) #'org-toggle-blocks)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">create org-mode links across files</span>
(global-set-key (kbd <span style="color: #b5bd68;">"C-c l"</span>) #'org-store-link)
(global-set-key (kbd <span style="color: #b5bd68;">"C-c C-l"</span>) #'org-insert-link)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use `g j' and `g k' for navigating lists</span>
(add-hook 'org-mode-hook (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                           (define-key evil-normal-state-local-map (kbd <span style="color: #b5bd68;">"g j"</span>) #'org-shiftdown)
                           (define-key evil-normal-state-local-map (kbd <span style="color: #b5bd68;">"g k"</span>) #'org-shiftup)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">export English text</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"&lt;f5&gt;"</span>) #'export-colored)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use C-S-j as M-RET</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-M-j"</span>) 'org-meta-return)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure `z j` and `z k` are properly bound</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"z j"</span>) #'open-line-down)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"z k"</span>) #'open-line-up)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure that window switching works</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"M-h"</span>) #'evil-window-left)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"M-j"</span>) #'evil-window-down)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"M-k"</span>) #'evil-window-up)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"M-l"</span>) #'evil-window-right)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">insert today's date</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g D"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                      (forward-char)
                                                      (insert (format-time-string <span style="color: #b5bd68;">"%d/%m/%Y --- %A"</span>))))
</pre>
</div>

<p>
Better integration with evil.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">org-evil</span>)
</pre>
</div>

<p>
Add evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">export org/latex file as HTML</span>
(evil-leader/set-key <span style="color: #b5bd68;">"h"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> (equal major-mode 'org-mode)
                                 (export-and-open-html)
                               (<span style="color: #CC6666; font-weight: bold;">if</span> (equal major-mode 'latex-mode)
                                   (call-interactively 'TeX-command-run-all)
                                 (browse-url-of-file)))))


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">org-export-html-live-online</span> nil
  <span style="color: #717171; font-style: italic;">"Whether the live Org HTML export server is on."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-export-html-toggle-live-server</span> ()
  <span style="color: #717171; font-style: italic;">"Toggle the liver Org HTMl export server."</span>
  (<span style="color: #CC6666; font-weight: bold;">if</span> org-export-html-live-online
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (kill-process <span style="color: #b5bd68;">"org-export-html-live-server"</span>)
        (message <span style="color: #b5bd68;">"Killed live export server."</span>)
        (<span style="color: #CC6666; font-weight: bold;">setq</span> org-export-html-live-online nil))
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((html-path (format <span style="color: #b5bd68;">"%s.html"</span> (file-name-base (buffer-file-name)))))
      (message html-path)
      (set-process-sentinel (start-process <span style="color: #b5bd68;">"org-export-html-live-server"</span>
                                           <span style="color: #b5bd68;">"*Org Live Export*"</span>
                                           <span style="color: #b5bd68;">"/Users/jetblack/.npm-global/bin/reload"</span>
                                           <span style="color: #b5bd68;">"-b"</span>
                                           <span style="color: #b5bd68;">"-s"</span>
                                           html-path)
                            #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (process event)
                                (<span style="color: #CC6666; font-weight: bold;">when</span> (memq (process-status process) '(exit signal))
                                  (kill-buffer <span style="color: #b5bd68;">"*Org Live Export*"</span>)))))
    (message <span style="color: #b5bd68;">"Started live export server."</span>)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> org-export-html-live-online t)))


(evil-leader/set-key <span style="color: #b5bd68;">"H"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (start-server)
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> start-server
                                 (org-export-html-toggle-live-server)
                               (<span style="color: #CC6666; font-weight: bold;">when</span> (equal major-mode 'org-mode)
                                 (org-html-export-to-html)
                                 (shell-command (format <span style="color: #b5bd68;">"open -a Vivaldi"</span> ))))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">export org/latex file as PDF</span>
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">org-pdf-separate-window</span> '())

(add-hook 'kill-buffer-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                (<span style="color: #CC6666; font-weight: bold;">if</span> (member (current-buffer) org-pdf-separate-window)
                                    (<span style="color: #CC6666; font-weight: bold;">setq</span> org-pdf-separate-window (delete (current-buffer) org-pdf-separate-window)))))

(add-hook 'after-save-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                               (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (equal major-mode 'org-mode)
                                        (member (current-buffer) org-pdf-separate-window))
                                   (org-export-pdf-update))))

(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-latex-preview-pdf</span> (separate-window)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
  (<span style="color: #CC6666; font-weight: bold;">cond</span> ((equal separate-window 1)
         (<span style="color: #CC6666; font-weight: bold;">if</span> (member (current-buffer) org-pdf-separate-window)
             (<span style="color: #CC6666; font-weight: bold;">progn</span>
               (<span style="color: #CC6666; font-weight: bold;">setq</span> org-pdf-separate-window (delete (current-buffer) org-pdf-separate-window))
               (message <span style="color: #b5bd68;">"Stopped live compilation for this buffer."</span>))
           (message <span style="color: #b5bd68;">"Started live compilation for this buffer."</span>)
           (<span style="color: #CC6666; font-weight: bold;">push</span> (current-buffer) org-pdf-separate-window)))
        ((equal separate-window 2)
         (expand-org-latex-workspace))
        ((equal major-mode 'org-mode)
         (export-and-open-pdf separate-window))
        ((equal major-mode 'latex-mode)
         (call-interactively 'TeX-command-run-all))
        (t (browse-url-of-file))))

(evil-leader/set-key <span style="color: #b5bd68;">"P"</span> #'org-latex-preview-pdf)

<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">fill paragraph</span>
(evil-leader/set-key <span style="color: #b5bd68;">"p"</span> #'fill-paragraph)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open links</span>
(evil-leader/set-key <span style="color: #b5bd68;">"o"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                             (<span style="color: #CC6666; font-weight: bold;">cond</span>
                              ((equal major-mode 'org-mode) (org-open-at-point))
                              ((equal major-mode 'notmuch-show-mode) (shr-browse-url)))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient way to toggle latex preview in org-mode</span>
(evil-leader/set-key <span style="color: #b5bd68;">"l"</span> #'org-latex-preview)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">convenient way to execute all code blocks at once</span>
(evil-leader/set-key <span style="color: #b5bd68;">"\""</span> 'org-babel-execute-buffer)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">edit in separate buffer</span>
(evil-leader/set-key <span style="color: #b5bd68;">"`"</span> (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                           (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                           (<span style="color: #CC6666; font-weight: bold;">if</span> (not (equal major-mode 'org-mode))
                               (org-edit-src-exit)
                             (org-edit-special))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">org babel tangle</span>
(evil-leader/set-key <span style="color: #b5bd68;">"SPC"</span> 'org-babel-tangle)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7995c7e" class="outline-3">
<h3 id="org7995c7e">Packages</h3>
<div class="outline-text-3" id="text-org7995c7e">
</div>
<div id="outline-container-org6ca578c" class="outline-4">
<h4 id="org6ca578c">Org download</h4>
<div class="outline-text-4" id="text-org6ca578c">
<p>
Drag and drop images.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">org-download</span>
  <span style="color: #81a2be;">:config</span>
  (add-hook 'dired-mode-hook 'org-download-enable))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d8f7bb" class="outline-4">
<h4 id="org6d8f7bb">Helm org</h4>
<div class="outline-text-4" id="text-org6d8f7bb">
<p>
Configuration for <code>helm-org</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">helm-org</span>
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map <span style="color: #b5bd68;">"?"</span> #'helm-org-in-buffer-headings))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgba1f512" class="outline-4">
<h4 id="orgba1f512">Org Agenda</h4>
<div class="outline-text-4" id="text-orgba1f512">
<p>
Org agenda variables.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set directory for global org files</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-files '(<span style="color: #b5bd68;">"~/Documents/Education/schedule.org"</span>
                                 <span style="color: #b5bd68;">"~/Documents/general.org"</span>
                                 <span style="color: #b5bd68;">"~/Documents/calendar.org"</span>))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open org-agenda in the same window</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-window-setup 'current-window)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop showing warnings for deadlines</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-skip-deadline-prewarning-if-scheduled t)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure the week starts on Sunday</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-start-on-weekday nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">hide deadlines by default</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-include-deadlines nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">customize "now" string for agenda view; "King of the moment"</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-current-time-string <span style="color: #b5bd68;">"&#9472;&#9472;&#9472;*&#9472;*&#9472;  &#9818;  &#9472;*&#9472;*&#9472;&#9472;&#9472;"</span>)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-time-grid
              '((daily today require-timed)
                (800 1000 1200 1400 1600 1800 2000)
                <span style="color: #b5bd68;">"......"</span> <span style="color: #b5bd68;">"--------------------"</span>))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">hide tags from agenda items</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-remove-tags t)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set org agenda item display</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-prefix-format '((agenda . <span style="color: #b5bd68;">"  %-12:c%?-12t"</span>)
                                         (timeline . <span style="color: #b5bd68;">"  % s"</span>)
                                         (todo . <span style="color: #b5bd68;">" %i %-12:c"</span>)
                                         (tags . <span style="color: #b5bd68;">" %i %-12:c"</span>)
                                         (search . <span style="color: #b5bd68;">" %i %-12:c"</span>)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">add line dividers between dates</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-format-date (<span style="color: #CC6666; font-weight: bold;">lambda</span> (date) (concat <span style="color: #b5bd68;">"\n"</span>
                                                            (make-string 68 9472)
                                                            <span style="color: #b5bd68;">"\n"</span>
                                                            (org-agenda-format-date-aligned date))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set heading</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-overriding-header <span style="color: #b5bd68;">""</span>)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set tag alignment column</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-tags-column 60)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-tags-column 60)
</pre>
</div>

<p>
Org agenda faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'org-agenda-date nil
                    <span style="color: #81a2be;">:foreground</span> color-medium-subdued
                    <span style="color: #81a2be;">:weight</span> 'normal)


(set-face-attribute 'org-agenda-date-today nil
                    <span style="color: #81a2be;">:foreground</span> color-foreground
                    <span style="color: #81a2be;">:weight</span> 'normal)


(set-face-attribute 'org-agenda-date-weekend nil
                    <span style="color: #81a2be;">:foreground</span> color-darkish-subdued
                    <span style="color: #81a2be;">:weight</span> 'normal)


(set-face-attribute 'org-scheduled nil
                    <span style="color: #81a2be;">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-scheduled-today nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#fdf4c1"</span>)


(set-face-attribute 'org-scheduled-previously nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#fdf4c1"</span>
                    <span style="color: #81a2be;">:weight</span> 'normal)


(set-face-attribute 'org-agenda-structure nil
                    <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#bdb491"</span>
                    <span style="color: #81a2be;">:weight</span> 'ultra-bold)


(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-priority-faces `((?A . (<span style="color: #81a2be;">:foreground</span> ,color-red <span style="color: #81a2be;">:weight</span> bold))
                                   (?B . (<span style="color: #81a2be;">:foreground</span> ,color-light-orange <span style="color: #81a2be;">:weight</span> medium))
                                   (?C . (<span style="color: #81a2be;">:foreground</span> ,color-light-green <span style="color: #81a2be;">:weight</span> normal))))
</pre>
</div>

<p>
Show notifications.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">appt</span>)

(<span style="color: #CC6666; font-weight: bold;">setq-default</span> appt-time-msg-list nil)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> appt-display-interval '5)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> appt-message-warning-time '15)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> appt-display-mode-line nil)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> appt-display-format 'window)

(<span style="color: #CC6666; font-weight: bold;">setq-default</span> appt-disp-window-function (<span style="color: #CC6666; font-weight: bold;">function</span> appt-display-notification))

(appt-activate 1)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">appt-display-notification</span> (min-to-app new-time msg)
  (shell-command-to-string
   (format
    <span style="color: #b5bd68;">"terminal-notifier -title \"Appointment in %s\" -message \"%s\" -sender org.gnu.Emacs"</span>
    min-to-app
    msg))
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((org-agenda-category-filter-preset '(<span style="color: #b5bd68;">"-Calendar"</span>)))
    (org-agenda-list)))


(org-agenda-to-appt)
(run-at-time <span style="color: #b5bd68;">"24:01"</span> 3600 'org-agenda-to-appt)
(add-hook 'org-agenda-finalize-hook #'org-agenda-to-appt)
</pre>
</div>

<p>
Use Olivetti mode in agenda.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-agenda-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                    (olivetti-set-width 70)
                                    (olivetti-mode 1)
                                    (<span style="color: #CC6666; font-weight: bold;">setq</span> default-mode-line-format mode-line-format)
                                    (<span style="color: #CC6666; font-weight: bold;">setq</span> mode-line-format nil)))
</pre>
</div>

<p>
Make it easier to use agenda on its dedicated laptop screen.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">dedicate-monitor-to-org-agenda</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (modify-frame-parameters nil '((fullscreen . fullboth)))
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((org-agenda-category-filter-preset '(<span style="color: #b5bd68;">"-Calendar"</span>)))
    (org-agenda-list))
  (olivetti-set-width 72)
  (text-scale-set 1.5))
</pre>
</div>

<p>
Publish agenda.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">progenda-schedule-path</span> <span style="color: #b5bd68;">"/Users/jetblack/Documents/Education/schedule.org"</span>)
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">progenda-publish-path</span> <span style="color: #b5bd68;">"/Users/jetblack/Documents/Education/Progenda/"</span>)

(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">progenda-publish-schedule</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">save-window-excursion</span>
    (<span style="color: #CC6666; font-weight: bold;">let*</span> ((json-data (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> (find-file-noselect progenda-schedule-path)
                        (ox-json-export-to-buffer)
                        (<span style="color: #CC6666; font-weight: bold;">let</span> ((contents (buffer-string)))
                          (kill-buffer)
                          contents)))
           (js-data (concat <span style="color: #b5bd68;">"const data = "</span> json-data)))
      (write-region js-data nil (concat progenda-publish-path <span style="color: #b5bd68;">"data.js"</span>))))
  (shell-command-to-string (format <span style="color: #b5bd68;">"cd %s &amp;&amp; git add . &amp;&amp; git commit -m '</span><span style="color: #CC6666;">Updated.</span><span style="color: #b5bd68;">' &amp;&amp; git push"</span> progenda-publish-path))
  (message <span style="color: #b5bd68;">"Published schedule."</span>))
</pre>
</div>

<p>
Org agenda hooks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-agenda-mode-hook
          #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
              (hl-line-mode 1)
              (<span style="color: #CC6666; font-weight: bold;">setq-local</span> evil-normal-state-cursor '(<span style="color: #b5bd68;">"#151719"</span> bar))))


(advice-add #'org-agenda-redo <span style="color: #81a2be;">:after</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (<span style="color: #6CA17A;">&amp;rest</span> args)
                                         (evil-refresh-cursor)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">move cursor to first item</span>
(advice-add 'org-agenda-list <span style="color: #81a2be;">:after</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (<span style="color: #6CA17A;">&amp;rest</span> args)
                                        (org-agenda-next-item 1)))


(add-hook 'org-agenda-finalize-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                        (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                        (<span style="color: #CC6666; font-weight: bold;">if</span> (&gt; text-scale-mode-amount 0)
                                            (olivetti-set-width 72))))
</pre>
</div>

<p>
Org agenda key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure normal state is enabled by default in org agenda</span>
(evil-set-initial-state 'org-agenda-mode 'normal)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open agenda from calendar</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal calendar-mode-map (kbd <span style="color: #b5bd68;">"g l"</span>) #'org-calendar-goto-agenda)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use j k to navigate items</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"j"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (org-agenda-next-item 1)
      (beginning-of-line)))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"k"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (org-agenda-previous-item 1)
      (beginning-of-line)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">save all org buffers from agenda</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"g s"</span>) #'org-save-all-org-buffers)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open agenda item with return in normal state</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"C-j"</span>) #'org-agenda-switch-to)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"RET"</span>) #'org-agenda-switch-to)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">toggle todo</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"t"</span>) #'org-agenda-todo)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">reschedule task</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"s"</span>) #'org-agenda-schedule)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">refile task</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"R"</span>) #'org-agenda-refile)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">search for task</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"S"</span>) #'org-search-view)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">reload</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"r"</span>) #'org-agenda-redo)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">filter by current category</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"c"</span>) #'org-agenda-filter-by-category)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">inverse filter by current category</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"-"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (org-agenda-filter-by-category t)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set priority</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">","</span>) #'org-agenda-priority)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set day view</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"."</span>) #'org-agenda-day-view)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set week view</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"w"</span>) #'org-agenda-week-view)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set fortnight view</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"F"</span>) #'org-agenda-fortnight-view)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">goto date</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"f"</span>) #'org-agenda-goto-date)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">delete item</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"D"</span>) #'org-agenda-kill)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">set deadline</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"d"</span>) #'org-agenda-deadline)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">toggle deadlines</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"g d"</span>) #'org-agenda-toggle-deadlines)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">filter</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"/"</span>) #'org-agenda-filter)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">add tag</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"'"</span>) #'org-agenda-set-tags)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">add and display text related to item</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"E"</span>) #'org-agenda-add-note)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"e"</span>) #'org-agenda-entry-text-mode)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">exit agenda</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span style="color: #b5bd68;">"x"</span>) #'org-agenda-exit)
</pre>
</div>

<p>
Org agenda evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open agenda without calendar; the proper way to do this is with a custom view</span>
(evil-leader/set-key <span style="color: #b5bd68;">"a"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (dedicate-monitor)
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> dedicate-monitor
                                 (dedicate-monitor-to-org-agenda)
                               (<span style="color: #CC6666; font-weight: bold;">let</span> ((org-agenda-category-filter-preset '(<span style="color: #b5bd68;">"-Calendar"</span>)))
                                 (org-agenda-list)))))


(evil-leader/set-key <span style="color: #b5bd68;">"A"</span> #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (sync)
                             (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
                             (<span style="color: #CC6666; font-weight: bold;">if</span> sync
                                 (shell-command-to-string <span style="color: #b5bd68;">"/Users/jetblack/cbin/sync-calendar"</span>))
                             (org-agenda-list)))


(evil-leader/set-key <span style="color: #b5bd68;">"G"</span> #'progenda-publish-schedule)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">with-eval-after-load</span> 'org-agenda
  &lt;&lt;org-agenda-variables&gt;&gt;
  &lt;&lt;org-agenda-faces&gt;&gt;
  &lt;&lt;org-agenda-hooks&gt;&gt;
  &lt;&lt;org-agenda-keybindings&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd4528b" class="outline-4">
<h4 id="orgbd4528b">Olivetti</h4>
<div class="outline-text-4" id="text-orgbd4528b">
<p>
Use Olivetti.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">olivetti</span>)
</pre>
</div>

<p>
Distraction-free environment.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">message-filter-center</span> (args)
  <span style="color: #717171; font-style: italic;">"Center message string.</span>
<span style="color: #717171; font-style: italic;">This is a :filter-args advice for `message`."</span>
  (<span style="color: #CC6666; font-weight: bold;">if</span> (car args)
      (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> (window-buffer (minibuffer-window))
        (<span style="color: #CC6666; font-weight: bold;">let*</span> ((str (apply #'format-message args))
               (filler (make-string (max 0 (/ (- (window-width (minibuffer-window)) (string-width str)) 2)) ? )))
          (list <span style="color: #b5bd68;">"%s%s"</span> filler str)))
    args))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-detect-distraction-free-keyword</span> ()
  (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (org-keyword-activep <span style="color: #b5bd68;">"DFREE"</span> t) (not (string-prefix-p <span style="color: #b5bd68;">"*scratch"</span> (buffer-name))))
      (distraction-free (org-keyword-activep <span style="color: #b5bd68;">"LITERARY"</span>))))


(add-hook 'org-mode-hook #'org-detect-distraction-free-keyword)


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">distraction-free-background-set</span> nil)


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">stored-face-attributes</span> nil)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">set-temporary-face-attributes</span> (attribute value faces)
  (<span style="color: #CC6666; font-weight: bold;">dolist</span> (face faces)
    (add-to-list 'stored-face-attributes
                 (list face attribute (face-attribute face attribute)))
    (set-face-attribute face nil attribute value)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">reset-temporary-face-attributes</span> ()
  (<span style="color: #CC6666; font-weight: bold;">dolist</span> (item stored-face-attributes)
    (set-face-attribute (car item) nil (nth 1 item) (nth 2 item)))
  (<span style="color: #CC6666; font-weight: bold;">setq</span> stored-face-attributes nil))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">set-distraction-free-background</span> ()
  (<span style="color: #CC6666; font-weight: bold;">if</span> (org-keyword-activep <span style="color: #b5bd68;">"LITERARY"</span>)
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (<span style="color: #CC6666; font-weight: bold;">when</span> (not distraction-free-background-set)
          (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-emacs-state-cursor `(,color-background box))
          (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-normal-state-cursor `(,color-background box))
          (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-insert-state-cursor `(,color-background bar))

          (set-temporary-face-attributes
           <span style="color: #81a2be;">:foreground</span> color-background
           '(org-document-title
             header-line
             outline-1
             outline-2
             outline-3
             outline-4
             outline-5
             outline-6
             outline-7
             outline-8))

          (set-temporary-face-attributes
           <span style="color: #81a2be;">:background</span> <span style="color: #b5bd68;">"#FFF"</span>
           '(org-block-begin-line
             org-block-end-line
             sp-pair-overlay-face
             header-line
             yas-field-highlight-face))

          (set-temporary-face-attributes
           <span style="color: #81a2be;">:foreground</span> color-green
           '(yas-field-highlight-face))

          (set-background-color <span style="color: #b5bd68;">"#FFF"</span>)
          (set-foreground-color color-background))
        (<span style="color: #CC6666; font-weight: bold;">setq</span> distraction-free-background-set t))
    (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span> distraction-free-background-set
               (not pdf-has-set-light-mode)
               (<span style="color: #CC6666; font-weight: bold;">or</span> helm-alive-p
                   (not (equal major-mode 'minibuffer-mode))))
      (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-emacs-state-cursor `(<span style="color: #b5bd68;">"white"</span> box))
      (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-normal-state-cursor `(<span style="color: #b5bd68;">"#fdf4c1"</span> box))
      (<span style="color: #CC6666; font-weight: bold;">setq</span> evil-insert-state-cursor `(<span style="color: #b5bd68;">"#fdf4c1"</span> bar))
      (reset-temporary-face-attributes)
      (set-background-color color-background)
      (set-foreground-color color-foreground))
    (<span style="color: #CC6666; font-weight: bold;">setq</span> distraction-free-background-set nil)))


(add-hook 'post-command-hook #'set-distraction-free-background)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">distraction-free</span> (use-mixed-pitch <span style="color: #6CA17A;">&amp;optional</span> no-spell)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (equal olivetti-mode nil)
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (<span style="color: #CC6666; font-weight: bold;">when</span> use-mixed-pitch
          (olivetti-set-width 75)
          (mixed-pitch-mode 1)
          (<span style="color: #CC6666; font-weight: bold;">setq-local</span> line-spacing 4))
        (<span style="color: #CC6666; font-weight: bold;">setq-local</span> default-mode-line-format mode-line-format)
        (<span style="color: #CC6666; font-weight: bold;">setq-local</span> mode-line-format nil)
        (olivetti-mode 1)
        (<span style="color: #CC6666; font-weight: bold;">if</span> (not no-spell)
            (flyspell-mode)))
    (mixed-pitch-mode 0)
    (olivetti-mode 0)
    (set-window-margins (get-buffer-window) 2)
    (<span style="color: #CC6666; font-weight: bold;">setq-local</span> mode-line-format default-mode-line-format)
    (<span style="color: #CC6666; font-weight: bold;">setq-local</span> line-spacing nil)))


(add-hook 'evil-insert-state-entry-hook
          #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
              (<span style="color: #CC6666; font-weight: bold;">when</span> line-spacing
                (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                  (end-of-line)
                  (insert ? )))))


(add-hook 'evil-insert-state-exit-hook
          #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
              (<span style="color: #CC6666; font-weight: bold;">when</span> line-spacing
                (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                  (end-of-line)
                  (<span style="color: #CC6666; font-weight: bold;">when</span> (equal (char-before) ? )
                    (delete-backward-char 1))))))
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span style="color: #b5bd68;">"u"</span> #'distraction-free)
</pre>
</div>
</div>
</div>

<div id="outline-container-org861d064" class="outline-4">
<h4 id="org861d064">Dictionary</h4>
<div class="outline-text-4" id="text-org861d064">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">osx-dictionary</span>
  <span style="color: #81a2be;">:config</span>
  &lt;&lt;dictionary-goto-function&gt;&gt;
  &lt;&lt;dictionary-display-functions&gt;&gt;
  &lt;&lt;dictionary-search-function&gt;&gt;)
</pre>
</div>

<p>
Redefine function to open dictionary in the same window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">osx-dictionary--goto-dictionary</span> (word)
  <span style="color: #717171; font-style: italic;">"Switch to osx-dictionary buffer in other window."</span>
  (<span style="color: #CC6666; font-weight: bold;">setq</span> osx-dictionary-previous-window-configuration
        (current-window-configuration))
  (<span style="color: #CC6666; font-weight: bold;">let*</span> ((buffer (osx-dictionary--get-buffer word))
         (window (get-buffer-window buffer)))
    (<span style="color: #CC6666; font-weight: bold;">if</span> (null window)
        (switch-to-buffer buffer)
      (select-window window))))
</pre>
</div>

<p>
Use Olivetti in buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">osx-dictionary--view-result</span> (word)
  <span style="color: #717171; font-style: italic;">"Make buffer for the searching result of WORD."</span>
  (<span style="color: #CC6666; font-weight: bold;">if</span> word
      (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> (get-buffer-create
                            (funcall osx-dictionary-generate-buffer-name-function word))
        (<span style="color: #CC6666; font-weight: bold;">let</span> ((inhibit-read-only t))
          (erase-buffer)
          (<span style="color: #CC6666; font-weight: bold;">let</span> ((progress-reporter
                 (make-progress-reporter (format <span style="color: #b5bd68;">"Searching (%s)..."</span> word)
                                         nil nil)))
            (insert (osx-dictionary--search word))
            (progress-reporter-done progress-reporter))
          (osx-dictionary--goto-dictionary word)
          (goto-char (point-min))

          (olivetti-set-width 70)
          (olivetti-mode 1)
          (mixed-pitch-mode 1)
          (<span style="color: #CC6666; font-weight: bold;">setq</span> default-mode-line-format mode-line-format)
          (<span style="color: #CC6666; font-weight: bold;">setq</span> mode-line-format nil)
          (<span style="color: #CC6666; font-weight: bold;">setq</span> line-spacing 4)

          (<span style="color: #CC6666; font-weight: bold;">let</span> ((buffer-read-only nil))
            (whitespace-cleanup))))
    (message <span style="color: #b5bd68;">"Nothing to look up"</span>)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">osx-dictionary-quit</span> ()
  <span style="color: #717171; font-style: italic;">"Quit osx-dictionary: reselect previously selected buffer."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (mixed-pitch-mode 0)
  (olivetti-mode 0)
  (<span style="color: #CC6666; font-weight: bold;">setq</span> mode-line-format default-mode-line-format)
  (set-window-margins (get-buffer-window) 2)
  (<span style="color: #CC6666; font-weight: bold;">setq</span> line-spacing nil)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (window-configuration-p osx-dictionary-previous-window-configuration)
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (set-window-configuration osx-dictionary-previous-window-configuration)
        (<span style="color: #CC6666; font-weight: bold;">setq</span> osx-dictionary-previous-window-configuration nil)
        (kill-buffer))
    (kill-buffer)))
</pre>
</div>

<p>
Customize appearance.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defface</span> <span style="color: #E0DBA9;">phonetics-lock</span>
  '((t <span style="color: #81a2be;">:family</span> <span style="color: #b5bd68;">"Gentium Plus"</span>))
  <span style="color: #717171; font-style: italic;">"Face for dictionary phonetics."</span>
  <span style="color: #81a2be;">:group</span> 'osx-dictionary-mode)


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">phonetics-lock</span> 'phonetics-lock
  <span style="color: #717171; font-style: italic;">"Face for dictionary phonetics."</span>)


(<span style="color: #CC6666; font-weight: bold;">setq-default</span> osx-dictionary-mode-font-lock-keywords
              '(
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Word class</span>
                (<span style="color: #b5bd68;">"\\b</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">noun</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">adjective</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">det</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">verb</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">adverb</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">abbreviation</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">preposition</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">suffix</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">prefix</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">conjunction</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">symb</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">\\b"</span> . font-lock-type-face)
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Serial number</span>
                (<span style="color: #b5bd68;">"^[0-9]+"</span> . font-lock-builtin-face)
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Phonetics</span>
                (<span style="color: #b5bd68;">"|</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">.*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">|"</span> . phonetics-lock)
                <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Dictionary comment</span>
                (<span style="color: #b5bd68;">"^</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">DERIVATIVES</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">ORIGIN</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">PHRASES</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span> . font-lock-comment-face)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">center header</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">center-header</span> (header)
  <span style="color: #717171; font-style: italic;">"Center HEADER string."</span>
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((header-length 70))
    (append
     `(,(make-string (- (/ (window-total-width) 2)
                        (/ header-length 2))
                     (string-to-char <span style="color: #b5bd68;">" "</span>)))
     header)))


(<span style="color: #CC6666; font-weight: bold;">define-derived-mode</span> <span style="color: #6CA17A;">osx-dictionary-mode</span> fundamental-mode <span style="color: #b5bd68;">"osx-dictionary"</span>
  <span style="color: #717171; font-style: italic;">"Major mode to look up word through dictionary.</span>
<span style="color: #717171; font-style: italic;">\\{osx-dictionary-mode-map}.</span>
<span style="color: #717171; font-style: italic;">Turning on Text mode runs the normal hook `</span><span style="color: #CC6666; font-style: italic;">osx-dictionary-mode-hook</span><span style="color: #717171; font-style: italic;">'."</span>

  (<span style="color: #CC6666; font-weight: bold;">setq</span> header-line-format (center-header osx-dictionary-mode-header-line))
  (<span style="color: #CC6666; font-weight: bold;">setq</span> font-lock-defaults '(osx-dictionary-mode-font-lock-keywords)))
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'osx-dictionary-mode-hook
          #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
              (evil-local-set-key 'normal (kbd <span style="color: #b5bd68;">"q"</span>) #'osx-dictionary-quit)))
</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span style="color: #b5bd68;">"d"</span> #'osx-dictionary-search-input)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8ab5341" class="outline-4">
<h4 id="org8ab5341">Calc</h4>
<div class="outline-text-4" id="text-org8ab5341">
<p>
Convenient way to use quick-calc.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">clean-quick-calc</span> (start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (<span style="color: #CC6666; font-weight: bold;">if</span> (region-active-p)
       (list (region-beginning) (region-end))
     '(nil nil)))

  (<span style="color: #CC6666; font-weight: bold;">if</span> (null start)
      (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
        (<span style="color: #CC6666; font-weight: bold;">let</span> ((calc-language 'latex))
          (quick-calc t))
        (kill-ring-save (point-min) (point-max)))
    (<span style="color: #CC6666; font-weight: bold;">progn</span>
      (<span style="color: #CC6666; font-weight: bold;">let*</span> ((expression-start start)
             (prefix (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                       (goto-char start)
                       (<span style="color: #CC6666; font-weight: bold;">condition-case</span> nil
                           (<span style="color: #CC6666; font-weight: bold;">progn</span>
                             (re-search-forward <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[[:space:]]*&amp;= </span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[[:space:]]*= </span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">"</span> end)
                             (<span style="color: #CC6666; font-weight: bold;">setq</span> expression-start (match-end 0))
                             (match-string 0))
                         (<span style="color: #f0c674;">error</span> <span style="color: #b5bd68;">""</span>))))
             (expression (replace-regexp-in-string
                          <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">[abcxyz]</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">_[[:digit:]]</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">[[:space:]]*("</span>
                          <span style="color: #b5bd68;">"\\1*("</span>
                          (replace-regexp-in-string
                           <span style="color: #b5bd68;">"\\\\left</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\\\right"</span>
                           <span style="color: #b5bd68;">""</span>
                           (buffer-substring expression-start end)))))
        (delete-region start (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (equal (evil-visual-type) 'line)
                                      (not (equal end (point-max))))
                                 (- end 1) end))
        (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
          (goto-char start)
          (insert prefix)
          (<span style="color: #CC6666; font-weight: bold;">let</span> ((calc-language 'latex))
            (insert (calc-eval expression))))))))
</pre>
</div>

<p>
Add special constants to &ldquo;s k&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">calc-special-constants</span> '((<span style="color: #b5bd68;">""</span>)
                                 (<span style="color: #b5bd68;">"e"</span> . (special-const (math-e)))
                                 (<span style="color: #b5bd68;">"pi"</span> . (special-const (math-pi)))
                                 (<span style="color: #b5bd68;">"i"</span> . (special-const (math-imaginary 1)))
                                 (<span style="color: #b5bd68;">"phi"</span> . (special-const (math-phi)))
                                 (<span style="color: #b5bd68;">"gamma"</span> . (special-const (math-gamma-const)))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">calc-copy-special-constant</span> (<span style="color: #6CA17A;">&amp;optional</span> sconst var)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((sc calc-special-constants))
    (<span style="color: #CC6666; font-weight: bold;">calc-wrapper</span>
     (<span style="color: #CC6666; font-weight: bold;">or</span> sconst (<span style="color: #CC6666; font-weight: bold;">setq</span> sconst (completing-read <span style="color: #b5bd68;">"Special constant: "</span> sc nil t)))
     (<span style="color: #CC6666; font-weight: bold;">unless</span> (string= sconst <span style="color: #b5bd68;">""</span>)
       (<span style="color: #CC6666; font-weight: bold;">let</span> ((value (cdr (assoc sconst sc))))
         (<span style="color: #CC6666; font-weight: bold;">or</span> var (<span style="color: #CC6666; font-weight: bold;">setq</span> var (calc-read-var-name
                            (format <span style="color: #b5bd68;">"Copy special constant %s, to: "</span>
                                    sconst))))
         (<span style="color: #CC6666; font-weight: bold;">if</span> var
             (<span style="color: #CC6666; font-weight: bold;">let</span> ((msg (calc-store-value var value <span style="color: #b5bd68;">""</span>)))
               (message <span style="color: #b5bd68;">"Special constant \"%s\" copied to \"%s\"%s"</span>
                        sconst (calc-var-name var) msg))))))))
</pre>
</div>

<p>
Convenient way to define new constants.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">calc-define-constant</span> (name variable key)
  <span style="color: #717171; font-style: italic;">"Define a constant for Calc from a predefined variable."</span>
  (add-to-list 'calc-special-constants `(,name . (special-const ,variable)))

  (<span style="color: #CC6666; font-weight: bold;">let</span> ((name name)
        (variable variable))
    (<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal calc-mode-map (kbd key)
      `(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
          (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
          (<span style="color: #CC6666; font-weight: bold;">calc-slow-wrapper</span>
           (<span style="color: #CC6666; font-weight: bold;">if</span> calc-symbolic-mode
               (calc-pop-push-record 0 ,name '(var ,(intern name) ,variable))
             (calc-pop-push-record 0 ,name (symbol-value ,variable))))))))
</pre>
</div>

<p>
Add constants.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">var-G</span> `(special-const (math-read-expr <span style="color: #b5bd68;">"6.6743e-11 m^3/kg/s^2"</span>))
  <span style="color: #717171; font-style: italic;">"The gravitational constant."</span>)
(calc-define-constant <span style="color: #b5bd68;">"G"</span> 'var-G <span style="color: #b5bd68;">"c k G"</span>)


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">var-C</span> `(special-const (math-read-expr <span style="color: #b5bd68;">"299792458 m/s"</span>))
  <span style="color: #717171; font-style: italic;">"The speed of light in a vacuum."</span>)
(calc-define-constant <span style="color: #b5bd68;">"C"</span> 'var-C <span style="color: #b5bd68;">"c k C"</span>)
</pre>
</div>

<p>
Calc styling.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> calc-highlight-selections-with-faces t)
</pre>
</div>

<p>
Evaluate expression at limits.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">evaluate-math-expression-at-point</span> (substition start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (append (list (read-string <span style="color: #b5bd68;">"Evaluate at (e.g., \"x=1,y=2\"): "</span>))
           (<span style="color: #CC6666; font-weight: bold;">if</span> (use-region-p)
               (list (region-beginning) (region-end))
             (list (line-beginning-position) (line-end-position)))))

  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (goto-char end)
    (insert (<span style="color: #CC6666; font-weight: bold;">let</span> ((contents (buffer-substring start end)))
              (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
                (insert (string-substitute-math-variables contents substition))
                (clean-quick-calc (point-min) (point-max))
                (buffer-string))))
    (delete-region start end)))

(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">evaluate-math-expression-at-limits</span> (var a b start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (append (split-string (read-string <span style="color: #b5bd68;">"Evaluate at (e.g., \"x,1,2\"): "</span>) <span style="color: #b5bd68;">","</span>)
           (<span style="color: #CC6666; font-weight: bold;">if</span> (use-region-p)
               (list (region-beginning) (region-end))
             (list (line-beginning-position) (line-end-position)))))

  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (goto-char end)
    (insert (<span style="color: #CC6666; font-weight: bold;">let</span> ((contents (buffer-substring start end)))
              (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
                (insert (format <span style="color: #b5bd68;">"(%s) - (%s)"</span>
                                (string-substitute-math-variables contents (format <span style="color: #b5bd68;">"%s=%s"</span> var b))
                                (string-substitute-math-variables contents (format <span style="color: #b5bd68;">"%s=%s"</span> var a))))
                (clean-quick-calc (point-min) (point-max))
                (buffer-string))))
    (delete-region start end)))


(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"g r l"</span>) #'evaluate-math-expression-at-limits)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal global-map (kbd <span style="color: #b5bd68;">"g r p"</span>) #'evaluate-math-expression-at-point)
</pre>
</div>

<p>
Use square brackets for matrices.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(put 'latex 'math-matrix-formatter
     (<span style="color: #CC6666; font-weight: bold;">lambda</span> (a)
       (<span style="color: #CC6666; font-weight: bold;">if</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (integerp calc-language-option)
                (<span style="color: #CC6666; font-weight: bold;">or</span> (= calc-language-option 0)
                    (&gt; calc-language-option 1)
                    (&lt; calc-language-option -1)))
           (append '(vleft 0 <span style="color: #b5bd68;">"\\begin{bmatrix}"</span>)
                   (math-compose-tex-matrix (cdr a) t)
                   '(<span style="color: #b5bd68;">"\\end{bmatrix}"</span>))
         (append '(horiz <span style="color: #b5bd68;">"\\begin{bmatrix} "</span>)
                 (math-compose-tex-matrix (cdr a) t)
                 '(<span style="color: #b5bd68;">" \\end{bmatrix}"</span>)))))
</pre>
</div>

<p>
Copy calc results as kill. <a href="https://emacs.stackexchange.com/a/48362">Thanks, Akinori!</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">calc-copy-as-kill-clean</span> ()
    <span style="color: #717171; font-style: italic;">"Copy the top of stack as kill."</span>
    (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((buffer (generate-new-buffer <span style="color: #b5bd68;">"*copy-here*"</span>)))
      (<span style="color: #CC6666; font-weight: bold;">unwind-protect</span>
          (<span style="color: #CC6666; font-weight: bold;">progn</span>
            (<span style="color: #CC6666; font-weight: bold;">cl-letf</span>
                (((symbol-function 'calc-find-writable-buffer)
                  (<span style="color: #CC6666; font-weight: bold;">lambda</span> (buf mode) buffer)))
              (call-interactively 'calc-copy-to-buffer))
            (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> buffer
              (kill-new (buffer-substring-no-properties (point-min) (point-max))))
            (message <span style="color: #b5bd68;">"Copied the result: %s"</span> (car kill-ring)))
        (<span style="color: #CC6666; font-weight: bold;">and</span> (buffer-name buffer)
             (kill-buffer buffer)))))
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key global-map (kbd <span style="color: #b5bd68;">"C-'"</span>) #'clean-quick-calc)
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-'"</span>) #'clean-quick-calc)

(define-key global-map (kbd <span style="color: #b5bd68;">"C-M-'"</span>) #'calc)
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-M-'"</span>) #'calc)

(define-key global-map (kbd <span style="color: #b5bd68;">"C-M-;"</span>) #'calc-embedded)
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-M-;"</span>) #'calc-embedded)

(add-hook 'calc-mode-hook
          #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
              (evil-local-set-key 'normal (kbd <span style="color: #b5bd68;">"q"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                        (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                        (calc-quit)))))

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal calc-mode-map (kbd <span style="color: #b5bd68;">"q"</span>) #'calc-quit)

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal calc-mode-map (kbd <span style="color: #b5bd68;">"r r"</span>) #'calc-reset)

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal calc-mode-map (kbd <span style="color: #b5bd68;">"i"</span>) nil)

(define-key calc-mode-map (kbd <span style="color: #b5bd68;">"C-c C-y"</span>) #'calc-copy-as-kill-clean)
</pre>
</div>

<p>
Hooks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'calc-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                              (calc-symbolic-mode 1)
                              (calc-frac-mode 1)
                              (calc-radians-mode)

                              (<span style="color: #CC6666; font-weight: bold;">setq-default</span> calc-show-banner nil)
                              (<span style="color: #CC6666; font-weight: bold;">setq-default</span> calc-gnuplot-default-device <span style="color: #b5bd68;">"qt"</span>)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1070d2f" class="outline-3">
<h3 id="org1070d2f">External applications</h3>
<div class="outline-text-3" id="text-org1070d2f">
</div>
<div id="outline-container-org847d585" class="outline-4">
<h4 id="org847d585">Zoom</h4>
<div class="outline-text-4" id="text-org847d585">
<p>
Open Zoom links directly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">follow-zoom-link</span> (link-url)
  <span style="color: #717171; font-style: italic;">"Open zoommtg:// links."</span>
  (shell-command (format <span style="color: #b5bd68;">"open '</span><span style="color: #CC6666;">zoommtg:%s</span><span style="color: #b5bd68;">'"</span> link-url)))


(org-link-set-parameters <span style="color: #b5bd68;">"zoommtg"</span> <span style="color: #81a2be;">:follow</span> #'follow-zoom-link)
</pre>
</div>
</div>
</div>

<div id="outline-container-org39728f1" class="outline-4">
<h4 id="org39728f1">Maxwell</h4>
<div class="outline-text-4" id="text-org39728f1">
<p>
For capturing drawings and diagrams:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">maxwell-create-link</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">if</span> (not (file-exists-p <span style="color: #b5bd68;">"mxl"</span>))
      (make-directory <span style="color: #b5bd68;">"mxl"</span>))
  (<span style="color: #CC6666; font-weight: bold;">let*</span> ((cwd (file-name-directory buffer-file-name))
         (name (make-temp-name <span style="color: #b5bd68;">"diagram_"</span>))
         (image-path (concat cwd (file-name-as-directory <span style="color: #b5bd68;">"mxl"</span>) name <span style="color: #b5bd68;">".png"</span>)))
    (shell-command
     (format
      <span style="color: #b5bd68;">"python -c 'from maxwell import capture_area; capture_area(\"%s\")'"</span>
      image-path))
    (select-frame-set-input-focus (selected-frame))
    (insert (format <span style="color: #b5bd68;">"#+attr_latex: :placement [H] :scale .4\n[[%s]]\n\n"</span> image-path))
    (org-remove-inline-images)))


(define-key org-mode-map (kbd <span style="color: #b5bd68;">"&lt;f7&gt;"</span>) #'maxwell-create-link)
</pre>
</div>

<p>
Prompt for writing Latex.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">define-minor-mode</span> <span style="color: #6CA17A;">maxwell-get-latex-prompt-mode</span>
  <span style="color: #717171; font-style: italic;">"Minor mode to simulate buffer local keybindings."</span>
  <span style="color: #81a2be;">:init-value</span> nil
  <span style="color: #81a2be;">:keymap</span> (make-keymap))


(define-key maxwell-get-latex-prompt-mode-map (kbd <span style="color: #b5bd68;">"C-j"</span>)
            #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                (write-file (expand-file-name <span style="color: #b5bd68;">"~/temp.org"</span>))
                (kill-buffer)
                (delete-frame)
                (shell-command-to-string <span style="color: #b5bd68;">"osascript -e 'activate application \"Electron\"'"</span>)))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">maxwell-get-latex-prompt</span> ()
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((should-center-frame nil))
    (make-frame `((width . 50)
                  (height . 13)
                  (left . ,(- (round (/ (display-pixel-width) 2)) 202))
                  (top . -200)))
    (set-frame-parameter nil 'height 5)
    (set-frame-parameter nil 'top -100))
  (select-frame-set-input-focus (selected-frame))
  (switch-to-buffer <span style="color: #b5bd68;">"*Prompt*"</span>)
  (erase-buffer)
  (org-mode)
  (<span style="color: #CC6666; font-weight: bold;">setq-local</span> olivetti-body-width 40)
  (maxwell-get-latex-prompt-mode)
  (yas-expand-snippet <span style="color: #b5bd68;">"\\\\( $0 \\\\)"</span>)
  (evil-insert-state))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc067a0a" class="outline-3">
<h3 id="orgc067a0a">References</h3>
<div class="outline-text-3" id="text-orgc067a0a">
<p>
Use org-ref for references management.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">org-ref</span>
  <span style="color: #81a2be;">:config</span>

  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">bibtex</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">doi-utils</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">org-ref-pdf</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">org-ref-url-utils</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">org-ref-arxiv</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">org-ref-bibtex</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">org-ref-isbn</span>)

  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> bibtex-autokey-year-length 4
                bibtex-autokey-name-year-separator <span style="color: #b5bd68;">"-"</span>
                bibtex-autokey-year-title-separator <span style="color: #b5bd68;">"-"</span>
                bibtex-autokey-titleword-separator <span style="color: #b5bd68;">"-"</span>
                bibtex-autokey-titlewords 2
                bibtex-autokey-titlewords-stretch 1
                bibtex-autokey-titleword-length 5)

  (<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">bibtex-generate-autokey</span> ()
    (<span style="color: #CC6666; font-weight: bold;">let*</span> ((names (bibtex-autokey-get-names))
           (year (bibtex-autokey-get-year))
           (title (bibtex-autokey-get-title))
           (autokey (concat bibtex-autokey-prefix-string
                            title
                            (<span style="color: #CC6666; font-weight: bold;">unless</span> (<span style="color: #CC6666; font-weight: bold;">or</span> (equal names <span style="color: #b5bd68;">""</span>)
                                        (equal year <span style="color: #b5bd68;">""</span>))
                              bibtex-autokey-name-year-separator)
                            names
                            (<span style="color: #CC6666; font-weight: bold;">unless</span> (<span style="color: #CC6666; font-weight: bold;">or</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (equal names <span style="color: #b5bd68;">""</span>)
                                             (equal year <span style="color: #b5bd68;">""</span>))
                                        (equal title <span style="color: #b5bd68;">""</span>))
                              bibtex-autokey-year-title-separator)
                            year)))
      (<span style="color: #CC6666; font-weight: bold;">if</span> bibtex-autokey-before-presentation-function
          (funcall bibtex-autokey-before-presentation-function autokey)
        autokey)))

  (define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-]"</span>) #'org-ref-insert-link))
</pre>
</div>

<p>
Download papers to current directory and insert BibTeX entry to current
buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">arxiv-local-add-bibtex-entry</span> (arxiv-number)
  <span style="color: #717171; font-style: italic;">"Add bibtex entry for ARXIV-NUMBER to current buffer."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (list (read-string
          <span style="color: #b5bd68;">"arxiv: "</span>
          (arxiv-maybe-arxiv-id-from-current-kill))))
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (goto-char (point-max))
    (<span style="color: #CC6666; font-weight: bold;">when</span> (not (looking-at <span style="color: #b5bd68;">"^"</span>)) (insert <span style="color: #b5bd68;">"\n"</span>))
    (insert (arxiv-get-bibtex-entry-via-arxiv-api arxiv-number))
    (org-ref-clean-bibtex-entry)
    (goto-char (point-max))
    (<span style="color: #CC6666; font-weight: bold;">when</span> (not (looking-at <span style="color: #b5bd68;">"^"</span>)) (insert <span style="color: #b5bd68;">"\n"</span>))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">arxiv-local-get-pdf-add-bibtex-entry</span> (arxiv-number pdfdir)
  <span style="color: #717171; font-style: italic;">"Add bibtex entry for ARXIV-NUMBER to current buffer.</span>
<span style="color: #717171; font-style: italic;">Remove troublesome chars from the bibtex key, retrieve a pdf</span>
<span style="color: #717171; font-style: italic;">for ARXIV-NUMBER and save it to PDFDIR with the same name of the</span>
<span style="color: #717171; font-style: italic;">key."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (list (read-string
          <span style="color: #b5bd68;">"arxiv: "</span>
          (arxiv-maybe-arxiv-id-from-current-kill))
         default-directory))

  (arxiv-local-add-bibtex-entry arxiv-number)

  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (<span style="color: #CC6666; font-weight: bold;">let</span> ((key <span style="color: #b5bd68;">""</span>))
      (goto-char (point-max))
      (bibtex-beginning-of-entry)
      (re-search-forward bibtex-entry-maybe-empty-head)
      (<span style="color: #CC6666; font-weight: bold;">if</span> (match-beginning bibtex-key-in-head)
          (<span style="color: #CC6666; font-weight: bold;">progn</span>
            (<span style="color: #CC6666; font-weight: bold;">setq</span> key (delete-and-extract-region
                       (match-beginning bibtex-key-in-head)
                       (match-end bibtex-key-in-head)))
            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">remove potentially troublesome characters from key</span>
            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">as it will be used as  a filename</span>
            (<span style="color: #CC6666; font-weight: bold;">setq</span> key (replace-regexp-in-string   <span style="color: #b5bd68;">"\"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\*</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">/</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">:</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">&lt;</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">&gt;</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\?</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\\\</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">|</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\+</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">,</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\.</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">;</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">=</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">\\[</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">]</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">!</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">|</span><span style="color: #b5bd68;">@"</span>
                                                  <span style="color: #b5bd68;">""</span> key))
            <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">check if the key is in the buffer</span>
            (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                    (bibtex-search-entry key))
              (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
                (bibtex-search-entry key)
                (bibtex-copy-entry-as-kill)
                (switch-to-buffer-other-window <span style="color: #b5bd68;">"*duplicate entry*"</span>)
                (bibtex-yank))
              (<span style="color: #CC6666; font-weight: bold;">setq</span> key (bibtex-read-key <span style="color: #b5bd68;">"Duplicate Key found, edit: "</span> key))))
        (<span style="color: #CC6666; font-weight: bold;">setq</span> key (bibtex-read-key <span style="color: #b5bd68;">"Key not found, insert: "</span>)))
      (insert key)
      (arxiv-get-pdf arxiv-number (concat pdfdir key <span style="color: #b5bd68;">".pdf"</span>))
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Check that it worked, and insert a field for it.</span>
      (<span style="color: #CC6666; font-weight: bold;">when</span> (file-exists-p (concat pdfdir key <span style="color: #b5bd68;">".pdf"</span>))
        (bibtex-end-of-entry)
        (backward-char)
        (insert (format <span style="color: #b5bd68;">"  file = {%s}\n  "</span> (concat pdfdir key <span style="color: #b5bd68;">".pdf"</span>)))))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">doi-utils-local-async-download-pdf</span> ()
  <span style="color: #717171; font-style: italic;">"Download the PDF for bibtex entry at point asynchronously.</span>
<span style="color: #717171; font-style: italic;">It is not fully async, only the download is. Fully async is</span>
<span style="color: #717171; font-style: italic;">harder because you need to run `</span><span style="color: #CC6666; font-style: italic;">doi-utils-get-pdf-url</span><span style="color: #717171; font-style: italic;">' async</span>
<span style="color: #717171; font-style: italic;">too. "</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">async</span>)
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (bibtex-beginning-of-entry)
    (<span style="color: #CC6666; font-weight: bold;">let</span> (<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">get doi, removing http://dx.doi.org/ if it is there.</span>
          (doi (replace-regexp-in-string
                <span style="color: #b5bd68;">"https?://</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">dx.</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">?.doi.org/"</span> <span style="color: #b5bd68;">""</span>
                (bibtex-autokey-get-field <span style="color: #b5bd68;">"doi"</span>)))
          (key (cdr (assoc <span style="color: #b5bd68;">"=key="</span> (bibtex-parse-entry))))
          (pdf-url)
          (pdf-file))

      (<span style="color: #CC6666; font-weight: bold;">setq</span> pdf-file (concat default-directory key <span style="color: #b5bd68;">".pdf"</span>))

      (<span style="color: #CC6666; font-weight: bold;">unless</span> doi (<span style="color: #f0c674;">error</span> <span style="color: #b5bd68;">"No DOI found to get a pdf for"</span>))

      (<span style="color: #CC6666; font-weight: bold;">when</span> (file-exists-p pdf-file)
        (<span style="color: #f0c674;">error</span> <span style="color: #b5bd68;">"%s already exists. Delete to re-download"</span> pdf-file))

      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">(doi-utils-get-pdf-url "10.1063/1.5019667")</span>
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">If you get here, try getting the pdf file</span>
      (async-start
       `(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
          (<span style="color: #CC6666; font-weight: bold;">setq</span> package-user-dir ,package-user-dir)
          (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">package</span>)
          (package-initialize)
          (<span style="color: #CC6666; font-weight: bold;">setq</span> load-path (list ,@load-path))
          (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">doi-utils</span>)

          (<span style="color: #CC6666; font-weight: bold;">setq</span> pdf-url (doi-utils-get-pdf-url ,doi))
          (<span style="color: #CC6666; font-weight: bold;">when</span> pdf-url
            (url-copy-file pdf-url ,pdf-file t)

            (<span style="color: #CC6666; font-weight: bold;">let*</span> ((header (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
                             (set-buffer-multibyte nil)
                             (insert-file-contents-literally ,pdf-file nil 0 5)
                             (buffer-string)))
                   (valid (<span style="color: #CC6666; font-weight: bold;">and</span> (stringp header)
                               (string-equal (encode-coding-string header 'utf-8) <span style="color: #b5bd68;">"%PDF-"</span>))))
              (<span style="color: #CC6666; font-weight: bold;">if</span> valid
                  (format <span style="color: #b5bd68;">"%s downloaded"</span> ,pdf-file)
                (delete-file ,pdf-file)
                (<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">browse-url</span>)
                (browse-url pdf-url)
                (message <span style="color: #b5bd68;">"Invalid pdf (file deleted). Header = %s"</span> header)))))
       `(<span style="color: #CC6666; font-weight: bold;">lambda</span> (result)
          (message <span style="color: #b5bd68;">"doi-utils-async-download-pdf: %s"</span>  result))))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">doi-utils-local-get-bibtex-entry-pdf</span> (<span style="color: #6CA17A;">&amp;optional</span> arg)
  <span style="color: #717171; font-style: italic;">"Download pdf for entry at point if the pdf does not already exist locally.</span>
<span style="color: #717171; font-style: italic;">The entry must have a doi. The pdf will be saved, by the name</span>
<span style="color: #717171; font-style: italic;">%s.pdf where %s is the bibtex label. Files will not be</span>
<span style="color: #717171; font-style: italic;">overwritten. The pdf will be checked to make sure it is a pdf,</span>
<span style="color: #717171; font-style: italic;">and not some html failure page. You must have permission to</span>
<span style="color: #717171; font-style: italic;">access the pdf. We open the pdf at the end if</span>
<span style="color: #717171; font-style: italic;">`</span><span style="color: #CC6666; font-style: italic;">doi-utils-open-pdf-after-download</span><span style="color: #717171; font-style: italic;">' is non-nil.</span>

<span style="color: #717171; font-style: italic;">With one prefix ARG, directly get the pdf from a file (through</span>
<span style="color: #717171; font-style: italic;">`</span><span style="color: #CC6666; font-style: italic;">read-file-name</span><span style="color: #717171; font-style: italic;">') instead of looking up a DOI. With a double</span>
<span style="color: #717171; font-style: italic;">prefix ARG, directly get the pdf from an open buffer (through</span>
<span style="color: #717171; font-style: italic;">`</span><span style="color: #CC6666; font-style: italic;">read-buffer-to-switch</span><span style="color: #717171; font-style: italic;">') instead. These two alternative methods</span>
<span style="color: #717171; font-style: italic;">work even if the entry has no DOI, and the pdf file is not</span>
<span style="color: #717171; font-style: italic;">checked."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"P"</span>)
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
    (bibtex-beginning-of-entry)
    (<span style="color: #CC6666; font-weight: bold;">let</span> (<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">get doi, removing http://dx.doi.org/ if it is there.</span>
          (doi (replace-regexp-in-string
                <span style="color: #b5bd68;">"https?://</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">dx.</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">?.doi.org/"</span> <span style="color: #b5bd68;">""</span>
                (bibtex-autokey-get-field <span style="color: #b5bd68;">"doi"</span>)))
          (key (cdr (assoc <span style="color: #b5bd68;">"=key="</span> (bibtex-parse-entry))))
          (pdf-url)
          (pdf-file))

      (<span style="color: #CC6666; font-weight: bold;">setq</span> pdf-file (concat default-directory key <span style="color: #b5bd68;">".pdf"</span>))
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">now get file if needed.</span>
      (<span style="color: #CC6666; font-weight: bold;">unless</span> (file-exists-p pdf-file)
    (<span style="color: #CC6666; font-weight: bold;">cond</span>
     ((<span style="color: #CC6666; font-weight: bold;">and</span> (not arg)
           doi
           (<span style="color: #CC6666; font-weight: bold;">setq</span> pdf-url (doi-utils-get-pdf-url doi)))
      (url-copy-file pdf-url pdf-file)
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">now check if we got a pdf</span>
          (<span style="color: #CC6666; font-weight: bold;">if</span> (org-ref-pdf-p pdf-file)
              (message <span style="color: #b5bd68;">"%s saved"</span> pdf-file)
            (delete-file pdf-file)
            (message <span style="color: #b5bd68;">"No pdf was downloaded."</span>)
            (browse-url pdf-url)))
     ((equal arg '(4))
      (copy-file (expand-file-name (read-file-name <span style="color: #b5bd68;">"Pdf file: "</span> nil nil t))
             pdf-file))
     ((equal arg '(16))
      (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> (read-buffer-to-switch <span style="color: #b5bd68;">"Pdf buffer: "</span>)
        (write-file pdf-file)))
     (t
      (message <span style="color: #b5bd68;">"We don't have a recipe for this journal."</span>)))

    (<span style="color: #CC6666; font-weight: bold;">when</span> (file-exists-p pdf-file)
      (bibtex-set-field <span style="color: #b5bd68;">"file"</span> pdf-file))

    (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span> doi-utils-open-pdf-after-download (file-exists-p pdf-file))
      (org-open-file pdf-file))))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">doi-utils-add-bibtex-entry-from-doi</span> (doi)
  <span style="color: #717171; font-style: italic;">"Add DOI entry to end of a file in the current directory.</span>
<span style="color: #717171; font-style: italic;">Pick the file ending with .bib or in .  If you have an active region that</span>
<span style="color: #717171; font-style: italic;">starts like a DOI, that will be the initial prompt.  If no region</span>
<span style="color: #717171; font-style: italic;">is selected and the first entry of the &#8216;</span><span style="color: #CC6666; font-style: italic;">kill-ring</span><span style="color: #717171; font-style: italic;">&#8217; starts like a</span>
<span style="color: #717171; font-style: italic;">DOI, then that is the intial prompt.  Otherwise, you have to type</span>
<span style="color: #717171; font-style: italic;">or paste in a DOI.</span>
<span style="color: #717171; font-style: italic;">Argument BIBFILE the bibliography to use."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (list (read-string
          <span style="color: #b5bd68;">"DOI: "</span>
          <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">now set initial input</span>
          (doi-utils-maybe-doi-from-region-or-current-kill))))

  
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Wrap in save-window-excursion to restore your window arrangement after this</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">is done.</span>
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Check if the doi already exists</span>
      (goto-char (point-min))
      (<span style="color: #CC6666; font-weight: bold;">if</span> (re-search-forward (concat doi <span style="color: #b5bd68;">"\\_&gt;"</span>) nil t)
          (message <span style="color: #b5bd68;">"%s is already in this file"</span> doi)
        (goto-char (point-max))

    (<span style="color: #CC6666; font-weight: bold;">when</span> (not (looking-back <span style="color: #b5bd68;">"\n\n"</span> (min 3 (point))))
      (insert <span style="color: #b5bd68;">"\n\n"</span>))

        (doi-utils-insert-bibtex-entry-from-doi doi))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">doi-utils-local-add-bibtex-entry-from-doi</span> (doi)
  <span style="color: #717171; font-style: italic;">"Add DOI entry to end of a file in the current directory.</span>
<span style="color: #717171; font-style: italic;">Pick the file ending with .bib or in .  If you have an active region that</span>
<span style="color: #717171; font-style: italic;">starts like a DOI, that will be the initial prompt.  If no region</span>
<span style="color: #717171; font-style: italic;">is selected and the first entry of the &#8216;</span><span style="color: #CC6666; font-style: italic;">kill-ring</span><span style="color: #717171; font-style: italic;">&#8217; starts like a</span>
<span style="color: #717171; font-style: italic;">DOI, then that is the intial prompt.  Otherwise, you have to type</span>
<span style="color: #717171; font-style: italic;">or paste in a DOI.</span>
<span style="color: #717171; font-style: italic;">Argument BIBFILE the bibliography to use."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (list (read-string
          <span style="color: #b5bd68;">"DOI: "</span>
          <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">now set initial input</span>
          (doi-utils-maybe-doi-from-region-or-current-kill))))

  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Wrap in save-window-excursion to restore your window arrangement after this</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">is done.</span>
  (<span style="color: #CC6666; font-weight: bold;">save-excursion</span>
      <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Check if the doi already exists</span>
      (goto-char (point-min))
      (<span style="color: #CC6666; font-weight: bold;">if</span> (re-search-forward (concat doi <span style="color: #b5bd68;">"\\_&gt;"</span>) nil t)
          (message <span style="color: #b5bd68;">"%s is already in this file"</span> doi)
        (goto-char (point-max))

    (<span style="color: #CC6666; font-weight: bold;">when</span> (not (looking-back <span style="color: #b5bd68;">"\n\n"</span> (min 3 (point))))
      (insert <span style="color: #b5bd68;">"\n\n"</span>))

        (doi-utils-insert-bibtex-entry-from-doi doi))))


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">orcb-local-download-pdf</span> ()
  <span style="color: #717171; font-style: italic;">"Try to get the pdf in an entry."</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">try to get pdf</span>
  (<span style="color: #CC6666; font-weight: bold;">when</span> doi-utils-download-pdf
    (<span style="color: #CC6666; font-weight: bold;">if</span> doi-utils-async-download
        (doi-utils-local-async-download-pdf)
      (doi-utils-local-get-bibtex-entry-pdf))))


(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-ref-clean-bibtex-entry-hook '(org-ref-bibtex-format-url-if-doi
                                                orcb-key-comma
                                                org-ref-replace-nonascii
                                                orcb-&amp;
                                                orcb-%
                                                org-ref-title-case-article
                                                orcb-clean-year
                                                orcb-key
                                                orcb-clean-doi
                                                orcb-clean-pages
                                                orcb-check-journal
                                                org-ref-sort-bibtex-entry
                                                orcb-fix-spacing
                                                orcb-local-download-pdf))
</pre>
</div>

<p>
Format citation candidates properly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-ref-read-key</span> ()
  <span style="color: #717171; font-style: italic;">"Read a key with completion."</span>
  (<span style="color: #CC6666; font-weight: bold;">unless</span> bibtex-completion-display-formats-internal
    (bibtex-completion-init))
  (<span style="color: #CC6666; font-weight: bold;">let*</span> ((bibtex-completion-bibliography (org-ref-find-bibliography))
     (candidates (mapcar (<span style="color: #CC6666; font-weight: bold;">lambda</span> (entry)
                   (cons (bibtex-completion-format-entry entry (- (frame-width) 4))
                     (cdr entry)))
                 (bibtex-completion-candidates)))
     (choice (completing-read <span style="color: #b5bd68;">"org-ref BibTeX entries: "</span> candidates)))
    (cdr (assoc <span style="color: #b5bd68;">"=key="</span> (assoc choice candidates)))))
</pre>
</div>

<p>
BibTeX key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'insert bibtex-mode-map (kbd <span style="color: #b5bd68;">"C-]"</span>) #'doi-utils-add-bibtex-entry-from-doi)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal bibtex-mode-map (kbd <span style="color: #b5bd68;">"C-]"</span>) #'doi-utils-add-bibtex-entry-from-doi)

(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'insert bibtex-mode-map (kbd <span style="color: #b5bd68;">"C-M-]"</span>) #'arxiv-local-get-pdf-add-bibtex-entry)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal bibtex-mode-map (kbd <span style="color: #b5bd68;">"C-M-]"</span>) #'arxiv-local-get-pdf-add-bibtex-entry)
</pre>
</div>
</div>
</div>

<div id="outline-container-org92d7cff" class="outline-3">
<h3 id="org92d7cff">Export</h3>
<div class="outline-text-3" id="text-org92d7cff">
<p>
Latex export options.
</p>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,12pt]{article}

\\usepackage[doublespacing]{setspace}
\\usepackage[margin=1in]{geometry}
\\usepackage{csquotes}
\\usepackage{amsmath}
\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage[style=apa,backend=biber]{biblatex}
\\usepackage[small]{titlesec}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,man]{apa6}

\\usepackage{csquotes}
\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage[style=apa,backend=biber]{biblatex}

\\renewcommand*{\\finalnamedelim}{ \\ifnumgreater{\\value{liststop}}{2}{\\finalandomma}{} \\addspace\\&amp;\\space}

\\usepackage[skip=0pt]{parskip}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,12pt,oneside]{book}
\\usepackage[margin=1in]{geometry}
\\usepackage{csquotes}
\\usepackage{amsmath}
\\usepackage{amssymb}
\\usepackage{gensymb}
\\usepackage{siunitx}
\\usepackage{float}
\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage{fancyhdr}
\\usepackage{xhfill}
\\usepackage[svgnames]{xcolor}
\\usepackage[explicit]{titlesec}
\\usepackage[defaultsans,scale=1]{opensans}
\\usepackage[T1]{fontenc}
\\usepackage{anyfontsize}
\\usepackage[many]{tcolorbox}
\\usepackage{amsthm}
\\usepackage{tikz}
\\usepackage{microtype}
\\usepackage{adjustbox}

\\definecolor{title-foreground}{RGB}{230,230,230}
\\definecolor{subtitle-foreground}{RGB}{120,120,120}
\\definecolor{chapter-foreground}{RGB}{80,80,80}

\\definecolor{theorem-background}{RGB}{0,53,110}
\\definecolor{definition-background}{RGB}{0,87,153}
\\definecolor{example-background}{RGB}{86,152,179}
\\definecolor{note-background}{RGB}{0,53,110}

\\colorlet{rulecolor}{Gainsboro!40!Lavender}
\\titleformat{\\chapter}[display]
{\\filcenter}{\\mbox{}\\xrfill[0.4ex]{3pt}[rulecolor]\\textsc{\\large\\enspace\\chaptername~\\thechapter}\\enspace\\xrfill[0.4ex]{3pt}[rulecolor]\\mbox{}}{0.3ex}
{{\\color{rulecolor}\\titlerule[1pt]}\\vskip3ex\\huge\\sffamily\\color{chapter-foreground}#1}[\\vskip1.2ex{\\color{rulecolor}\\titlerule[1pt]}]

\\titleformat{\\section}{\\sffamily\\large}{\\thesection.}{.5em}{#1}
\\titleformat{\\subsection}{\\sffamily\\large}{\\thesubsection.}{.5em}{#1}

\\tcbuselibrary{theorems}

\\newtcbtheorem[number within=chapter]{old-theorem}{Theorem}{
  breakable,
  colback=theorem-background!10,
  colframe=theorem-background!55!black,
  fonttitle=\\bfseries\\sffamily}{th}

\\newtcbtheorem[number within=chapter]{old-exmp}{Example}{
  breakable,
  colback=example-background!10,
  colframe=example-background!55!black,
  fonttitle=\\bfseries\\sffamily}{ex}

\\newtcbtheorem[number within=chapter]{old-definition}{Definition}{
  breakable,
  colback=definition-background!10,
  colframe=definition-background!65!black,
  fonttitle=\\bfseries\\sffamily}{def}

\\newtcolorbox{note}[1][]{
  enhanced jigsaw,
  borderline west={2pt}{0pt}{note-background},
  sharp corners,
  boxrule=0pt,
  fonttitle={\\bfseries\\sffamily},
  coltitle={black},
  title={Note:\\ },
  attach title to upper,
  #1
}

\\renewenvironment{theorem}[1][]{%
  \\begin{old-theorem}{#1}{}%
    
}{%
  \\end{old-theorem}%
}

\\renewenvironment{exmp}{%
  \\begin{old-exmp}{}{}%
    
}{%
  \\end{old-exmp}%
}

\\renewenvironment{definition}{%
  \\begin{old-definition}{}{}%
    
}{%
  \\end{old-definition}%
}

\\newtheorem{exercise}{Exercise}
\\numberwithin{exercise}{chapter}
\\newtheorem{lemma}{Lemma}[theorem]
\\numberwithin{lemma}{chapter}
\\newtheorem{corollary}{Corollary}[theorem]
\\numberwithin{corollary}{chapter}

\\setlength{\\parskip}{.5em}
\\setlength{\\parindent}{0pt}

\\pagestyle{fancy}
\\fancyhf{}
\\renewcommand{\\chaptermark}[1]{\\markboth{#1}{}}
\\renewcommand{\\sectionmark}[1]{\\markright{SECTION \\thesection. \\uppercase{#1}}}
\\let\\oldtitle\\title
\\renewcommand{\\title}[1]{\\oldtitle{#1}\\def\\titletext{#1}}
\\fancyhead[L]{\\leftmark}
\\fancyhead[R]{\\titletext}
\\fancyfoot[C]{\\rightmark}
\\fancyfoot[R]{\\thepage}

\\newcommand*{\\textinrule}[3][]{%
  \\makebox[#2]{#1%
    \\leaders\\hrule height \\dimexpr.5ex+.2pt\\relax depth \\dimexpr -.5ex+.2pt\\relax \\hfill% Left rule
    \\enskip{#3}\\enskip% Text (and surrounding spaces)
    \\leaders\\hrule height \\dimexpr.5ex+.2pt\\relax depth \\dimexpr -.5ex+.2pt\\relax \\hfill\\kern0pt}% Right rule
}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,12pt,oneside]{book}
\\usepackage[margin=1in]{geometry}
\\usepackage{csquotes}
\\usepackage{amsmath}
\\usepackage{amssymb}
\\usepackage{gensymb}
\\usepackage{siunitx}

\\usepackage{float}

\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage{fancyhdr}
\\usepackage[explicit]{titlesec}

\\titleformat{\\chapter}{\\normalfont\\huge}{#1}{}{}
\\titleformat{\\section}{\\normalfont\\large}{}{.5em}{#1}
\\titleformat{\\subsection}{\\normalfont\\large}{}{.5em}{\\textit{#1}}

\\titlespacing{\\chapter}{0pt}{0pt}{1em}

\\usepackage{amsthm}
\\setlength{\\parskip}{.5em}
\\setlength{\\parindent}{0pt}
\\newtheoremstyle{boxed}{8pt}{8pt}{}{}{\\upshape\\bfseries}{.}{.5em}{}
\\theoremstyle{boxed}
\\newtheorem{theorem}{Theorem}
\\numberwithin{theorem}{chapter}
\\newtheorem{note}{Note}
\\numberwithin{note}{chapter}
\\newtheorem{exmp}{Example}
\\numberwithin{exmp}{chapter}
\\newtheorem{corollary}{Corollary}
\\numberwithin{corollary}{chapter}
\\newtheorem{exercise}{Exercise}
\\numberwithin{exercise}{chapter}
\\newtheorem{definition}{Definition}
\\numberwithin{definition}{chapter}
\\newtheorem{lemma}{Lemma}[theorem]
\\numberwithin{lemma}{chapter}
\\usepackage{mdframed}
\\BeforeBeginEnvironment{theorem}{\\begin{mdframed}}
\\AfterEndEnvironment{theorem}{\\end{mdframed}}
\\BeforeBeginEnvironment{corollary}{\\begin{mdframed}}
\\AfterEndEnvironment{corollary}{\\end{mdframed}}
\\BeforeBeginEnvironment{exmp}{\\begin{mdframed}}
\\AfterEndEnvironment{exmp}{\\end{mdframed}}
\\BeforeBeginEnvironment{exercise}{\\begin{mdframed}}
\\AfterEndEnvironment{exercise}{\\end{mdframed}}
\\BeforeBeginEnvironment{definition}{\\begin{mdframed}}
\\AfterEndEnvironment{definition}{\\end{mdframed}}
\\pagestyle{fancy}
\\fancyhf{}

\\renewcommand{\\chaptermark}[1]{\\markboth{#1}{}}

\\let\\oldtitle\\title
\\renewcommand{\\title}[1]{\\oldtitle{#1}\\def\\titletext{#1}}
\\fancyhead[L]{\\leftmark}
\\fancyhead[R]{\\titletext}
\\fancyfoot[R]{\\thepage}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq</span> org-latex-default-packages-alist '())


(add-to-list 'org-latex-classes
             `(<span style="color: #b5bd68;">"assignment"</span>
               <span style="color: #b5bd68;">"</span>
<span style="color: #b5bd68;">&lt;&lt;org-latex-assignment-class&gt;&gt;"</span>
               (<span style="color: #b5bd68;">"\\section{%s}"</span> . <span style="color: #b5bd68;">"\\section*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsection{%s}"</span> . <span style="color: #b5bd68;">"\\subsection*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsubsection{%s}"</span> . <span style="color: #b5bd68;">"\\subsubsection*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\paragraph{%s}"</span> . <span style="color: #b5bd68;">"\\paragraph*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subparagraph{%s}"</span> . <span style="color: #b5bd68;">"\\subparagraph*{%s}"</span>)))


(add-to-list 'org-latex-classes
             '(<span style="color: #b5bd68;">"apa6"</span>
               <span style="color: #b5bd68;">"</span>
<span style="color: #b5bd68;">&lt;&lt;org-latex-apa6-class&gt;&gt;"</span>
               (<span style="color: #b5bd68;">"\\section{%s}"</span> . <span style="color: #b5bd68;">"\\section*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsection{%s}"</span> . <span style="color: #b5bd68;">"\\subsection*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsubsection{%s}"</span> . <span style="color: #b5bd68;">"\\subsubsection*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\paragraph{%s}"</span> . <span style="color: #b5bd68;">"\\paragraph*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subparagraph{%s}"</span> . <span style="color: #b5bd68;">"\\subparagraph*{%s}"</span>)))


(add-to-list 'org-latex-classes
             '(<span style="color: #b5bd68;">"math-document"</span>
               <span style="color: #b5bd68;">"</span>
<span style="color: #b5bd68;">&lt;&lt;org-latex-math-document-class&gt;&gt;"</span>
               (<span style="color: #b5bd68;">"\\chapter{%s}"</span> . <span style="color: #b5bd68;">"\\chapter{%s}"</span>)
               (<span style="color: #b5bd68;">"\\section{%s}"</span> . <span style="color: #b5bd68;">"\\section{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsection{%s}"</span> . <span style="color: #b5bd68;">"\\subsection{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsubsection{%s}"</span> . <span style="color: #b5bd68;">"\\subsubsection{%s}"</span>)
               (<span style="color: #b5bd68;">"\\paragraph{%s}"</span> . <span style="color: #b5bd68;">"\\paragraph{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subparagraph{%s}"</span> . <span style="color: #b5bd68;">"\\subparagraph{%s}"</span>)))


(add-to-list 'org-latex-classes
             '(<span style="color: #b5bd68;">"math-homework"</span>
               <span style="color: #b5bd68;">"</span>
<span style="color: #b5bd68;">&lt;&lt;org-latex-math-homework-class&gt;&gt;"</span>
               (<span style="color: #b5bd68;">"\\chapter{%s}"</span> . <span style="color: #b5bd68;">"\\chapter{%s}"</span>)
               (<span style="color: #b5bd68;">"\\section*{%s}"</span> . <span style="color: #b5bd68;">"\\section*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsection*{%s}"</span> . <span style="color: #b5bd68;">"\\subsection*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subsubsection*{%s}"</span> . <span style="color: #b5bd68;">"\\subsubsection*{%s}"</span>)
               (<span style="color: #b5bd68;">"\\paragraph{%s}"</span> . <span style="color: #b5bd68;">"\\paragraph{%s}"</span>)
               (<span style="color: #b5bd68;">"\\subparagraph{%s}"</span> . <span style="color: #b5bd68;">"\\subparagraph{%s}"</span>)))
</pre>
</div>


<p>
Custom export functions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">export-and-open-html</span> ()
  <span style="color: #717171; font-style: italic;">"Export \"org-mode\" file to HTML and open it."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (shell-command (format <span style="color: #b5bd68;">"open -a Vivaldi '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">'"</span> (org-html-export-to-html))))


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">org-pdf-through-latex</span> t
  <span style="color: #717171; font-style: italic;">"Export \"org-mode\" file to latex before converting to PDF. Otherwise, convert to HTML first."</span>)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">export-and-open-pdf</span> (separate-window)
  <span style="color: #717171; font-style: italic;">"Export \"org-mode\" file to PDF, then preview."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((output-path (format <span style="color: #b5bd68;">"%s.pdf"</span> (file-name-sans-extension (buffer-file-name)))))
    (<span style="color: #CC6666; font-weight: bold;">if</span> org-pdf-through-latex
        (shell-command-to-string
         (format
          <span style="color: #b5bd68;">"latexmk -pdf -jobname=temp -f %s; rm *.aux *.fls *.log *.out *.fdb_latexmk; mv temp.pdf '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">'"</span>
          (org-latex-export-to-latex)
          output-path))
      (shell-command-to-string (format
                                <span style="color: #b5bd68;">"wkhtmltopdf --disable-smart-shrinking %s %s"</span>
                                (org-html-export-to-html) output-path)))
    (<span style="color: #CC6666; font-weight: bold;">if</span> separate-window
        (find-file-other-window output-path)
      (find-file output-path))))


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">org-pdf-export-running</span> nil)
(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">org-pdf-export-has-queue</span> nil)


(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-export-pdf-update</span> ()
  <span style="color: #717171; font-style: italic;">"Export \"org-mode\" file to PDF in background."</span>
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)

  (<span style="color: #CC6666; font-weight: bold;">if</span> org-pdf-export-running
      (<span style="color: #CC6666; font-weight: bold;">setq</span> org-pdf-export-has-queue t)
    (<span style="color: #CC6666; font-weight: bold;">setq</span> org-pdf-export-running t)
    (<span style="color: #CC6666; font-weight: bold;">let*</span> ((output-path (format <span style="color: #b5bd68;">"%s.pdf"</span> (file-name-sans-extension (buffer-file-name))))
           (output-buffer (generate-new-buffer <span style="color: #b5bd68;">"*Async shell command*"</span>))
           (inhibit-message t)
           (proc (<span style="color: #CC6666; font-weight: bold;">save-window-excursion</span>
                   (async-shell-command
                    (format
                     <span style="color: #b5bd68;">"latexmk -pdf -jobname=temp -f %s; rm *.aux *.fls *.log *.out *.fdb_latexmk; mv temp.pdf '</span><span style="color: #CC6666;">%s</span><span style="color: #b5bd68;">'"</span>
                     (org-latex-export-to-latex)
                     output-path)
                    output-buffer)
                   (get-buffer-process output-buffer))))
      (<span style="color: #CC6666; font-weight: bold;">if</span> (process-live-p proc)
          (set-process-sentinel proc #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> (process signal)
                                         (<span style="color: #CC6666; font-weight: bold;">when</span> (memq (process-status process) '(exit signal))
                                           (<span style="color: #CC6666; font-weight: bold;">setq</span> org-pdf-export-running nil)
                                           (kill-buffer <span style="color: #b5bd68;">"*Async shell command*"</span>)
                                           (shell-command-sentinel process signal)

                                           (<span style="color: #CC6666; font-weight: bold;">when</span> org-pdf-export-has-queue
                                             (<span style="color: #CC6666; font-weight: bold;">setq</span> org-pdf-export-has-queue nil)
                                             (org-export-pdf-update)))))))))
</pre>
</div>

<p>
Change HTML export content template.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-html-template</span> (contents info)
  <span style="color: #717171; font-style: italic;">"Return complete document string after HTML conversion.</span>
<span style="color: #717171; font-style: italic;">CONTENTS is the transcoded contents string.  INFO is a plist</span>
<span style="color: #717171; font-style: italic;">holding export options."</span>
  (concat
   (<span style="color: #CC6666; font-weight: bold;">when</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (not (org-html-html5-p info)) (org-html-xhtml-p info))
     (<span style="color: #CC6666; font-weight: bold;">let*</span> ((xml-declaration (plist-get info <span style="color: #81a2be;">:html-xml-declaration</span>))
        (decl (<span style="color: #CC6666; font-weight: bold;">or</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (stringp xml-declaration) xml-declaration)
              (cdr (assoc (plist-get info <span style="color: #81a2be;">:html-extension</span>)
                  xml-declaration))
              (cdr (assoc <span style="color: #b5bd68;">"html"</span> xml-declaration))
              <span style="color: #b5bd68;">""</span>)))
       (<span style="color: #CC6666; font-weight: bold;">when</span> (not (<span style="color: #CC6666; font-weight: bold;">or</span> (not decl) (string= <span style="color: #b5bd68;">""</span> decl)))
     (format <span style="color: #b5bd68;">"%s\n"</span>
         (format decl
             (<span style="color: #CC6666; font-weight: bold;">or</span> (<span style="color: #CC6666; font-weight: bold;">and</span> org-html-coding-system
                  (fboundp 'coding-system-get)
                  (coding-system-get org-html-coding-system 'mime-charset))
                 <span style="color: #b5bd68;">"iso-8859-1"</span>))))))
   (org-html-doctype info)
   <span style="color: #b5bd68;">"\n"</span>
   (concat <span style="color: #b5bd68;">"&lt;html"</span>
       (<span style="color: #CC6666; font-weight: bold;">cond</span> ((org-html-xhtml-p info)
          (format
           <span style="color: #b5bd68;">" xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"%s\" xml:lang=\"%s\""</span>
           (plist-get info <span style="color: #81a2be;">:language</span>) (plist-get info <span style="color: #81a2be;">:language</span>)))
         ((org-html-html5-p info)
          (format <span style="color: #b5bd68;">" lang=\"%s\""</span> (plist-get info <span style="color: #81a2be;">:language</span>))))
       <span style="color: #b5bd68;">"&gt;\n"</span>)
   <span style="color: #b5bd68;">"&lt;head&gt;\n"</span>
   (org-html--build-meta-info info)
   (org-html--build-head info)
   (org-html--build-mathjax-config info)
   <span style="color: #b5bd68;">"&lt;/head&gt;\n"</span>
   <span style="color: #b5bd68;">"&lt;body&gt;\n"</span>
   (<span style="color: #CC6666; font-weight: bold;">let</span> ((link-up (org-trim (plist-get info <span style="color: #81a2be;">:html-link-up</span>)))
     (link-home (org-trim (plist-get info <span style="color: #81a2be;">:html-link-home</span>))))
     (<span style="color: #CC6666; font-weight: bold;">unless</span> (<span style="color: #CC6666; font-weight: bold;">and</span> (string= link-up <span style="color: #b5bd68;">""</span>) (string= link-home <span style="color: #b5bd68;">""</span>))
       (format (plist-get info <span style="color: #81a2be;">:html-home/up-format</span>)
           (<span style="color: #CC6666; font-weight: bold;">or</span> link-up link-home)
           (<span style="color: #CC6666; font-weight: bold;">or</span> link-home link-up))))
   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Preamble.</span>
   (org-html--build-pre/postamble 'preamble info)
   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Document title.</span>
   (<span style="color: #CC6666; font-weight: bold;">when</span> (plist-get info <span style="color: #81a2be;">:with-title</span>)
     (<span style="color: #CC6666; font-weight: bold;">let</span> ((title (<span style="color: #CC6666; font-weight: bold;">and</span> (plist-get info <span style="color: #81a2be;">:with-title</span>)
               (plist-get info <span style="color: #81a2be;">:title</span>)))
       (subtitle (plist-get info <span style="color: #81a2be;">:subtitle</span>))
       (html5-fancy (org-html--html5-fancy-p info)))
       (<span style="color: #CC6666; font-weight: bold;">when</span> title
     (format
      (<span style="color: #CC6666; font-weight: bold;">if</span> html5-fancy
          <span style="color: #b5bd68;">"&lt;header&gt;\n&lt;h1 class=\"title\"&gt;%s&lt;/h1&gt;\n%s&lt;/header&gt;"</span>
        <span style="color: #b5bd68;">"&lt;h1 class=\"title\"&gt;%s%s&lt;/h1&gt;\n"</span>)
      (org-export-data title info)
      (<span style="color: #CC6666; font-weight: bold;">if</span> subtitle
          (format
           (<span style="color: #CC6666; font-weight: bold;">if</span> html5-fancy
           <span style="color: #b5bd68;">"&lt;p class=\"subtitle\" role=\"doc-subtitle\"&gt;%s&lt;/p&gt;\n"</span>
         (concat <span style="color: #b5bd68;">"\n"</span> (org-html-close-tag <span style="color: #b5bd68;">"br"</span> nil info) <span style="color: #b5bd68;">"\n"</span>
             <span style="color: #b5bd68;">"&lt;span class=\"subtitle\"&gt;%s&lt;/span&gt;\n"</span>))
           (org-export-data subtitle info))
        <span style="color: #b5bd68;">""</span>)))))
   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Document contents.</span>
   (<span style="color: #CC6666; font-weight: bold;">let</span> ((div (assq 'content (plist-get info <span style="color: #81a2be;">:html-divs</span>))))
     (format <span style="color: #b5bd68;">"&lt;%s id=\"%s\" class=\"%s\"&gt;\n"</span>
             (nth 1 div)
             (nth 2 div)
             (plist-get info <span style="color: #81a2be;">:html-content-class</span>)))
   contents
   (format <span style="color: #b5bd68;">"&lt;/%s&gt;\n"</span> (nth 1 (assq 'content (plist-get info <span style="color: #81a2be;">:html-divs</span>))))
   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Postamble.</span>
   (org-html--build-pre/postamble 'postamble info)
   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Possibly use the Klipse library live code blocks.</span>
   (<span style="color: #CC6666; font-weight: bold;">when</span> (plist-get info <span style="color: #81a2be;">:html-klipsify-src</span>)
     (concat <span style="color: #b5bd68;">"&lt;script&gt;"</span> (plist-get info <span style="color: #81a2be;">:html-klipse-selection-script</span>)
         <span style="color: #b5bd68;">"&lt;/script&gt;&lt;script src=\""</span>
         org-html-klipse-js
         <span style="color: #b5bd68;">"\"&gt;&lt;/script&gt;&lt;link rel=\"stylesheet\" type=\"text/css\" href=\""</span>
         org-html-klipse-css <span style="color: #b5bd68;">"\"/&gt;"</span>))
   <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">Closing document.</span>
   <span style="color: #b5bd68;">"&lt;/body&gt;\n&lt;/html&gt;"</span>))
</pre>
</div>

<p>
Add head to org mode HTML export.
</p>

<div class="org-src-container">
<pre class="src src-javascript">document.addEventListener(<span style="color: #b5bd68;">'DOMContentLoaded'</span>, () =&gt; {
    document.querySelectorAll(<span style="color: #b5bd68;">'table.currency td.org-right'</span>).forEach(elem =&gt; {
        <span style="color: #CC6666; font-weight: bold;">const</span> <span style="color: #E0DBA9;">text</span> = elem.innerText;
        <span style="color: #CC6666; font-weight: bold;">if</span> (!isNaN(text)) {
            <span style="color: #CC6666; font-weight: bold;">let</span> <span style="color: #E0DBA9;">num</span> = (Math.round(parseFloat(text) * 100) / 100).toFixed(2);
            elem.innerText = <span style="color: #b5bd68;">'$'</span> + num.toString().replace(<span style="color: #b5bd68;">/\\B(?=(\\d{3})+(?!\\d))/</span>g, <span style="color: #b5bd68;">','</span>);
        }
    });
});
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">org-html-custom-css-path</span> (concat emacs-configuration-directory <span style="color: #b5bd68;">"org_style.css"</span>)
  <span style="color: #717171; font-style: italic;">"Path to default custom css."</span>)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">org-mode custom HTML head export</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-html-export-head-hook</span> (exporter)
  <span style="color: #717171; font-style: italic;">"Insert custom inline head."</span>
  (<span style="color: #CC6666; font-weight: bold;">when</span> (eq exporter 'html)
    (<span style="color: #CC6666; font-weight: bold;">let*</span> ((dir (<span style="color: #CC6666; font-weight: bold;">ignore-errors</span> (file-name-directory (buffer-file-name))))
           (path (concat dir <span style="color: #b5bd68;">"style.css"</span>))
           (homestyle (<span style="color: #CC6666; font-weight: bold;">or</span> (null dir) (null (file-exists-p path))))
           (final (<span style="color: #CC6666; font-weight: bold;">if</span> homestyle org-html-custom-css-path path)))
      (<span style="color: #CC6666; font-weight: bold;">setq</span> org-html-head-include-default-style nil)
      (<span style="color: #CC6666; font-weight: bold;">setq</span> org-html-head (concat
                           <span style="color: #b5bd68;">"&lt;style type=\"text/css\"&gt;\n"</span>
                           <span style="color: #b5bd68;">"&lt;!--/*--&gt;&lt;![CDATA[/*&gt;&lt;!--*/\n"</span>
                           (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
                             (insert-file-contents final)
                             (buffer-string))
                           <span style="color: #b5bd68;">"/*]]&gt;*/--&gt;\n"</span>
                           <span style="color: #b5bd68;">"&lt;/style&gt;\n"</span>
                           <span style="color: #b5bd68;">"\n"</span>
                           <span style="color: #b5bd68;">"&lt;script&gt;</span>
<span style="color: #b5bd68;">&lt;&lt;org-html-export-head-script&gt;&gt;</span>
<span style="color: #b5bd68;">&lt;/script&gt;"</span>)))))


(add-hook 'org-export-before-processing-hook #'org-html-export-head-hook)


(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-html-mathjax-template
              <span style="color: #b5bd68;">"&lt;script type=\"text/x-mathjax-config\"&gt;</span>
<span style="color: #b5bd68;">    MathJax.Ajax.config.path[\"mhchem\"] = \"https://cdnjs.cloudflare.com/ajax/libs/mathjax-mhchem/3.3.2\";</span>
<span style="color: #b5bd68;">    MathJax.Hub.Config({</span>
<span style="color: #b5bd68;">        displayAlign: \"%ALIGN\",</span>
<span style="color: #b5bd68;">        displayIndent: \"%INDENT\",</span>

<span style="color: #b5bd68;">        \"HTML-CSS\": { scale: %SCALE,</span>
<span style="color: #b5bd68;">                        linebreaks: { automatic: \"%LINEBREAKS\" },</span>
<span style="color: #b5bd68;">                        fonts: [\"%FONT\"]</span>
<span style="color: #b5bd68;">                       },</span>
<span style="color: #b5bd68;">        SVG: {scale: %SCALE,</span>
<span style="color: #b5bd68;">              linebreaks: { automatic: \"%LINEBREAKS\" },</span>
<span style="color: #b5bd68;">              font: \"%FONT\"},</span>
<span style="color: #b5bd68;">        NativeMML: {scale: %SCALE},</span>
<span style="color: #b5bd68;">        TeX: { equationNumbers: {autoNumber: \"%AUTONUMBER\"},</span>
<span style="color: #b5bd68;">               MultLineWidth: \"%MULTLINEWIDTH\",</span>
<span style="color: #b5bd68;">               TagSide: \"%TAGSIDE\",</span>
<span style="color: #b5bd68;">               TagIndent: \"%TAGINDENT\",</span>
<span style="color: #b5bd68;">               extensions: [\"[mhchem]/mhchem.js\"]</span>
<span style="color: #b5bd68;">             },</span>
<span style="color: #b5bd68;">    });</span>
<span style="color: #b5bd68;">&lt;/script&gt;</span>
<span style="color: #b5bd68;">&lt;script src=\"%PATH\"&gt;&lt;/script&gt;"</span>)
</pre>
</div>

<p>
Color quote in org mode and export to HTML (English class).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">export-colored</span> (num simple-separatorp)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>
   (list
    (read-number <span style="color: #b5bd68;">"How many people? "</span>)
    (y-or-n-p <span style="color: #b5bd68;">"Use simple separators? "</span>)))
  (<span style="color: #CC6666; font-weight: bold;">if</span> (equal major-mode 'org-mode)
      (<span style="color: #CC6666; font-weight: bold;">progn</span>
        (shell-command (format <span style="color: #b5bd68;">"~/tcolor %s %s %s"</span> (buffer-file-name) num simple-separatorp))
        (<span style="color: #CC6666; font-weight: bold;">let</span> ((old-buffer-path (buffer-file-name)))
          (<span style="color: #CC6666; font-weight: bold;">with-current-buffer</span> (find-file-noselect (<span style="color: #CC6666; font-weight: bold;">with-temp-buffer</span>
                                                     (insert old-buffer-path)
                                                     (goto-char (point-min))
                                                     (replace-regexp <span style="color: #b5bd68;">"</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">(</span><span style="color: #b5bd68;">.+</span><span style="color: #c5c8c6; font-weight: bold;">\\</span><span style="color: #c5c8c6; font-weight: bold;">)</span><span style="color: #b5bd68;">\\.org"</span> <span style="color: #b5bd68;">"\\1_color.org"</span>)
                                                     (buffer-string)))
            (shell-command (format <span style="color: #b5bd68;">"open %s"</span> (org-html-export-to-html))))))
    (message <span style="color: #b5bd68;">"Please make sure this a `.org` file."</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org81a3928" class="outline-3">
<h3 id="org81a3928">Miscellaneous</h3>
<div class="outline-text-3" id="text-org81a3928">
<p>
Other config. Limit this section as much as possible.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">disable company mode for org-mode</span>
(add-hook 'org-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> () (company-mode -1)))
(add-hook 'text-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> () (company-mode -1)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">make sure M-h binding works</span>
(add-hook 'org-mode-hook
          (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
            (define-key org-mode-map <span style="color: #b5bd68;">"\M-h"</span> nil)
            (global-set-key (kbd <span style="color: #b5bd68;">"M-h"</span>) 'evil-window-left)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">open link in the same window</span>
(add-to-list 'org-link-frame-setup '(file . find-file))
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> help-window-keep-selected t)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">recalculate table</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-M-'"</span>) #'org-table-recalculate)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">recalculate table</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-M-;"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                           (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                           (org-table-eval-formula '(4))))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">clear field</span>
(define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-c SPC"</span>) #'org-table-blank-field)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">start timer</span>
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g t s"</span>) #'org-timer-start)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g t m"</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (message (org-timer-value-string))))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g t d"</span>) #'org-timer-set-timer)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g t i"</span>) #'org-timer)
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g t ."</span>)
  #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
      (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
      (<span style="color: #CC6666; font-weight: bold;">let</span> ((final-timer-value (string-trim (org-timer-value-string))))
        (<span style="color: #CC6666; font-weight: bold;">let</span> ((inhibit-message t))
          (org-timer-stop))
        (message <span style="color: #b5bd68;">"Timer stopped at %s."</span> final-timer-value))))
(<span style="color: #CC6666; font-weight: bold;">evil-define-key</span> 'normal org-mode-map (kbd <span style="color: #b5bd68;">"g t ,"</span>) #'org-timer-pause-or-continue)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">disable pairing for single quotes</span>
(sp-local-pair 'org-mode <span style="color: #b5bd68;">"'"</span> nil <span style="color: #81a2be;">:actions</span> nil)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">create a definition for a term in notes</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-note-create-definition</span> (start end)
  (<span style="color: #CC6666; font-weight: bold;">interactive</span> <span style="color: #b5bd68;">"r"</span>)
  (<span style="color: #CC6666; font-weight: bold;">let</span> ((old-point (point))
        (inhibit-message t))
    (<span style="color: #CC6666; font-weight: bold;">if</span> (use-region-p)
        (<span style="color: #CC6666; font-weight: bold;">let*</span> ((text (buffer-substring start end))
               (title (concat (upcase (substring text 0 1)) (substring text 1))))
          (replace-region-contents start end
                                   (<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                     (format <span style="color: #b5bd68;">"[[*%s][%s]]"</span> title text)))
          (goto-char (point-max))
          (yas-expand-snippet
           (format
            <span style="color: #b5bd68;">"\n%s ${1:%s}\n\n$2/${1:$(if (or (not (yas-field-value 2)) (equal (yas-field-value 2) \"\")) yas-text (downcase yas-text))}/ $0"</span>
            (org-heading-asterisks) title)
           (point-max))
          (evil-insert-state))
      (goto-char (point-max))
      (yas-expand-snippet
       <span style="color: #b5bd68;">"\n`(org-heading-asterisks)` $1\n\n$2/${1:$(if (equal (yas-field-value 2) \"\") yas-text (downcase yas-text))}/ $0"</span>
       (point-max))
      (evil-insert-state))
    (org-mark-ring-push old-point)))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">function for how many asterisks required to create heading</span>
(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">org-heading-asterisks</span> ()
  (make-string (<span style="color: #CC6666; font-weight: bold;">if</span> (&gt; (org-outline-level) 0)
                   (max (org-outline-level) 2)
                 1) <span style="color: #f0c674;">?*))</span>


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop creating bookmarks after refiling</span>
(plist-put org-bookmark-names-plist <span style="color: #81a2be;">:last-capture</span> nil)
(plist-put org-bookmark-names-plist <span style="color: #81a2be;">:last-refile</span> nil)
(plist-put org-bookmark-names-plist <span style="color: #81a2be;">:last-capture-marker</span> nil)
</pre>
</div>

<p>
Open file in full screen, previewing latex (extremely hacky, intended as
basically a macro).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">expand-org-latex-workspace</span> ()
  (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
  (toggle-buffer-in-buffer-ring)
  (evil-goto-line)
  (org-latex-preview-pdf 1)
  (make-frame '((fullscreen . fullboth)))
  (export-and-open-pdf t)
  (evil-collection-pdf-view-goto-page)
  (toggle-buffer-in-buffer-ring)
  (evil-window-left 1))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org08f3b01" class="outline-2">
<h2 id="org08f3b01">Ichthys</h2>
<div class="outline-text-2" id="text-org08f3b01">
<p>
Also known as &lt;&gt;&lt;, this is a scripture-finding mode I wrote.
</p>

<p>
Relevant config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">ichthys-mode</span>
  <span style="color: #81a2be;">:load-path</span> <span style="color: #b5bd68;">"lisp/"</span>
  <span style="color: #81a2be;">:config</span>
  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">binding to insert link in org-mode</span>
  (define-key org-mode-map (kbd <span style="color: #b5bd68;">"C-c i"</span>) #'ichthys/insert-link)

  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">create a ring for Portuguese and English scriptures</span>
  (ichthys/create-lang-ring
   <span style="color: #b5bd68;">"~/Documents/Church/Ichthys/Emacs/Portuguese"</span>
   <span style="color: #b5bd68;">"~/Documents/Church/Ichthys/Emacs/English"</span>)

  <span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">use &lt;f9&gt; to cycle between languages</span>
  (define-key global-map (kbd <span style="color: #b5bd68;">"&lt;f9&gt;"</span>) #'ichthys/lang-ring-next))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge78cda2" class="outline-2">
<h2 id="orge78cda2">Games</h2>
<div class="outline-text-2" id="text-orge78cda2">
</div>
<div id="outline-container-orgfa9ea85" class="outline-3">
<h3 id="orgfa9ea85">Gomoku</h3>
<div class="outline-text-3" id="text-orgfa9ea85">
<p>
Style configuration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">gomoku</span>
  <span style="color: #81a2be;">:config</span>
  (set-face-attribute 'gomoku-O nil
                      <span style="color: #81a2be;">:weight</span> 'bold
                      <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#cc6666"</span>)

  (set-face-attribute 'gomoku-X nil
                      <span style="color: #81a2be;">:weight</span> 'bold
                      <span style="color: #81a2be;">:foreground</span> <span style="color: #b5bd68;">"#6ca17a"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org331e39e" class="outline-3">
<h3 id="org331e39e">Pong</h3>
<div class="outline-text-3" id="text-org331e39e">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">pong</span>
  <span style="color: #81a2be;">:config</span>
  (define-key pong-mode-map (kbd <span style="color: #b5bd68;">"s"</span>) #'pong-move-left)
  (define-key pong-mode-map (kbd <span style="color: #b5bd68;">"d"</span>) #'pong-move-right)
  (define-key pong-mode-map (kbd <span style="color: #b5bd68;">"k"</span>) #'pong-move-up)
  (define-key pong-mode-map (kbd <span style="color: #b5bd68;">"j"</span>) #'pong-move-down))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb1163ed" class="outline-2">
<h2 id="orgb1163ed">Miscellaneous</h2>
<div class="outline-text-2" id="text-orgb1163ed">
<p>
For uncategorized config. Avoid adding to this section.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">configure .curve for json</span>
(add-to-list 'auto-mode-alist '(<span style="color: #b5bd68;">"\\.curve\\'"</span> . json-mode))


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">remove bell sound</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> ring-bell-function 'ignore)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">delete a file by moving it to trash</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> delete-by-moving-to-trash t)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> trash-directory <span style="color: #b5bd68;">"~/.Trash"</span>)


<span style="color: #5a5b5a; font-style: italic;">;; </span><span style="color: #5a5b5a; font-style: italic;">stop making backup files</span>
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> make-backup-files nil)
</pre>
</div>
</div>

<div id="outline-container-org9f1706f" class="outline-3">
<h3 id="org9f1706f">Calendar</h3>
<div class="outline-text-3" id="text-org9f1706f">
<p>
Add holidays to calendar.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">calendar</span>)
(<span style="color: #CC6666; font-weight: bold;">require</span> '<span style="color: #CC6666;">holidays</span>)


(<span style="color: #CC6666; font-weight: bold;">defvar</span> <span style="color: #E0DBA9;">custom-holidays</span>
  '((holiday-fixed 1 1 <span style="color: #b5bd68;">"New Year's Day"</span>)
    (holiday-float 1 1 3 <span style="color: #b5bd68;">"Martin Luther King Day"</span>)
    (holiday-fixed 2 2 <span style="color: #b5bd68;">"Groundhog Day"</span>)
    (holiday-fixed 2 14 <span style="color: #b5bd68;">"Valentine's Day"</span>)
    (holiday-float 2 1 3 <span style="color: #b5bd68;">"President's Day"</span>)
    (holiday-fixed 3 17 <span style="color: #b5bd68;">"St. Patrick's Day"</span>)
    (holiday-fixed 4 1 <span style="color: #b5bd68;">"April Fools' Day"</span>)
    (holiday-float 5 0 2 <span style="color: #b5bd68;">"Mother's Day"</span>)
    (holiday-float 5 1 -1 <span style="color: #b5bd68;">"Memorial Day"</span>)
    (holiday-fixed 6 14 <span style="color: #b5bd68;">"Flag Day"</span>)
    (holiday-fixed 6 19 <span style="color: #b5bd68;">"Juneteenth"</span>)
    (holiday-float 6 0 3 <span style="color: #b5bd68;">"Father's Day"</span>)
    (holiday-fixed 7 4 <span style="color: #b5bd68;">"Independence Day"</span>)
    (holiday-fixed 7 25 <span style="color: #b5bd68;">"Pioneer Day"</span>)
    (holiday-float 9 1 1 <span style="color: #b5bd68;">"Labor Day"</span>)
    (holiday-float 10 1 2 <span style="color: #b5bd68;">"Columbus Day"</span>)
    (holiday-fixed 10 31 <span style="color: #b5bd68;">"Halloween"</span>)
    (holiday-fixed 11 11 <span style="color: #b5bd68;">"Veteran's Day"</span>)
    (holiday-float 11 4 4 <span style="color: #b5bd68;">"Thanksgiving"</span>)
    (holiday-easter-etc)
    (holiday-fixed 12 25 <span style="color: #b5bd68;">"Christmas"</span>)
    (solar-equinoxes-solstices)
    (holiday-sexp calendar-daylight-savings-starts
                  (format <span style="color: #b5bd68;">"Daylight Saving Time Begins %s"</span>
                          (solar-time-string
                           (/ calendar-daylight-savings-starts-time . #1=((float 60)))
                           calendar-standard-time-zone-name)))
    (holiday-sexp calendar-daylight-savings-ends
                  (format <span style="color: #b5bd68;">"Daylight Saving Time Ends %s"</span>
                          (solar-time-string
                           (/ calendar-daylight-savings-ends-time . #1#)
                           calendar-daylight-time-zone-name)))
    (holiday-easter-etc -47 <span style="color: #b5bd68;">"Carnaval"</span>)
    (holiday-easter-etc -2 <span style="color: #b5bd68;">"Paix&#227;o de Cristo"</span>)
    (holiday-fixed 4 21 <span style="color: #b5bd68;">"Tiradentes"</span>)
    (holiday-fixed 5 1 <span style="color: #b5bd68;">"Dia do Trabalhador"</span>)
    (holiday-fixed 7 25 <span style="color: #b5bd68;">"Pioneer Day"</span>)
    (holiday-easter-etc 60 <span style="color: #b5bd68;">"Corpus Christi"</span>)
    (holiday-fixed 9 7 <span style="color: #b5bd68;">"Dia da Independ&#234;ncia do Brasil"</span>)
    (holiday-fixed 10 12 <span style="color: #b5bd68;">"Nossa Senhora Aparecida"</span>)
    (holiday-fixed 11 2 <span style="color: #b5bd68;">"Finados"</span>)
    (holiday-fixed 11 15 <span style="color: #b5bd68;">"Proclama&#231;&#227;o da Rep&#250;blica"</span>)
    (holiday-fixed 12 25 <span style="color: #b5bd68;">"Natal"</span>))
  <span style="color: #717171; font-style: italic;">"Only the ones I want (though frankly, I'd like to observe more)."</span>)


(<span style="color: #CC6666; font-weight: bold;">setq-default</span> org-agenda-include-diary t)
(<span style="color: #CC6666; font-weight: bold;">setq-default</span> calendar-holidays custom-holidays)
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'calendar-mode-hook #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                  (evil-local-set-key 'normal (kbd <span style="color: #b5bd68;">"q"</span>) #'(<span style="color: #CC6666; font-weight: bold;">lambda</span> ()
                                                                            (<span style="color: #CC6666; font-weight: bold;">interactive</span>)
                                                                            (calendar-exit t)))))
</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span style="color: #b5bd68;">"DEL"</span> #'calendar)
</pre>
</div>
</div>
</div>

<div id="outline-container-org4ab39e3" class="outline-3">
<h3 id="org4ab39e3">Mac-specific</h3>
<div class="outline-text-3" id="text-org4ab39e3">
<p>
Use <code>command</code> key as <code>meta</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">setq-default</span> mac-command-modifier 'meta)
</pre>
</div>

<p>
Reveal in Finder.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">reveal-in-osx-finder</span>)
</pre>
</div>

<p>
Make sure frame is not fullscreen before quitting (causes Emacs to
crash).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">defun</span> <span style="color: #6CA17A;">before-evil-quit</span> (orig-fun <span style="color: #6CA17A;">&amp;rest</span> args)
  <span style="color: #717171; font-style: italic;">"Work around macOS fullscreen quit crash."</span>
  (<span style="color: #CC6666; font-weight: bold;">if</span> (one-window-p)
      (set-frame-parameter nil 'fullscreen nil)))
(advice-add 'evil-quit <span style="color: #81a2be;">:before</span> #'before-evil-quit)
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span style="color: #b5bd68;">"R"</span> 'reveal-in-osx-finder)
</pre>
</div>
</div>
</div>

<div id="outline-container-org93577da" class="outline-3">
<h3 id="org93577da">Edit with Emacs</h3>
<div class="outline-text-3" id="text-org93577da">
<p>
Use GhostText to edit with Emacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #CC6666; font-weight: bold;">use-package</span> <span style="color: #CC6666;">atomic-chrome</span>
  <span style="color: #81a2be;">:config</span>
  (<span style="color: #CC6666; font-weight: bold;">setq-default</span> atomic-chrome-buffer-open-style 'full)


  (atomic-chrome-start-server))
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
