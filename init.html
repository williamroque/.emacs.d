<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-11-19 Sat 19:02 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs Config</title>
<meta name="author" content="William Aguiar Roque" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
<!--/*--><![CDATA[/*><!--*/
@font-face {
  font-family: 'RomanAlternate';
  src: local('Times New Roman');
  unicode-range: U+0026;
}

@font-face {
    font-family: 'Ampersand';
    src: local('Fira Code');
	unicode-range: U+0370-03FF, U+1F00-1FFF;
}

body {
    padding: 0;
    padding-bottom: 30px;
    display: flex;
    justify-content: center;
}

@media print {
    body {
        padding: 0 30px;
    }

    div#content {
        max-width: auto;
    }
}

div#content {
    width: 96%;
    max-width: 800px;
    padding: 0 50px;
}

body .anchor {
    float: left;
    line-height: 1;
    margin-left: -20px;
    padding-right: 4px;
}

body .anchor:focus {
    outline: none;
}

body h1:hover .anchor,
body h2:hover .anchor,
body h3:hover .anchor,
body h4:hover .anchor,
body h5:hover .anchor,
body h6:hover .anchor {
    text-decoration: none;
}

body {
    -ms-text-size-adjust: 100%;
    -webkit-text-size-adjust: 100%;
    line-height: 1.5;
    color: #24292e;
    font-family: 'RomanAlternate', 'CMU Serif', 'Noto Serif Hebrew';
    font-size: 16px;
    line-height: 1.5;
    word-wrap: break-word;
}

body details {
    display: block;
}

body summary {
    display: list-item;
}

body a {
    background-color: initial;
}

body a:active,
body a:hover {
    outline-width: 0;
}

body strong {
    font-weight: inherit;
    font-weight: bolder;
}

body h1 {
    font-size: 2em;
    margin: .67em 0;
}

body img {
    border-style: none;
}

body code,
body kbd,
body pre {
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 1em;
}

body hr {
    box-sizing: initial;
    height: 0;
    overflow: visible;
}

body input {
    font: inherit;
    margin: 0;
}

body input {
    overflow: visible;
}

body [type=checkbox] {
    box-sizing: border-box;
    padding: 0;
}

body * {
    box-sizing: border-box;
}

body input {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
}

body a {
    color: #0366d6;
    text-decoration: none;
}

body a:hover {
    text-decoration: underline;
}

body strong {
    font-weight: 600;
}

body hr {
    height: 0;
    margin: 15px 0;
    overflow: hidden;
    background: transparent;
    border: 0;
    border-bottom: 1px solid #dfe2e5;
}

body hr:after,
body hr:before {
    display: table;
    content: "";
}

body hr:after {
    clear: both;
}

body table {
    border-spacing: 0;
    border-collapse: collapse;
}

tbody {
    border-bottom: solid 2px #b0b0b0;
}

body td,
body th {
    padding: 0;
}

body details summary {
    cursor: pointer;
}

body kbd {
    display: inline-block;
    padding: 3px 5px;
    font: 11px 'Ampersand', 'Victor Mono';
    line-height: 10px;
    color: #444d56;
    vertical-align: middle;
    background-color: #fafbfc;
    border: 1px solid #d1d5da;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #d1d5da;
}

body h1,
body h2,
body h3,
body h4,
body h5,
body h6 {
    margin-top: 0;
    margin-bottom: 0;
    font-weight: normal !important;
    page-break-after: avoid !important;
}

body h1 {
    font-size: 32px;
}

body h1,
body h2 {
    font-weight: 600;
}

body h2 {
    font-size: 24px;
}

body h3 {
    font-size: 20px;
}

body h3,
body h4 {
    font-weight: 600;
}

body h4 {
    font-size: 16px;
}

body h5 {
    font-size: 14px;
}

body h5,
body h6 {
    font-weight: 600;
}

body h6 {
    font-size: 12px;
}

body blockquote {
    margin: 0;
}

body ol,
body ul {
    padding-left: 0;
    margin-top: 0;
    margin-bottom: 0;
}

body ul {
    list-style-type: '– ';
}

body ul ul {
    list-style-type: '↳ ';
}

body ol ol,
body ul ol {
    list-style-type: lower-roman;
}

body ol ol ol,
body ol ul ol,
body ul ol ol,
body ul ul ol {
    list-style-type: lower-alpha;
}

body dd {
    margin-left: 0;
}

body code,
body pre {
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 12px;
}

body pre {
    margin-top: 0;
    margin-bottom: 0;
}

body input::-webkit-inner-spin-button,
body input::-webkit-outer-spin-button {
    margin: 0;
    -webkit-appearance: none;
    appearance: none;
}

body :checked+.radio-label {
    position: relative;
    z-index: 1;
    border-color: #0366d6;
}

body .border {
    border: 1px solid #e1e4e8!important;
}

body .border-0 {
    border: 0!important;
}

body .border-bottom {
    border-bottom: 1px solid #e1e4e8!important;
}

body .rounded-1 {
    border-radius: 3px!important;
}

body .bg-white {
    background-color: #fff!important;
}

body .bg-gray-light {
    background-color: #fafbfc!important;
}

body .text-gray-light {
    color: #6a737d!important;
}

body .mb-0 {
    margin-bottom: 0!important;
}

body .my-2 {
    margin-top: 8px!important;
    margin-bottom: 8px!important;
}

body .pl-0 {
    padding-left: 0!important;
}

body .py-0 {
    padding-top: 0!important;
    padding-bottom: 0!important;
}

body .pl-1 {
    padding-left: 4px!important;
}

body .pl-2 {
    padding-left: 8px!important;
}

body .py-2 {
    padding-top: 8px!important;
    padding-bottom: 8px!important;
}

body .pl-3,
body .px-3 {
    padding-left: 16px!important;
}

body .px-3 {
    padding-right: 16px!important;
}

body .pl-4 {
    padding-left: 24px!important;
}

body .pl-5 {
    padding-left: 32px!important;
}

body .pl-6 {
    padding-left: 40px!important;
}

body .f6 {
    font-size: 12px!important;
}

body .lh-condensed {
    line-height: 1.25!important;
}

body .text-bold {
    font-weight: 600!important;
}

body .pl-c {
    color: #6a737d;
}

body .pl-c1,
body .pl-s .pl-v {
    color: #005cc5;
}

body .pl-e,
body .pl-en {
    color: #6f42c1;
}

body .pl-s .pl-s1,
body .pl-smi {
    color: #24292e;
}

body .pl-ent {
    color: #22863a;
}

body .pl-k {
    color: #d73a49;
}

body .pl-pds,
body .pl-s,
body .pl-s .pl-pse .pl-s1,
body .pl-sr,
body .pl-sr .pl-cce,
body .pl-sr .pl-sra,
body .pl-sr .pl-sre {
    color: #032f62;
}

body .pl-smw,
body .pl-v {
    color: #e36209;
}

body .pl-bu {
    color: #b31d28;
}

body .pl-ii {
    color: #fafbfc;
    background-color: #b31d28;
}

body .pl-c2 {
    color: #fafbfc;
    background-color: #d73a49;
}

body .pl-c2:before {
    content: "^M";
}

body .pl-sr .pl-cce {
    font-weight: 700;
    color: #22863a;
}

body .pl-ml {
    color: #735c0f;
}

body .pl-mh,
body .pl-mh .pl-en,
body .pl-ms {
    font-weight: 700;
    color: #005cc5;
}

body .pl-mi {
    font-style: italic;
    color: #24292e;
}

body .pl-mb {
    font-weight: 700;
    color: #24292e;
}

body .pl-md {
    color: #b31d28;
    background-color: #ffeef0;
}

body .pl-mi1 {
    color: #22863a;
    background-color: #f0fff4;
}

body .pl-mc {
    color: #e36209;
    background-color: #ffebda;
}

body .pl-mi2 {
    color: #f6f8fa;
    background-color: #005cc5;
}

body .pl-mdr {
    font-weight: 700;
    color: #6f42c1;
}

body .pl-ba {
    color: #586069;
}

body .pl-sg {
    color: #959da5;
}

body .pl-corl {
    text-decoration: underline;
    color: #032f62;
}

body .mb-0 {
    margin-bottom: 0!important;
}

body .my-2 {
    margin-bottom: 8px!important;
}

body .my-2 {
    margin-top: 8px!important;
}

body .pl-0 {
    padding-left: 0!important;
}

body .py-0 {
    padding-top: 0!important;
    padding-bottom: 0!important;
}

body .pl-1 {
    padding-left: 4px!important;
}

body .pl-2 {
    padding-left: 8px!important;
}

body .py-2 {
    padding-top: 8px!important;
    padding-bottom: 8px!important;
}

body .pl-3 {
    padding-left: 16px!important;
}

body .pl-4 {
    padding-left: 24px!important;
}

body .pl-5 {
    padding-left: 32px!important;
}

body .pl-6 {
    padding-left: 40px!important;
}

body .pl-7 {
    padding-left: 48px!important;
}

body .pl-8 {
    padding-left: 64px!important;
}

body .pl-9 {
    padding-left: 80px!important;
}

body .pl-10 {
    padding-left: 96px!important;
}

body .pl-11 {
    padding-left: 112px!important;
}

body .pl-12 {
    padding-left: 128px!important;
}

body hr {
    border-bottom-color: #eee;
}

body kbd {
    display: inline-block;
    padding: 3px 5px;
    font: 11px 'Ampersand', 'Victor Mono';
    line-height: 10px;
    color: #444d56;
    vertical-align: middle;
    background-color: #fafbfc;
    border: 1px solid #d1d5da;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #d1d5da;
}

body:after,
body:before {
    display: table;
    content: "";
}

body:after {
    clear: both;
}

body>:first-child {
    margin-top: 0!important;
}

body>:last-child {
    margin-bottom: 0!important;
}

body a:not([href]) {
    color: inherit;
    text-decoration: none;
}

body blockquote,
body details,
body dl,
body ol,
body p,
body pre,
body table,
body ul {
    margin-top: 0;
    margin-bottom: 16px;
}

body hr {
    height: .25em;
    padding: 0;
    margin: 24px 0;
    background-color: #e1e4e8;
    border: 0;
}

body blockquote {
    padding: 0 1em;
    color: #6a737d;
    border-left: .25em solid #dfe2e5;
}

body blockquote>:first-child {
    margin-top: 0;
}

body blockquote>:last-child {
    margin-bottom: 0;
}

body h1,
body h2,
body h3,
body h4,
body h5,
body h6 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
}

body h1 {
    font-size: 2em;
}

body h1,
body h2 {
    padding-bottom: .3em;
    border-bottom: 1px solid #eaecef;
}

body h2 {
    font-size: 1.5em;
}

body h3 {
    font-size: 1.25em;
}

body h4 {
    font-size: 1em;
}

body h5 {
    font-size: .875em;
}

body h6 {
    font-size: .85em;
    color: #6a737d;
}

body ol,
body ul {
    padding-left: 2em;
}

body ol ol,
body ol ul,
body ul ol,
body ul ul {
    margin-top: 0;
    margin-bottom: 0;
}

body li {
    word-wrap: break-all;
    text-align: left;
    hyphens: auto;
    -webkit-hyphens: auto;
}

body p {
    word-wrap: break-all;
    hyphens: auto;
}

body li>p {
    margin-top: 16px;
}

body li+li {
    margin-top: .25em;
}

body dl {
    padding: 0;
}

body dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
    font-weight: 600;
}

body dl dd {
    padding: 0 16px;
    margin-bottom: 16px;
}

body table {
    display: block;
    width: 100%;
    overflow: auto;
}

body table th {
    font-weight: 600;
}

body table td,
body table th {
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
}

body table tr {
    background-color: #fff;
    border-top: 1px solid #c6cbd1;
}

body table tr:nth-child(2n) {
    background-color: #f6f8fa;
}

body img {
    max-width: 100%;
    box-sizing: initial;
    background-color: #fff;
    margin-left: auto;
    margin-right: auto;
    display: flex;
}

body img[align=right] {
    padding-left: 20px;
}

body img[align=left] {
    padding-right: 20px;
}

body code {
    padding: .2em .4em;
    margin: 0;
    font-size: 85%;
    /* background-color: rgba(27,31,35,.05); */
    border-radius: 3px;
}

body pre {
    word-wrap: normal;
}

body pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
}

body .highlight {
    margin-bottom: 16px;
}

body .highlight pre {
    margin-bottom: 0;
    word-break: normal;
}

body .highlight pre,
body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    color: #383A42;
    border-left: solid 3px #d0d8da;
    font-weight: 400;
}

body pre code {
    display: inline;
    max-width: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    line-height: inherit;
    word-wrap: normal;
    background-color: initial;
    border: 0;
}

body .commit-tease-sha {
    display: inline-block;
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 90%;
    color: #444d56;
}

body .full-commit .btn-outline:not(:disabled):hover {
    color: #005cc5;
    border-color: #005cc5;
}

body .blob-wrapper {
    overflow-x: auto;
    overflow-y: hidden;
}

body .blob-wrapper-embedded {
    max-height: 240px;
    overflow-y: auto;
}

body .blob-num {
    width: 1%;
    min-width: 50px;
    padding-right: 10px;
    padding-left: 10px;
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 12px;
    line-height: 20px;
    color: rgba(27,31,35,.3);
    text-align: right;
    white-space: nowrap;
    vertical-align: top;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

body .blob-num:hover {
    color: rgba(27,31,35,.6);
}

body .blob-num:before {
    content: attr(data-line-number);
}

body .blob-code {
    position: relative;
    padding-right: 10px;
    padding-left: 10px;
    line-height: 20px;
    vertical-align: top;
}

body .blob-code-inner {
    overflow: visible;
    font-family: 'Ampersand', 'Victor Mono';
    font-size: 12px;
    color: #24292e;
    word-wrap: normal;
    white-space: pre;
}

body .pl-token.active,
body .pl-token:hover {
    cursor: pointer;
    background: #ffea7f;
}

body .tab-size[data-tab-size="1"] {
    -moz-tab-size: 1;
    tab-size: 1;
}

body .tab-size[data-tab-size="2"] {
    -moz-tab-size: 2;
    tab-size: 2;
}

body .tab-size[data-tab-size="3"] {
    -moz-tab-size: 3;
    tab-size: 3;
}

body .tab-size[data-tab-size="4"] {
    -moz-tab-size: 4;
    tab-size: 4;
}

body .tab-size[data-tab-size="5"] {
    -moz-tab-size: 5;
    tab-size: 5;
}

body .tab-size[data-tab-size="6"] {
    -moz-tab-size: 6;
    tab-size: 6;
}

body .tab-size[data-tab-size="7"] {
    -moz-tab-size: 7;
    tab-size: 7;
}

body .tab-size[data-tab-size="8"] {
    -moz-tab-size: 8;
    tab-size: 8;
}

body .tab-size[data-tab-size="9"] {
    -moz-tab-size: 9;
    tab-size: 9;
}

body .tab-size[data-tab-size="10"] {
    -moz-tab-size: 10;
    tab-size: 10;
}

body .tab-size[data-tab-size="11"] {
    -moz-tab-size: 11;
    tab-size: 11;
}

body .tab-size[data-tab-size="12"] {
    -moz-tab-size: 12;
    tab-size: 12;
}

body .task-list-item {
    list-style-type: none;
}

body .task-list-item+.task-list-item {
    margin-top: 3px;
}

body .task-list-item input {
    margin: 0 .2em .25em -1.6em;
    vertical-align: middle;
}

table {
    border: none !important;
}

.MathJax {
    /* I really don't know what to do here */
}

.underline {
    text-decoration: underline;
}

h2.footnotes {
    display: none;
}

div#footnotes {
    /* position: absolute; */
    /* bottom: 10px; */
}

.footdef {
    display: inline-flex;
    width: 100%;
}

.footpara {
    margin-left: 5px;
    width: 97%;
    hyphens: auto;
    text-align: justify;
}

a.footref {
    font-size: 8pt;
}

.example {
    background-color: white !important;
    color: #24292e !important;
}

span.org-keyword {
    color: #8c5337;
    font-weight: bold;
}

span.org-constant {
    color: #986801;
}

span.org-string {
    color: #50A14F;
}

span.org-builtin {
    color: #0184BC;
}

span.org-comment, span.org-comment-delimiter {
    color: #929494;
}

span.org-operator-lock {
    color: #9c6060;
}

span.org-method-call-lock {
    color: #286a9e;
}

#table-of-contents h2 {
    font-size: 14pt;
    border-bottom: solid 1px #636363;
}

#table-of-contents {
    border-bottom: solid 1px #636363;
}

#table-of-contents ul {
    counter-reset: item;
}

#table-of-contents li {
    display: block;
}

#table-of-contents li:before {
    content: counters(item, ".") " \2002";
    counter-increment: item;
}

.figure p {
    text-align: center;
}
/*]]>*/-->
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('table.currency td.org-right').forEach(elem => {
        const text = elem.innerText;
        if (!isNaN(text)) {
            let num = (Math.round(parseFloat(text) * 100) / 100).toFixed(2);
            elem.innerText = '$' + num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
    });
});
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Emacs Config</h1>
<p>
Welcome to my Emacs config! Emacs is a beautiful piece of software
that allows you control over virtually every aspect of itself.
Typically, I only change what bothers me. As I&rsquo;m sure you&rsquo;ll find,
however, that&rsquo;s quite a bit.
</p>

<p>
I cannot guarantee that this will work on your machine out of the
box. If you&rsquo;re on a Mac, however, copying the entire <code>.emacs.d</code>
directory should work.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org4adc87b">Startup</a>
<ul>
<li><a href="#org6433bc0">Setup</a></li>
<li><a href="#orgc2ba52c">Scratch</a></li>
</ul>
</li>
<li><a href="#org5506f85">Utilities</a></li>
<li><a href="#orgfba9887">User interface</a>
<ul>
<li><a href="#org3e6d66b">Theme</a></li>
<li><a href="#org1d57173">Line numbers</a></li>
<li><a href="#org5fe8432">Window/frame</a></li>
<li><a href="#orgab63e03">Mode line</a></li>
<li><a href="#org29dd0d6">Encoding</a></li>
<li><a href="#org6d6a619">Prettify symbols</a></li>
</ul>
</li>
<li><a href="#org286749a">Evil</a>
<ul>
<li><a href="#org0200c0e">Evil leader</a></li>
<li><a href="#orge5cf859">Evil surround</a></li>
<li><a href="#org39ec145">Evil collection</a></li>
<li><a href="#orgead68b1">Evil args</a></li>
<li><a href="#org0a9728f">Evil embrace</a></li>
<li><a href="#org0cf94da">Evil owl</a></li>
<li><a href="#org8fe60f9">Evil commentary</a></li>
<li><a href="#org7066526">Evil little word</a></li>
<li><a href="#orgb9d6abc">Evil indent plus</a></li>
</ul>
</li>
<li><a href="#orgb925603">Navigation</a>
<ul>
<li><a href="#org4a54cef">Buffer ring</a></li>
<li><a href="#org6507d60">Helm</a></li>
</ul>
</li>
<li><a href="#orgdb40bef">Editing</a>
<ul>
<li><a href="#org7d2cc5f">Snippets</a></li>
<li><a href="#orgec1a8d7">Spelling</a></li>
<li><a href="#orgc044e0c">Smartparens</a></li>
<li><a href="#org7e7ba67">Templating</a></li>
<li><a href="#orga892f74">Macros</a></li>
<li><a href="#org888791d">Undo tree</a></li>
</ul>
</li>
<li><a href="#org6a76576">Shell</a></li>
<li><a href="#orgf95b292">Remote</a>
<ul>
<li><a href="#org4bcdb70">Tramp</a></li>
<li><a href="#org612bfc6">Git</a></li>
</ul>
</li>
<li><a href="#org5d85a68">Programming</a>
<ul>
<li><a href="#orgc257f6b">Flycheck</a></li>
<li><a href="#org09c6e33">Flymake</a></li>
<li><a href="#org0c74e5e">Company</a></li>
<li><a href="#orge442350">Languages</a></li>
<li><a href="#orgf9f451f">Python</a></li>
<li><a href="#org77f391c">Rust</a></li>
<li><a href="#org875e748">Elisp</a></li>
<li><a href="#org12419f8">SGML/HTML</a></li>
<li><a href="#orgf0c84db">Auctex/latex</a></li>
<li><a href="#org6a53b6e">Scripts</a></li>
</ul>
</li>
<li><a href="#org242d5b1">Mail</a></li>
<li><a href="#orgff5632f">Files</a>
<ul>
<li><a href="#org9a45358">Dired</a></li>
<li><a href="#orgabffaed">PDFs/images</a></li>
</ul>
</li>
<li><a href="#org06a7c27">Org</a>
<ul>
<li><a href="#org41b3730">Compilation</a></li>
<li><a href="#orgd96dd9c">Capture</a></li>
<li><a href="#org450eecc">User interface</a></li>
<li><a href="#orgbd2e3d0">Editing</a></li>
<li><a href="#org1ecf4d4">Key bindings</a></li>
<li><a href="#org20f642c">Packages</a></li>
<li><a href="#org28e05f1">External applications</a></li>
<li><a href="#org2f3c720">References</a></li>
<li><a href="#orgf0b4860">Export</a></li>
<li><a href="#org5c10477">Miscellaneous</a></li>
</ul>
</li>
<li><a href="#orgc0503b1">Ichthys</a></li>
<li><a href="#orga28ae22">Games</a>
<ul>
<li><a href="#org952f525">Gomoku</a></li>
<li><a href="#orged00148">Pong</a></li>
</ul>
</li>
<li><a href="#org312aa38">Miscellaneous</a>
<ul>
<li><a href="#orgf30af60">Calendar</a></li>
<li><a href="#orgee02a34">Mac-specific</a></li>
<li><a href="#orgde536c8">Edit with Emacs</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org4adc87b" class="outline-2">
<h2 id="org4adc87b">Startup</h2>
<div class="outline-text-2" id="text-org4adc87b">
</div>
<div id="outline-container-org6433bc0" class="outline-3">
<h3 id="org6433bc0">Setup</h3>
<div class="outline-text-3" id="text-org6433bc0">
<p>
Personal information.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> user-full-name <span class="org-string">"William Aguiar Roque"</span>)
(<span class="org-keyword">setq-default</span> user-mail-address <span class="org-string">"william.aroque@gmail.com"</span>)
</pre>
</div>

<p>
Add package repositories.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">package</span>)
(add-to-list 'package-archives
             '(<span class="org-string">"melpa"</span> . <span class="org-string">"https://melpa.org/packages/"</span>)
             '(<span class="org-string">"melpa-stable"</span> . <span class="org-string">"https://stable.melpa.org/packages/"</span>))
(package-initialize)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">unless</span> (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package)
  (<span class="org-keyword">eval-when-compile</span> (<span class="org-keyword">require</span> '<span class="org-constant">use-package</span>)))
</pre>
</div>

<p>
Make sure all packages are ensured by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> use-package-always-ensure t)
</pre>
</div>

<p>
Make sure environment variables are set up properly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">when</span> (memq window-system '(mac ns x))
  (exec-path-from-shell-initialize))
</pre>
</div>

<p>
Set garbage collection threshold to a more reasonable value.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> gc-cons-threshold (* 8 1024 1024))
</pre>
</div>

<p>
Set default directory to home
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq</span> default-directory (concat (getenv <span class="org-string">"HOME"</span>) <span class="org-string">"/"</span>))
</pre>
</div>

<p>
Remove startup screen
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> inhibit-startup-screen t)
</pre>
</div>

<p>
Stop showing &ldquo;when done with this frame&#x2026;&rdquo;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"server"</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">server-execute</span> (proc files nowait commands dontkill frame tty-name)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">This is run from timers and process-filters, i.e. "asynchronously".</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">But w.r.t the user, this is not really asynchronous since the timer</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">is run after 0s and the process-filter is run in response to the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">user running `</span><span class="org-comment"><span class="org-constant">emacsclient</span></span><span class="org-comment">'.  So it is OK to override the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">inhibit-quit flag, which is good since `</span><span class="org-comment"><span class="org-constant">commands</span></span><span class="org-comment">' (as well as</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">find-file-noselect via the major-mode) can run arbitrary code,</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">including code that needs to wait.</span>
    (<span class="org-keyword">with-local-quit</span>
      (<span class="org-keyword">condition-case</span> err
          (<span class="org-keyword">let</span> ((buffers (server-visit-files files proc nowait)))
            (mapc 'funcall (nreverse commands))
            <span class="org-comment-delimiter">;; </span><span class="org-comment">If we were told only to open a new client, obey</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">initial-buffer-choice</span></span><span class="org-comment">' if it specifies a file</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">or a function.</span>
            (<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> files commands)
              (<span class="org-keyword">let</span> ((buf
                     (<span class="org-keyword">cond</span> ((stringp initial-buffer-choice)
                            (find-file-noselect initial-buffer-choice))
                           ((functionp initial-buffer-choice)
                            (funcall initial-buffer-choice)))))
                (switch-to-buffer
                 (<span class="org-keyword">if</span> (buffer-live-p buf) buf (get-buffer-create <span class="org-string">"*scratch*"</span>))
                 'norecord)))

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Delete the client if necessary.</span>
            (<span class="org-keyword">cond</span>
             (nowait
              <span class="org-comment-delimiter">;; </span><span class="org-comment">Client requested nowait; return immediately.</span>
              (server-log <span class="org-string">"Close nowait client"</span> proc)
              (server-delete-client proc))
             ((<span class="org-keyword">and</span> (not dontkill) (null buffers))
              <span class="org-comment-delimiter">;; </span><span class="org-comment">This client is empty; get rid of it immediately.</span>
              (server-log <span class="org-string">"Close empty client"</span> proc)
              (server-delete-client proc)))
            (<span class="org-keyword">cond</span>
             ((<span class="org-keyword">or</span> isearch-mode (minibufferp))
              nil)
             ((<span class="org-keyword">and</span> frame (null buffers))
              (run-hooks 'server-after-make-frame-hook))
             ((not (null buffers))
              (run-hooks 'server-after-make-frame-hook)
              (server-switch-buffer (car buffers) nil (cdr (car files)))
              (run-hooks 'server-switch-hook)
              (<span class="org-keyword">unless</span> nowait)))
            (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> frame (null tty-name))
              (server-unselect-display frame)))
        ((quit error)
         (<span class="org-keyword">when</span> (eq (car err) 'quit)
           (message <span class="org-string">"Quit emacsclient request"</span>))
         (server-return-error proc err))))))

</pre>
</div>

<p>
Stop showing auto save message.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> auto-save-no-message t)
</pre>
</div>

<p>
Make sure customization is saved to desktop instead of <code>.emacs.d</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> custom-file <span class="org-string">"~/Desktop/custom.el"</span>)
</pre>
</div>

<p>
Make sure Emacs uses UTF-8.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> locale-coding-system 'utf-8)
(set-selection-coding-system 'utf-8)
(prefer-coding-system 'utf-8)
(set-default-coding-systems 'utf-8)
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
</pre>
</div>

<p>
Stop showing sentinel exit messages with <code>async-shell-command</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">shell-command-sentinel</span> (process signal)
  (<span class="org-keyword">when</span> (memq (process-status process) '(exit signal))
    (shell-command-set-point-after-cmd (process-buffer process))
    (<span class="org-keyword">let</span> ((inhibit-message t))
      (message <span class="org-string">"%s: %s."</span>
             (car (cdr (cdr (process-command process))))
             (substring signal 0 -1)))))
</pre>
</div>

<p>
Set <code>.emacs.d</code> directory.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">emacs-configuration-directory</span> (file-name-directory (<span class="org-keyword">or</span> load-file-name (buffer-file-name)))
  <span class="org-doc">"Get directory of emacs configuration."</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc2ba52c" class="outline-3">
<h3 id="orgc2ba52c">Scratch</h3>
<div class="outline-text-3" id="text-orgc2ba52c">
<p>
Remove initial message from scratch buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> initial-scratch-message <span class="org-string">""</span>)
</pre>
</div>

<p>
Use org mode in scratch buffer by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq</span> initial-major-mode 'org-mode)
</pre>
</div>

<p>
Toggle org mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">with-eval-after-load</span> 'org
  (define-key lisp-interaction-mode-map (kbd <span class="org-string">"C-c t"</span>) 'org-mode)
  (define-key org-mode-map (kbd <span class="org-string">"C-c t"</span>) 'lisp-interaction-mode))
</pre>
</div>

<p>
Kill all buffers except for scratch.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">kill-all-buffers-except-scratch</span> ()
  <span class="org-doc">"Kill all buffers except for *scratch*."</span>
  (<span class="org-keyword">interactive</span>)
  (mapc 'kill-buffer 
        (delete (get-buffer <span class="org-string">"*scratch*"</span>) (buffer-list)))
  (message <span class="org-string">"Killed all buffers except *scratch*."</span>))
</pre>
</div>

<p>
Use <code>scratch</code> extension to open new language-specific scratch buffers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">scratch</span>
  <span class="org-builtin">:config</span>
  (global-set-key (kbd <span class="org-string">"C-c s"</span>) #'scratch))
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">create scratch buffer</span>
(evil-leader/set-key <span class="org-string">"b"</span> #'(<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (switch-to-buffer <span class="org-string">"*scratch*"</span>)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">make the scratch buffer the only one</span>
(evil-leader/set-key <span class="org-string">"B"</span> #'kill-all-buffers-except-scratch)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5506f85" class="outline-2">
<h2 id="org5506f85">Utilities</h2>
<div class="outline-text-2" id="text-org5506f85">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">for debugging lists</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">print-elements-of-list</span> (list)
  <span class="org-doc">"Print each element of LIST on a line of its own."</span>
  (<span class="org-keyword">while</span> list
    (print (car list))
    (<span class="org-keyword">setq</span> list (cdr list))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">to add after index of list</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">insert-after</span> (lst index newelt)
  (<span class="org-keyword">if</span> (<span class="org-keyword">or</span> (null lst) (&gt;= index (length lst)))
      (<span class="org-keyword">push</span> newelt lst)
    (<span class="org-keyword">push</span> newelt (cdr (nthcdr index lst))))
  lst)


<span class="org-comment-delimiter">;; </span><span class="org-comment">easy way to wrap function for keyboard shortcut</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">wrap-fun</span> (fun <span class="org-type">&amp;rest</span> args)
  `(<span class="org-keyword">lambda</span> ()
     (<span class="org-keyword">interactive</span>)
     (apply #',fun ',args)))


(<span class="org-keyword">defun</span> <span class="org-function-name">org-keyword-activep</span> (keyword <span class="org-type">&amp;optional</span> default-value)
  (<span class="org-keyword">pcase</span> (org-collect-keywords (list keyword))
    (`((,keyword . ,val))
     (not (equal (car val) <span class="org-string">"nil"</span>)))
    (- default-value)))


(<span class="org-keyword">defmacro</span> <span class="org-function-name">with-suppressed-message</span> (<span class="org-type">&amp;rest</span> body)
  <span class="org-doc">"Suppress new messages temporarily in the echo area and the `</span><span class="org-doc"><span class="org-constant">*Messages*</span></span><span class="org-doc">' buffer while BODY is evaluated."</span>
  (<span class="org-keyword">declare</span> (indent 0))
  (<span class="org-keyword">let</span> ((message-log-max nil))
    `(<span class="org-keyword">with-temp-message</span> (<span class="org-keyword">or</span> (current-message) <span class="org-string">""</span>) ,@body)))


(<span class="org-keyword">defmacro</span> <span class="org-function-name">define-and-bind-text-object</span> (key start-regex end-regex)
  (<span class="org-keyword">let</span> ((inner-name (make-symbol <span class="org-string">"inner-name"</span>))
        (outer-name (make-symbol <span class="org-string">"outer-name"</span>)))
    `(<span class="org-keyword">progn</span>
       (<span class="org-keyword">evil-define-text-object</span> ,inner-name (count <span class="org-type">&amp;optional</span> beg end type)
         (evil-select-paren ,start-regex ,end-regex beg end type count nil))
       (<span class="org-keyword">evil-define-text-object</span> ,outer-name (count <span class="org-type">&amp;optional</span> beg end type)
         (evil-select-paren ,start-regex ,end-regex beg end type count t))
       (define-key evil-inner-text-objects-map ,key (<span class="org-keyword">quote</span> ,inner-name))
       (define-key evil-outer-text-objects-map ,key (<span class="org-keyword">quote</span> ,outer-name)))))


(<span class="org-keyword">use-package</span> <span class="org-constant">ox-json</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfba9887" class="outline-2">
<h2 id="orgfba9887">User interface</h2>
<div class="outline-text-2" id="text-orgfba9887">
<p>
General UI config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">colorscheme stuff</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">ansi-color-names-vector</span>
  [<span class="org-string">"#3c3836"</span> <span class="org-string">"#fb4933"</span> <span class="org-string">"#b8bb26"</span> <span class="org-string">"#fabd2f"</span> <span class="org-string">"#83a598"</span> <span class="org-string">"#d3869b"</span> <span class="org-string">"#8ec07c"</span> <span class="org-string">"#ebdbb2"</span>])
(<span class="org-keyword">defvar</span> <span class="org-variable-name">pdf-view-midnight-colors</span> '(<span class="org-string">"#fdf4c1"</span> . <span class="org-string">"#1d2021"</span>))


<span class="org-comment-delimiter">;; </span><span class="org-comment">set theme</span>
(<span class="org-keyword">use-package</span> <span class="org-constant">doom-themes</span>
  <span class="org-builtin">:config</span>
  (load-theme 'doom-tomorrow-night t))
</pre>
</div>
</div>

<div id="outline-container-org3e6d66b" class="outline-3">
<h3 id="org3e6d66b">Theme</h3>
<div class="outline-text-3" id="text-org3e6d66b">
<p>
Colors.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-background</span>        <span class="org-string">"#121112"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-light-background</span>  <span class="org-string">"#1D1F21"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-foreground</span>        <span class="org-string">"#FDF4C1"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-light-subdued</span>     <span class="org-string">"#EBDBB2"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-dark-subdued</span>      <span class="org-string">"#313533"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-darkish-subdued</span>   <span class="org-string">"#515553"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-medium-subdued</span>    <span class="org-string">"#717171"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-red</span>               <span class="org-string">"#CC6666"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-light-red</span>         <span class="org-string">"#886950"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-orange</span>            <span class="org-string">"#FE8019"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-light-orange</span>      <span class="org-string">"#F0C674"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-green</span>             <span class="org-string">"#6CA17A"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-light-green</span>       <span class="org-string">"#B5BD68"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-yellow</span>            <span class="org-string">"#E0DBA9"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-blue</span>              <span class="org-string">"#81A2BE"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-light-blue</span>        <span class="org-string">"#41728E"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-brown</span>             <span class="org-string">"#BD9977"</span>)
(<span class="org-keyword">defconst</span> <span class="org-variable-name">color-dark-brown</span>        <span class="org-string">"#605846"</span>)
</pre>
</div>

<p>
Faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'default nil
                    <span class="org-builtin">:weight</span> 'medium
                    <span class="org-builtin">:height</span> 140
                    <span class="org-builtin">:width</span> 'normal
                    <span class="org-builtin">:family</span> <span class="org-string">"Victor Mono"</span>
                    <span class="org-builtin">:background</span> color-background
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#fdf4c1"</span>)


(set-face-attribute 'fixed-pitch nil
                    <span class="org-builtin">:family</span> <span class="org-string">"Victor Mono"</span>
                    <span class="org-builtin">:height</span> 140)


(set-face-attribute 'variable-pitch nil
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>
                    <span class="org-builtin">:height</span> 160)


(set-face-attribute 'font-lock-preprocessor-face nil
                    <span class="org-builtin">:inherit</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-red)


(set-face-attribute 'mode-line nil
                    <span class="org-builtin">:box</span> nil
                    <span class="org-builtin">:background</span> <span class="org-string">"#121112"</span>
                    <span class="org-builtin">:foreground</span> color-light-subdued)


(set-face-attribute 'mode-line-buffer-id nil
                    <span class="org-builtin">:weight</span> 'bold)


(set-face-attribute 'mode-line-inactive nil
                    <span class="org-builtin">:box</span> nil
                    <span class="org-builtin">:background</span> color-light-background
                    <span class="org-builtin">:foreground</span> color-light-subdued)


(set-face-attribute 'font-lock-keyword-face nil
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-red)


(set-face-attribute 'font-lock-comment-face nil
                    <span class="org-builtin">:slant</span> 'italic)


(set-face-attribute 'font-lock-function-name-face nil
                    <span class="org-builtin">:foreground</span> color-green)


(set-face-attribute 'font-lock-constant-face nil
                    <span class="org-builtin">:foreground</span> color-red)


(set-face-attribute 'font-lock-variable-name-face nil
                    <span class="org-builtin">:foreground</span> color-yellow)


(set-face-attribute 'font-lock-type-face nil
                    <span class="org-builtin">:foreground</span> color-green)


(set-face-attribute 'lazy-highlight nil 
                    <span class="org-builtin">:weight</span> 'normal
                    <span class="org-builtin">:background</span> color-light-blue
                    <span class="org-builtin">:foreground</span> color-foreground)


(set-face-attribute 'line-number nil
                    <span class="org-builtin">:background</span> color-background)


(set-face-attribute 'line-number-current-line nil
                    <span class="org-builtin">:background</span> color-background
                    <span class="org-builtin">:foreground</span> color-orange)


(set-face-attribute 'shadow nil
                    <span class="org-builtin">:foreground</span> color-dark-subdued)


(<span class="org-keyword">with-eval-after-load</span> 'hl-line
  (set-face-attribute 'hl-line nil
                      <span class="org-builtin">:background</span> <span class="org-string">"#1e1e1e"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1d57173" class="outline-3">
<h3 id="org1d57173">Line numbers</h3>
<div class="outline-text-3" id="text-org1d57173">
<p>
Set hybrid line numbers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">toggle-line-numbers</span> ()
  <span class="org-doc">"Toggle line numbers."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">setq-local</span> display-line-numbers
              (<span class="org-keyword">if</span> (equal display-line-numbers nil) 'relative nil)))


(add-hook 'prog-mode-hook #'toggle-line-numbers)
(add-hook 'LaTeX-mode-hook #'toggle-line-numbers)
</pre>
</div>

<p>
Added option for temporary line numbers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">began-line-toggle</span> nil
  <span class="org-doc">"Whether line numbers have currently been toggled."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">cautious-line-toggle</span> ()
  <span class="org-doc">"Toggle line numbers temporarily if began-line-toggle is nil"</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (not began-line-toggle) (not (derived-mode-p 'prog-mode)))
      (<span class="org-keyword">progn</span>
        (toggle-line-numbers)
        (<span class="org-keyword">setq</span> began-line-toggle t))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">show line numbers when using numerical prefix </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'prefix-command-preserve-state-hook #'cautious-line-toggle)</span>


(add-hook 'pre-command-hook #'(<span class="org-keyword">lambda</span> ()
                                (<span class="org-keyword">interactive</span>)
                                (<span class="org-keyword">if</span> began-line-toggle
                                    (<span class="org-keyword">progn</span>
                                      (toggle-line-numbers)
                                      (<span class="org-keyword">setq</span> began-line-toggle nil)))))
</pre>
</div>

<p>
Hide line numbers for term.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'term-mode-hook (<span class="org-keyword">lambda</span> () (<span class="org-keyword">setq-local</span> display-line-numbers nil)))
</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span class="org-string">"N"</span> #'cautious-line-toggle)
</pre>
</div>
</div>
</div>

<div id="outline-container-org5fe8432" class="outline-3">
<h3 id="org5fe8432">Window/frame</h3>
<div class="outline-text-3" id="text-org5fe8432">
<p>
Clean interface.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">remove menu and tool bar</span>
(tool-bar-mode -1)
(menu-bar-mode -1)


<span class="org-comment-delimiter">;; </span><span class="org-comment">remove scrollbar</span>
(toggle-scroll-bar -1)


<span class="org-comment-delimiter">;; </span><span class="org-comment">remove title</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">erase-title</span> ()
  (<span class="org-keyword">setq</span> frame-title-format
        (<span class="org-keyword">if</span> (equal frame-title-format <span class="org-string">""</span>) <span class="org-string">"\n"</span> <span class="org-string">""</span>)))

(run-with-timer 0 5 #'erase-title)
</pre>
</div>

<p>
Resize frame natively (cf. by columns/rows).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> frame-resize-pixelwise t)
</pre>
</div>

<p>
Set margins.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(fringe-mode 0)
(<span class="org-keyword">setq-default</span> left-margin-width 2)
(<span class="org-keyword">setq-default</span> right-margin-width 2)
</pre>
</div>

<p>
Hide macOS &ldquo;frame&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'default-frame-alist '(ns-transparent-titlebar . t))
(add-to-list 'default-frame-alist '(ns-appearance . dark))

(<span class="org-keyword">setq-default</span> ns-use-proxy-icon nil)
</pre>
</div>

<p>
Set default frame size.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">if</span> (window-system) (set-frame-size (selected-frame) 110 30))
</pre>
</div>

<p>
Raise frame by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'server-switch-hook (<span class="org-keyword">lambda</span> () (select-frame-set-input-focus (selected-frame))))
</pre>
</div>

<p>
Make sure client loading doesn&rsquo;t make Emacs forget this whole
configuration thing ever happened.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">default-frame-height</span> 30)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">default-frame-width</span> 110)

(<span class="org-keyword">defvar</span> <span class="org-variable-name">default-frame-pixel-height</span> nil)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">default-frame-pixel-width</span> nil)


(add-to-list 'after-make-frame-functions
             #'(<span class="org-keyword">lambda</span> (frame)
                 (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> (not default-frame-pixel-height) (not default-frame-width))
                   (<span class="org-keyword">setq-default</span> default-frame-pixel-height (frame-outer-height frame))
                   (<span class="org-keyword">setq-default</span> default-frame-pixel-width (frame-outer-width frame)))))


(add-hook 'before-make-frame-hook
          #'(<span class="org-keyword">lambda</span> ()
              (add-to-list 'default-frame-alist '(vertical-scroll-bars . nil))
              (add-to-list 'default-frame-alist `(height . ,default-frame-height))
              (add-to-list 'default-frame-alist `(width  . ,default-frame-width))))
</pre>
</div>

<p>
Center window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">should-center-frame</span> t)


(<span class="org-keyword">defun</span> <span class="org-function-name">center-frame</span> (frame)
  (<span class="org-keyword">if</span> should-center-frame
      (modify-frame-parameters
       frame '((user-position . t) (top . 0.5) (left . 0.5)))))

(add-to-list 'after-make-frame-functions #'center-frame)
</pre>
</div>

<p>
Close current window (vim-style).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span class="org-string">"M-w"</span>) 'evil-quit)
</pre>
</div>

<p>
Transpose frame.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key global-map (kbd <span class="org-string">"M-t"</span>) #'transpose-frame)
</pre>
</div>

<p>
Navigate between windows (splits).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span class="org-string">"M-h"</span>) 'evil-window-left)
(global-set-key (kbd <span class="org-string">"M-j"</span>) 'evil-window-down)
(global-set-key (kbd <span class="org-string">"M-k"</span>) 'evil-window-up)
(global-set-key (kbd <span class="org-string">"M-l"</span>) 'evil-window-right)
</pre>
</div>

<p>
Autoselect window with mouse on it.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> mouse-autoselect-window t)
</pre>
</div>

<p>
Split vertically by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> split-width-threshold 0)
(<span class="org-keyword">setq-default</span> split-height-threshold nil)
</pre>
</div>

<p>
Transpose frame.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">transpose-frame</span>)
</pre>
</div>

<p>
Resize window more easily.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span class="org-string">"C-c w"</span>) #'evil-window-set-width)
(global-set-key (kbd <span class="org-string">"C-c h"</span>) #'evil-window-set-height)
</pre>
</div>

<p>
Begin crusade against popup windows.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> pop-up-windows nil)
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">open non-fullscreen window</span>
(evil-leader/set-key (kbd <span class="org-string">"-"</span>) #'(<span class="org-keyword">lambda</span> ()
                                   (<span class="org-keyword">interactive</span>)
                                   (make-frame '((user-position . t) (top . 0.5) (left . 0.5)))
                                   (run-at-time .2 nil (<span class="org-keyword">lambda</span> ()
                                                         (set-frame-parameter nil 'fullscreen nil)
                                                         (center-frame (selected-frame))))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">open fullscreen window</span>
(evil-leader/set-key (kbd <span class="org-string">"_"</span>) #'(<span class="org-keyword">lambda</span> ()
                                   (<span class="org-keyword">interactive</span>)
                                   (make-frame '((fullscreen . fullboth)))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">switch frames easily</span>
(evil-leader/set-key <span class="org-string">"O"</span> #'other-frame)


<span class="org-comment-delimiter">;; </span><span class="org-comment">balance out window sizes</span>
(evil-leader/set-key <span class="org-string">"W"</span> #'balance-windows)


<span class="org-comment-delimiter">;; </span><span class="org-comment">recenter frame</span>
(evil-leader/set-key <span class="org-string">"0"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (set-frame-parameter nil 'width default-frame-width)
                             (set-frame-parameter nil 'height default-frame-height)
                             (center-frame (selected-frame))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">quit emacs -- shouldn't technically be here</span>
(evil-leader/set-key (kbd <span class="org-string">"q"</span>) #'(<span class="org-keyword">lambda</span> ()
                                   (<span class="org-keyword">interactive</span>)
                                   (kill-all-buffers-except-scratch)
                                   (<span class="org-keyword">when</span> (yes-or-no-p <span class="org-string">"Truly really truly quit Emacs? "</span>)
                                     (kill-emacs))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">toggle fullscreen more easily</span>
(evil-leader/set-key (kbd <span class="org-string">"RET"</span>) #'toggle-frame-fullscreen)


<span class="org-comment-delimiter">;; </span><span class="org-comment">swap window sides</span>
(evil-leader/set-key (kbd <span class="org-string">"y"</span>) #'window-swap-states)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgab63e03" class="outline-3">
<h3 id="orgab63e03">Mode line</h3>
<div class="outline-text-3" id="text-orgab63e03">
<p>
Mode line config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(mood-line-mode)

(<span class="org-keyword">setq-default</span> display-time-default-load-average nil)
(<span class="org-keyword">setq-default</span> display-time-day-and-date t)
(<span class="org-keyword">setq-default</span> display-time-format <span class="org-string">" %H:%M"</span>)
(display-time)
</pre>
</div>

<p>
Custom faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'mood-line-buffer-name nil
                    <span class="org-builtin">:inherit</span> 'mode-line-buffer-id
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-major-mode nil
                    <span class="org-builtin">:inherit</span> 'bold
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-modified nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-error nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-info nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-neutral nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-success nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-status-warning nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)


(set-face-attribute 'mood-line-unimportant nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#ebdbb2"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">mood-line</span>
  <span class="org-builtin">:config</span>
  &lt;&lt;mode-line-config&gt;&gt;
  &lt;&lt;mood-line-faces&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org29dd0d6" class="outline-3">
<h3 id="org29dd0d6">Encoding</h3>
<div class="outline-text-3" id="text-org29dd0d6">
<p>
Sort of inelegant (but seemingly standard) way of adding ligature
support.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">let</span> ((alist `((?! . ,(regexp-opt '(<span class="org-string">"!!"</span> <span class="org-string">"!="</span> <span class="org-string">"!=="</span>)))
               (?# . ,(regexp-opt '(<span class="org-string">"##"</span> <span class="org-string">"###"</span> <span class="org-string">"####"</span> <span class="org-string">"#("</span> <span class="org-string">"#?"</span> <span class="org-string">"#["</span> <span class="org-string">"#_"</span> <span class="org-string">"#_("</span> <span class="org-string">"#{"</span>)))
               (?$ . ,(regexp-opt '(<span class="org-string">"$&gt;"</span>)))
               (?% . ,(regexp-opt '(<span class="org-string">"%%"</span>)))
               (?&amp; . ,(regexp-opt '(<span class="org-string">"&amp;&amp;"</span>)))
               (?* . ,(regexp-opt '(<span class="org-string">"*"</span> <span class="org-string">"**"</span> <span class="org-string">"***"</span> <span class="org-string">"**/"</span> <span class="org-string">"*/"</span> <span class="org-string">"*&gt;"</span>)))
               (?+ . ,(regexp-opt '(<span class="org-string">"+"</span> <span class="org-string">"++"</span> <span class="org-string">"+++"</span> <span class="org-string">"+&gt;"</span>)))
               (?- . ,(regexp-opt '(<span class="org-string">"--"</span> <span class="org-string">"---"</span> <span class="org-string">"--&gt;"</span> <span class="org-string">"-&lt;"</span> <span class="org-string">"-&lt;&lt;"</span> <span class="org-string">"-&gt;"</span> <span class="org-string">"-&gt;&gt;"</span> <span class="org-string">"-}"</span> <span class="org-string">"-~"</span>)))
               (?. . ,(regexp-opt '(<span class="org-string">".-"</span> <span class="org-string">".."</span> <span class="org-string">"..."</span> <span class="org-string">"..&lt;"</span> <span class="org-string">".="</span>)))
               (?/ . ,(regexp-opt '(<span class="org-string">"/*"</span> <span class="org-string">"/**"</span> <span class="org-string">"//"</span> <span class="org-string">"///"</span> <span class="org-string">"/="</span> <span class="org-string">"/=="</span> <span class="org-string">"/&gt;"</span>)))
               (?: . ,(regexp-opt '(<span class="org-string">":"</span> <span class="org-string">"::"</span> <span class="org-string">":::"</span> <span class="org-string">":="</span>)))
               (?\; . ,(regexp-opt '(<span class="org-string">";;"</span>)))
               (?&lt; . ,(regexp-opt '(<span class="org-string">"&lt;!--"</span> <span class="org-string">"&lt;$"</span> <span class="org-string">"&lt;$&gt;"</span> <span class="org-string">"&lt;*"</span> <span class="org-string">"&lt;*&gt;"</span> <span class="org-string">"&lt;+"</span> <span class="org-string">"&lt;+&gt;"</span> <span class="org-string">"&lt;-"</span> <span class="org-string">"&lt;--"</span> <span class="org-string">"&lt;-&gt;"</span> <span class="org-string">"&lt;/"</span> <span class="org-string">"&lt;/&gt;"</span> <span class="org-string">"&lt;&lt;"</span> <span class="org-string">"&lt;&lt;-"</span> <span class="org-string">"&lt;&lt;&lt;"</span> <span class="org-string">"&lt;&lt;="</span> <span class="org-string">"&lt;="</span> <span class="org-string">"&lt;="</span> <span class="org-string">"&lt;=&lt;"</span> <span class="org-string">"&lt;=="</span> <span class="org-string">"&lt;=&gt;"</span> <span class="org-string">"&lt;&gt;"</span> <span class="org-string">"&lt;|"</span> <span class="org-string">"&lt;|&gt;"</span> <span class="org-string">"&lt;~"</span> <span class="org-string">"&lt;~~"</span>)))
               (?= . ,(regexp-opt '(<span class="org-string">"=/="</span> <span class="org-string">"=:="</span> <span class="org-string">"=&lt;&lt;"</span> <span class="org-string">"=="</span> <span class="org-string">"==="</span> <span class="org-string">"==&gt;"</span> <span class="org-string">"=&gt;"</span> <span class="org-string">"=&gt;&gt;"</span>)))
               (?&gt; . ,(regexp-opt '(<span class="org-string">"&gt;-"</span> <span class="org-string">"&gt;="</span> <span class="org-string">"&gt;=&gt;"</span> <span class="org-string">"&gt;&gt;"</span> <span class="org-string">"&gt;&gt;-"</span> <span class="org-string">"&gt;&gt;="</span> <span class="org-string">"&gt;&gt;&gt;"</span>)))
               (?? . ,(regexp-opt '(<span class="org-string">"??"</span> <span class="org-string">"?="</span>)))
               (?\[ . ,(regexp-opt '(<span class="org-string">"[]"</span>)))
               (?\\ . ,(regexp-opt '(<span class="org-string">"\\\\"</span> <span class="org-string">"\\\\\\"</span>)))
               (?^ . ,(regexp-opt '(<span class="org-string">"^="</span>)))
               (?w . ,(regexp-opt '(<span class="org-string">"www"</span>)))
               (?x . ,(regexp-opt '(<span class="org-string">"x"</span>)))
               (?{ . ,(regexp-opt '(<span class="org-string">"{-"</span>)))
               (?| . ,(regexp-opt '(<span class="org-string">"|="</span> <span class="org-string">"|&gt;"</span> <span class="org-string">"||"</span> <span class="org-string">"||="</span>)))
               (?~ . ,(regexp-opt '(<span class="org-string">"~-"</span> <span class="org-string">"~="</span> <span class="org-string">"~&gt;"</span> <span class="org-string">"~@"</span> <span class="org-string">"~~"</span> <span class="org-string">"~~&gt;"</span>)))
               <span class="org-comment-delimiter">;;;</span><span class="org-comment">(?F . ,(regexp-opt '("F_vec")))</span>
               )))
  (<span class="org-keyword">dolist</span> (char-regexp alist)
    (set-char-table-range composition-function-table (car char-regexp)
                          `([,(cdr char-regexp) 0 font-shape-gstring]))))
</pre>
</div>

<p>
Use fira code for Greek letters in vterm.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'vterm-mode-hook (<span class="org-keyword">lambda</span> ()
                             (set-fontset-font (face-attribute 'default <span class="org-builtin">:fontset</span>)
                                               '(#x0370 . #x03FF) (font-spec <span class="org-builtin">:family</span> <span class="org-string">"Fira Code"</span>) nil 'prepend)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d6a619" class="outline-3">
<h3 id="org6d6a619">Prettify symbols</h3>
<div class="outline-text-3" id="text-org6d6a619">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">add-visual-replacement</span> (from to)
  <span class="org-doc">"Make `</span><span class="org-doc"><span class="org-constant">prettify-symbols-mode</span></span><span class="org-doc">' replace string FROM with string TO.</span>

<span class="org-doc">Updates `</span><span class="org-doc"><span class="org-constant">prettify-symbols-alist</span></span><span class="org-doc">'.  You may need to toggle</span>
<span class="org-doc">`</span><span class="org-doc"><span class="org-constant">prettify-symbols-mode</span></span><span class="org-doc">' to make the changes take effect.</span>

<span class="org-doc">Each character of TO is vertically aligned using the baseline,</span>
<span class="org-doc">such that base-left of the character is aligned with base-right</span>
<span class="org-doc">of the preceding character.  Refer to `</span><span class="org-doc"><span class="org-constant">reference-point-alist</span></span><span class="org-doc">'</span>
<span class="org-doc">for more information."</span>
  (<span class="org-keyword">push</span> (cons from (<span class="org-keyword">let</span> ((composition nil))
                     (<span class="org-keyword">dolist</span> (char (string-to-list to)
                                   (nreverse (cdr composition)))
                       (<span class="org-keyword">push</span> char composition)
                       (<span class="org-keyword">push</span> '(Br . Bl) composition))))
        prettify-symbols-alist))


(add-hook 'org-mode-hook (<span class="org-keyword">lambda</span> ()
                           (add-visual-replacement <span class="org-string">"---"</span> <span class="org-string">"&#9472;&#9472;"</span>)

                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\sqrt"</span> . <span class="org-string">"&#8730;"</span>) prettify-symbols-alist)

                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\text"</span> . <span class="org-string">"&#8203;"</span>) prettify-symbols-alist)

                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\left("</span> . <span class="org-string">"("</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\right)"</span> . <span class="org-string">")"</span>) prettify-symbols-alist)
                           (add-visual-replacement <span class="org-string">"\\right)^2"</span> <span class="org-string">")&#178;"</span>)
                           (add-visual-replacement <span class="org-string">"\\right)^3"</span> <span class="org-string">")&#179;"</span>)

                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\left|"</span> . <span class="org-string">"|"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\right|"</span> . <span class="org-string">"|"</span>) prettify-symbols-alist)
                           (add-visual-replacement <span class="org-string">"\\right|^2"</span> <span class="org-string">"|&#178;"</span>)
                           (add-visual-replacement <span class="org-string">"\\right|^3"</span> <span class="org-string">"|&#179;"</span>)

                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\left["</span> .  <span class="org-string">"["</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\right]"</span> . <span class="org-string">"]"</span>) prettify-symbols-alist)
                           (add-visual-replacement <span class="org-string">"\\right]^2"</span> <span class="org-string">"]&#178;"</span>)
                           (add-visual-replacement <span class="org-string">"\\right]^3"</span> <span class="org-string">"]&#179;"</span>)

                           (add-visual-replacement <span class="org-string">"\\left\\Vert"</span> <span class="org-string">"||"</span>)
                           (add-visual-replacement <span class="org-string">"\\right\\Vert"</span> <span class="org-string">"||"</span>)

                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\vecb{a}"</span> . <span class="org-string">"&#119938;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\vecb{b}"</span> . <span class="org-string">"&#119939;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\vecb{c}"</span> . <span class="org-string">"&#119940;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\vecb{u}"</span> . <span class="org-string">"&#119958;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\vecb{v}"</span> . <span class="org-string">"&#119959;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\vecb{r}"</span> . <span class="org-string">"&#119955;"</span>) prettify-symbols-alist)

                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\left\\langle"</span> .  <span class="org-string">"&#12296;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"\\right\\rangle"</span> .  <span class="org-string">"&#12297;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"[ ]"</span> .  <span class="org-string">"&#9744;"</span>) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"[X]"</span> . <span class="org-string">"&#9745;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"[-]"</span> . <span class="org-string">"&#10061;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+BEGIN_SRC"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+END_SRC"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+BEGIN_EXAMPLE"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+END_EXAMPLE"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+BEGIN_QUOTE"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+END_QUOTE"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+BEGIN_VERSE"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+END_VERSE"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+begin_verse"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+end_verse"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+begin_quote"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+end_quote"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+begin_example"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+end_example"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+begin_src"</span> . <span class="org-string">"&#8614;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+end_src"</span> . <span class="org-string">"&#8676;"</span> ) prettify-symbols-alist)
                           (<span class="org-keyword">push</span> '(<span class="org-string">"#+title: "</span> . <span class="org-string">"&#8203;"</span> ) prettify-symbols-alist)
                           (prettify-symbols-mode)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org286749a" class="outline-2">
<h2 id="org286749a">Evil</h2>
<div class="outline-text-2" id="text-org286749a">
<p>
Set all the necessary init variables.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> evil-want-keybinding nil)         <span class="org-comment-delimiter">; </span><span class="org-comment">evil-collection compatibility</span>
(<span class="org-keyword">setq-default</span> evil-search-module 'evil-search)  <span class="org-comment-delimiter">; </span><span class="org-comment">use vim-style searching</span>
(<span class="org-keyword">setq-default</span> evil-undo-system 'undo-tree)      <span class="org-comment-delimiter">; </span><span class="org-comment">use better undo system based on vim</span>
(<span class="org-keyword">setq-default</span> evil-vsplit-window-right t)       <span class="org-comment-delimiter">; </span><span class="org-comment">split right</span>
(<span class="org-keyword">setq-default</span> evil-split-window-below t)        <span class="org-comment-delimiter">; </span><span class="org-comment">split down</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">new digraphs</span>
(<span class="org-keyword">setq-default</span> evil-digraphs-table-user '(((?r ?a) . ?\x2192)
                                         ((?  ? ) . ?\x200b)
                                         ((?t ?h) . ?\x03b8)
                                         ((?p ?i) . ?\x03c0)
                                         ((?p ?h) . ?\x03c6)
                                         ((?l ?a) . ?\x03bb)
                                         ((?o ?m) . ?\x03c9)
                                         ((?n ?u) . ?\x03bd)
                                         ((?b ?e) . ?\x03b2)
                                         ((?g ?a) . ?\x03b3)
                                         ((?t ?a) . ?\x03c4)
                                         ((?a ?l) . ?\x03b1)
                                         ((?r ?h) . ?\x03c1)
                                         ((?m ?m) . ?\x03bc)
                                         ((?. ?.) . ?\x0307)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">change cursor colors based on mode (state)</span>
(<span class="org-keyword">setq-default</span> evil-emacs-state-cursor '(<span class="org-string">"white"</span> box))
(<span class="org-keyword">setq-default</span> evil-normal-state-cursor '(<span class="org-string">"#fdf4c1"</span> box))
(<span class="org-keyword">setq-default</span> evil-visual-state-cursor '(<span class="org-string">"orange"</span> box))
(<span class="org-keyword">setq-default</span> evil-insert-state-cursor '(<span class="org-string">"#fdf4c1"</span> bar))
(<span class="org-keyword">setq-default</span> evil-replace-state-cursor '(<span class="org-string">"orange"</span> hollow))
(<span class="org-keyword">setq-default</span> evil-operator-state-cursor '(<span class="org-string">"orange"</span> hollow))


<span class="org-comment-delimiter">;; </span><span class="org-comment">set state change messages</span>
(<span class="org-keyword">setq-default</span> evil-insert-state-message <span class="org-string">""</span>)
(<span class="org-keyword">setq-default</span> evil-visual-state-message <span class="org-string">""</span>)
</pre>
</div>

<p>
Face configuration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'evil-ex-search nil
                    <span class="org-builtin">:background</span> <span class="org-string">"#81a2be"</span>
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#0d0d0d"</span>
                    <span class="org-builtin">:weight</span> 'normal)
</pre>
</div>

<p>
General evil-mode config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-mode 1)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use vim-style paragraphs</span>
(<span class="org-keyword">defadvice</span> <span class="org-function-name">forward-evil-paragraph</span> (around default-values activate)
  (<span class="org-keyword">let</span> ((paragraph-start (default-value 'paragraph-start))
        (paragraph-separate (default-value 'paragraph-separate)))
    ad-do-it))
</pre>
</div>

<p>
General key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">key-chord</span>
  <span class="org-builtin">:load-path</span> <span class="org-string">"lisp/"</span>
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq-default</span> key-chord-two-keys-delay 0.2)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">redefine chord definition so that keys can't be reversed</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">key-chord-define</span> (keymap keys command)
    <span class="org-doc">"Define in KEYMAP, a key-chord of the two keys in KEYS starting a COMMAND.</span>

<span class="org-doc">KEYS can be a string or a vector of two elements. Currently only</span>
<span class="org-doc">elements that corresponds to ascii codes in the range 32 to 126</span>
<span class="org-doc">can be used.</span>

<span class="org-doc">COMMAND can be an interactive function, a string, or nil.</span>
<span class="org-doc">If COMMAND is nil, the key-chord is removed."</span>
    (<span class="org-keyword">if</span> (/= 2 (length keys))
        (<span class="org-warning">error</span> <span class="org-string">"Key-chord keys must have two elements"</span>))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Exotic chars in a string are &gt;255 but define-key wants 128..255</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">for those.</span>
    (<span class="org-keyword">let</span> ((key1 (logand 255 (aref keys 0)))
          (key2 (logand 255 (aref keys 1))))
      (define-key keymap (vector 'key-chord key1 key2) command)))


  <span class="org-comment-delimiter">;; </span><span class="org-comment">bind jk to normal state</span>
  (key-chord-define evil-insert-state-map <span class="org-string">"jk"</span> 'evil-normal-state)
  (key-chord-mode 1)


  (add-hook 'input-method-deactivate-hook #'(<span class="org-keyword">lambda</span> () (key-chord-mode 1))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure C-j executes in the command window</span>
(define-key evil-command-window-mode-map (kbd <span class="org-string">"C-j"</span>) 'evil-command-window-execute)


<span class="org-comment-delimiter">;; </span><span class="org-comment">remap Y to sensible function</span>
(define-key evil-normal-state-map (kbd <span class="org-string">"Y"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                (<span class="org-keyword">interactive</span>)
                                                (evil-yank (point) (line-end-position))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">convenient macro execution</span>
(define-key evil-normal-state-map (kbd <span class="org-string">"RET"</span>) (kbd <span class="org-string">"@q"</span>))
(define-key evil-visual-state-map (kbd <span class="org-string">"RET"</span>) (kbd <span class="org-string">"@q"</span>))


<span class="org-comment-delimiter">;; </span><span class="org-comment">select contents of last paste</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">evil-select-pasted</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((start-marker (evil-get-marker ?\[))
        (end-marker (evil-get-marker ?\])))
    (evil-visual-select start-marker end-marker)))

(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"g b"</span>) #'evil-select-pasted)


<span class="org-comment-delimiter">;; </span><span class="org-comment">increment/decrement at point</span>
(<span class="org-keyword">use-package</span> <span class="org-constant">evil-numbers</span>
  <span class="org-builtin">:config</span>
  (define-key global-map (kbd <span class="org-string">"C-9"</span>) #'evil-numbers/dec-at-pt)
  (define-key global-map (kbd <span class="org-string">"C-0"</span>) #'evil-numbers/inc-at-pt))


<span class="org-comment-delimiter">;; </span><span class="org-comment">go to beginning and end of visual line by default</span>
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"0"</span>) #'evil-beginning-of-visual-line)
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"$"</span>) #'evil-end-of-visual-line)


<span class="org-comment-delimiter">;; </span><span class="org-comment">convenient remap for ex state</span>
(<span class="org-keyword">evil-define-key</span> nil evil-normal-state-map <span class="org-string">";"</span> 'evil-ex)
(<span class="org-keyword">evil-define-key</span> nil evil-visual-state-map <span class="org-string">";"</span> 'evil-ex)
(<span class="org-keyword">evil-define-key</span> 'normal 'dired-mode-map <span class="org-string">";"</span> 'evil-ex)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil</span>
  <span class="org-builtin">:init</span>
  &lt;&lt;evil-variables&gt;&gt;

  <span class="org-builtin">:config</span>
  &lt;&lt;evil-faces&gt;&gt;
  &lt;&lt;evil-leader&gt;&gt;
  &lt;&lt;evil-config&gt;&gt;
  &lt;&lt;evil-keybindings&gt;&gt;)
</pre>
</div>
</div>

<div id="outline-container-org0200c0e" class="outline-3">
<h3 id="org0200c0e">Evil leader</h3>
<div class="outline-text-3" id="text-org0200c0e">
<p>
Let other parts of config create keybindings with evil
leader. Remember to update this with the noweb reference in order to
include bindings. Also, note that this will be evaluated after evil
mode&rsquo;s variables are set and right before the rest of the evil config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">I may eventually move this out</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">kill-all-other-buffers</span> ()
  <span class="org-doc">"Kill all buffers except for this and *scratch*."</span>
  (<span class="org-keyword">interactive</span>)
  (mapc 'kill-buffer 
        (delete (current-buffer)
                (delete (get-buffer <span class="org-string">"*scratch*"</span>) (buffer-list))))
  (message <span class="org-string">"Killed all buffers except this and *scratch*."</span>))


(<span class="org-keyword">use-package</span> <span class="org-constant">evil-leader</span>
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq-default</span> evil-leader/in-all-states 1)

  <span class="org-builtin">:config</span>
  (global-evil-leader-mode)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">set leader</span>
  (evil-leader/set-leader <span class="org-string">"SPC"</span>)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">convenient saving</span>
  (evil-leader/set-key <span class="org-string">"f"</span> #'(<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">interactive</span>)
                               (<span class="org-keyword">cond</span>
                                ((string-prefix-p <span class="org-string">"*scratch"</span> (buffer-name)) (message <span class="org-string">"(No changes need to be saved)"</span>))
                                ((equal major-mode 'wdired-mode) (wdired-finish-edit))
                                ((equal major-mode 'org-agenda-mode)
                                 (org-save-all-org-buffers)
                                 (message <span class="org-string">"Org buffers saved."</span>)
                                 (progenda-publish-schedule))
                                (t
                                 (<span class="org-keyword">if</span> (buffer-modified-p)
                                     (message <span class="org-string">"Wrote %s."</span> (<span class="org-keyword">if</span> (null (buffer-file-name))
                                                              <span class="org-string">"file"</span>
                                                            (file-name-nondirectory (buffer-file-name))))
                                   (message <span class="org-string">"(No changes need to be saved)"</span>))
                                 (<span class="org-keyword">with-suppressed-message</span>
                                     (call-interactively #'save-buffer))))))


  <span class="org-comment-delimiter">;; </span><span class="org-comment">convenient exiting</span>
  (evil-leader/set-key <span class="org-string">"e"</span> #'(<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">interactive</span>)
                               (<span class="org-keyword">if</span> (equal major-mode 'org-agenda-mode)
                                   (org-agenda-exit)
                                 (kill-this-buffer))))
  (evil-leader/set-key <span class="org-string">"E"</span> #'kill-all-other-buffers)
  (evil-leader/set-key <span class="org-string">"x"</span> #'(<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">interactive</span>)
                               (save-buffer)
                               (kill-this-buffer)))


  <span class="org-comment-delimiter">;; </span><span class="org-comment">delete current file</span>
  (evil-leader/set-key <span class="org-string">"D"</span> #'(<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">interactive</span>)
                               (<span class="org-keyword">if</span> (yes-or-no-p <span class="org-string">"Really truly really delete this file? "</span>)
                                   (delete-file (buffer-file-name)))))


  <span class="org-comment-delimiter">;; </span><span class="org-comment">display current time</span>
  (evil-leader/set-key <span class="org-string">"j"</span> #'(<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">interactive</span>)
                               (message (format-time-string <span class="org-string">"%H:%M:%S &#8213; %d %b, %Y"</span>))))


  <span class="org-comment-delimiter">;; </span><span class="org-comment">convenient way to evaluate buffer</span>
  (evil-leader/set-key <span class="org-string">"v"</span> #'eval-buffer)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">convenient terminal opening</span>
  (evil-leader/set-key <span class="org-string">"t"</span> #'(<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">interactive</span>)
                               (vterm (format
                                       <span class="org-string">"*vterm-%s*"</span>
                                       (make-temp-name <span class="org-string">""</span>)))))


  &lt;&lt;calendar-leader&gt;&gt;
  &lt;&lt;capture-leader&gt;&gt;
  &lt;&lt;dictionary-leader&gt;&gt;
  &lt;&lt;dired-leader&gt;&gt;
  &lt;&lt;editing-leader&gt;&gt;
  &lt;&lt;git-leader&gt;&gt;
  &lt;&lt;helm-leader&gt;&gt;
  &lt;&lt;line-number-leader&gt;&gt;
  &lt;&lt;mac-leader&gt;&gt;
  &lt;&lt;mail-leader&gt;&gt;
  &lt;&lt;olivetti-leader&gt;&gt;
  &lt;&lt;org-agenda-leader&gt;&gt;
  &lt;&lt;org-mode-leader&gt;&gt;
  &lt;&lt;scratch-leader&gt;&gt;
  &lt;&lt;script-leader&gt;&gt;
  &lt;&lt;snippet-leader&gt;&gt;
  &lt;&lt;spelling-leader&gt;&gt;
  &lt;&lt;templating-leader&gt;&gt;
  &lt;&lt;window-frame-leader&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge5cf859" class="outline-3">
<h3 id="orge5cf859">Evil surround</h3>
<div class="outline-text-3" id="text-orge5cf859">
<p>
Like tpope&rsquo;s <code>vim-surround</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil-surround</span>
  <span class="org-builtin">:config</span>
  (global-evil-surround-mode 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org39ec145" class="outline-3">
<h3 id="org39ec145">Evil collection</h3>
<div class="outline-text-3" id="text-org39ec145">
<p>
This package adds evil keybindings to many different modes.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil-collection</span>
  <span class="org-builtin">:after</span> evil
  <span class="org-builtin">:config</span>
  (evil-collection-init))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgead68b1" class="outline-3">
<h3 id="orgead68b1">Evil args</h3>
<div class="outline-text-3" id="text-orgead68b1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil-args</span>
  <span class="org-builtin">:config</span>
  (define-key evil-inner-text-objects-map <span class="org-string">"g"</span> 'evil-inner-arg)
  (define-key evil-outer-text-objects-map <span class="org-string">"g"</span> 'evil-outer-arg)
  (define-key evil-normal-state-map <span class="org-string">"L"</span> 'evil-forward-arg)
  (define-key evil-normal-state-map <span class="org-string">"H"</span> 'evil-backward-arg))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a9728f" class="outline-3">
<h3 id="org0a9728f">Evil embrace</h3>
<div class="outline-text-3" id="text-org0a9728f">
<p>
Evil hugs. Very nasty.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">add-general-embrace-pairs</span> ()
  (embrace-add-pair ?\( <span class="org-string">"( "</span> <span class="org-string">" )"</span>)
  (embrace-add-pair ?\) <span class="org-string">"("</span> <span class="org-string">")"</span>)
  (embrace-add-pair ?\[ <span class="org-string">"[ "</span> <span class="org-string">" ]"</span>)
  (embrace-add-pair ?\] <span class="org-string">"["</span> <span class="org-string">"]"</span>)
  (embrace-add-pair ?\{ <span class="org-string">"{ "</span> <span class="org-string">" }"</span>)
  (embrace-add-pair ?\} <span class="org-string">"{"</span> <span class="org-string">"}"</span>))


(<span class="org-keyword">use-package</span> <span class="org-constant">evil-embrace</span>
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:config</span>
  (evil-embrace-enable-evil-surround-integration)

  (add-hook 'prog-mode-hook #'add-general-embrace-pairs)
  (add-hook 'text-mode-hook #'add-general-embrace-pairs)

  &lt;&lt;latex-mode-embrace&gt;&gt;
  &lt;&lt;org-mode-embrace&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0cf94da" class="outline-3">
<h3 id="org0cf94da">Evil owl</h3>
<div class="outline-text-3" id="text-org0cf94da">
<p>
Hire owls to report registers and marks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil-owl</span>
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> evil-owl-max-string-length 500)
  (add-to-list 'display-buffer-alist
               '(<span class="org-string">"*evil-owl*"</span>
                 (display-buffer-in-side-window)
                 (side . bottom)
                 (window-height . 0.3)))
  (evil-owl-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8fe60f9" class="outline-3">
<h3 id="org8fe60f9">Evil commentary</h3>
<div class="outline-text-3" id="text-org8fe60f9">
<p>
Better commenting based on tpope&rsquo;s vim-commentary.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil-commentary</span>
  <span class="org-builtin">:config</span>

  (evil-commentary-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7066526" class="outline-3">
<h3 id="org7066526">Evil little word</h3>
<div class="outline-text-3" id="text-org7066526">
<p>
For short, hurtful comments. And camel case motion.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil-little-word</span>
  <span class="org-builtin">:load-path</span> <span class="org-string">"lisp/"</span>
  <span class="org-builtin">:config</span>
  (define-key evil-normal-state-map (kbd <span class="org-string">"w"</span>) 'evil-forward-little-word-begin)
  (define-key evil-normal-state-map (kbd <span class="org-string">"b"</span>) 'evil-backward-little-word-begin)
  (define-key evil-operator-state-map (kbd <span class="org-string">"w"</span>) 'evil-forward-little-word-begin)
  (define-key evil-operator-state-map (kbd <span class="org-string">"b"</span>) 'evil-backward-little-word-begin)
  (define-key evil-visual-state-map (kbd <span class="org-string">"w"</span>) 'evil-forward-little-word-begin)
  (define-key evil-visual-state-map (kbd <span class="org-string">"b"</span>) 'evil-backward-little-word-begin)
  (define-key evil-visual-state-map (kbd <span class="org-string">"i w"</span>) 'evil-inner-little-word))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9d6abc" class="outline-3">
<h3 id="orgb9d6abc">Evil indent plus</h3>
<div class="outline-text-3" id="text-orgb9d6abc">
<p>
For indent-based text objects.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">evil-indent-plus</span>
  <span class="org-builtin">:config</span>
  (evil-indent-plus-default-bindings))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb925603" class="outline-2">
<h2 id="orgb925603">Navigation</h2>
<div class="outline-text-2" id="text-orgb925603">
<p>
Motion between and within lines.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">better line motion</span>
(define-key evil-normal-state-map (kbd <span class="org-string">"j"</span>) 'evil-next-visual-line)
(define-key evil-normal-state-map (kbd <span class="org-string">"k"</span>) 'evil-previous-visual-line)
(define-key evil-visual-state-map (kbd <span class="org-string">"j"</span>) 'evil-next-visual-line)
(define-key evil-visual-state-map (kbd <span class="org-string">"k"</span>) 'evil-previous-visual-line)


<span class="org-comment-delimiter">;; </span><span class="org-comment">repeat find char remap</span>
(define-key evil-normal-state-map (kbd <span class="org-string">"-"</span>) 'evil-repeat-find-char)
</pre>
</div>

<p>
Scrolling.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"J"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                  (<span class="org-keyword">interactive</span>)
                                                  (scroll-up 3)))
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"K"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                  (<span class="org-keyword">interactive</span>)
                                                  (scroll-down 3)))

(<span class="org-keyword">evil-define-key</span> 'visual global-map (kbd <span class="org-string">"J"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                  (<span class="org-keyword">interactive</span>)
                                                  (scroll-up 3)))
(<span class="org-keyword">evil-define-key</span> 'visual global-map (kbd <span class="org-string">"K"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                  (<span class="org-keyword">interactive</span>)
                                                  (scroll-down 3)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">smooth scrolling</span>
(<span class="org-keyword">setq-default</span> scroll-margin 5)
(<span class="org-keyword">setq-default</span> scroll-conservatively 9999)
(<span class="org-keyword">setq-default</span> scroll-step 1)


<span class="org-comment-delimiter">;; </span><span class="org-comment">allow horizontal scrolling with mouse</span>
(<span class="org-keyword">setq-default</span> mouse-wheel-tilt-scroll t)
(<span class="org-keyword">setq-default</span> mouse-wheel-flip-direction t)
</pre>
</div>

<p>
Searching.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">use backslash to end search highlighting</span>
(define-key evil-normal-state-map (kbd <span class="org-string">"\\"</span>) #'evil-ex-nohighlight)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use C-j in isearch</span>
(define-key isearch-mode-map (kbd <span class="org-string">"C-j"</span>) #'isearch-exit)


<span class="org-comment-delimiter">;; </span><span class="org-comment">travel between isearch occurences</span>
(define-key isearch-mode-map (kbd <span class="org-string">"C-n"</span>) #'isearch-repeat-forward)
(define-key isearch-mode-map (kbd <span class="org-string">"C-p"</span>) #'isearch-repeat-backward)
</pre>
</div>

<p>
Jumping.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">swap ' and `</span>
(define-key evil-normal-state-map (kbd <span class="org-string">"`"</span>) #'evil-goto-mark-line)
(define-key evil-normal-state-map (kbd <span class="org-string">"'"</span>) #'evil-goto-mark)


<span class="org-comment-delimiter">;; </span><span class="org-comment">jump to word with ace-jump-mode</span>
(<span class="org-keyword">use-package</span> <span class="org-constant">ace-jump-mode</span>
  <span class="org-builtin">:config</span>
  (define-key evil-normal-state-map (kbd <span class="org-string">"C-f"</span>) #'ace-jump-word-mode)

  (set-face-attribute 'ace-jump-face-foreground nil
                      <span class="org-builtin">:foreground</span> <span class="org-string">"#cc6666"</span>))
</pre>
</div>
</div>

<div id="outline-container-org4a54cef" class="outline-3">
<h3 id="org4a54cef">Buffer ring</h3>
<div class="outline-text-3" id="text-org4a54cef">
<p>
Create a ring of buffers. I may turn this into a small minor mode in
the future. This also happens to be my first &ldquo;actual&rdquo; emacs lisp
program.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">buffer-toggle-ring</span> '())
(<span class="org-keyword">defvar</span> <span class="org-variable-name">buffer-toggle-ring-index</span> 0)


(<span class="org-keyword">defun</span> <span class="org-function-name">display-buffer-toggle-ring</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (equal (length buffer-toggle-ring) 0)
      (message <span class="org-string">"Buffer ring empty."</span>)
    (message <span class="org-string">"%s"</span> (string-join
                   (mapcar (<span class="org-keyword">lambda</span> (buffer)
                             (propertize (buffer-name buffer) 'face 'helm-buffer-file))
                           buffer-toggle-ring)
                   <span class="org-string">"\n"</span>))))


(<span class="org-keyword">defun</span> <span class="org-function-name">remove-current-from-buffer-ring</span> ()
  <span class="org-doc">"Remove current buffer from buffer ring."</span>
  (<span class="org-keyword">when</span> (member (current-buffer) buffer-toggle-ring)
    (<span class="org-keyword">setq</span> buffer-toggle-ring (delete (current-buffer) buffer-toggle-ring))
    (display-buffer-toggle-ring)
    (<span class="org-keyword">setq</span> buffer-toggle-ring-index (- buffer-toggle-ring-index 1))))


(<span class="org-keyword">defun</span> <span class="org-function-name">toggle-buffer-in-buffer-ring</span> ()
  <span class="org-doc">"Add/remove current buffer from ring."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (member (current-buffer) buffer-toggle-ring)
      (remove-current-from-buffer-ring)
    (<span class="org-keyword">setq</span> buffer-toggle-ring (insert-after buffer-toggle-ring buffer-toggle-ring-index (current-buffer)))
    (display-buffer-toggle-ring)
    (<span class="org-keyword">setq</span> buffer-toggle-ring-index (+ buffer-toggle-ring-index 1))))


(<span class="org-keyword">defun</span> <span class="org-function-name">switch-to-next-buffer-in-ring</span> ()
  <span class="org-doc">"Switch to next buffer in ring."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">when</span> (&gt; (length buffer-toggle-ring) 0)
    (<span class="org-keyword">setq</span> buffer-toggle-ring-index (mod (+ buffer-toggle-ring-index 1) (length buffer-toggle-ring)))
    (switch-to-buffer (nth buffer-toggle-ring-index buffer-toggle-ring))))


(add-hook 'kill-buffer-hook #'remove-current-from-buffer-ring)


(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"&lt;S-backspace&gt;"</span>) #'toggle-buffer-in-buffer-ring)
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"&lt;backspace&gt;"</span>) #'switch-to-next-buffer-in-ring)
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"&lt;C-backspace&gt;"</span>) #'display-buffer-toggle-ring)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6507d60" class="outline-3">
<h3 id="org6507d60">Helm</h3>
<div class="outline-text-3" id="text-org6507d60">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">helm</span>
  <span class="org-builtin">:config</span>
  (helm-mode 1)

  (<span class="org-keyword">setq-default</span> helm-completion-style 'emacs)
  (<span class="org-keyword">setq-default</span> helm-left-margin-width 1)
  (<span class="org-keyword">setq-default</span> helm-buffers-left-margin-width 1)
  (<span class="org-keyword">setq-default</span> helm-buffer-details-flag nil)

  &lt;&lt;helm-keys&gt;&gt;
  &lt;&lt;helm-faces&gt;&gt;)
</pre>
</div>

<p>
Define <code>evil-leader</code> bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">open the minibuffer</span>
(evil-leader/set-key <span class="org-string">"k"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">let</span> ((pop-up-windows t))
                               (call-interactively #'helm-mini))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">open command minibuffer</span>
(evil-leader/set-key <span class="org-string">";"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">let</span> ((pop-up-windows t))
                               (call-interactively #'helm-M-x))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">for helm-ag</span>
(evil-leader/set-key <span class="org-string">"g"</span> #'helm-ag)
</pre>
</div>

<p>
Customize helm appearance.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'helm-candidate-number nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#BAA659"</span>
                    <span class="org-builtin">:background</span> <span class="org-string">"#121112"</span>)


(set-face-attribute 'helm-header-line-left-margin nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#BAB771"</span>
                    <span class="org-builtin">:background</span> <span class="org-string">"#121112"</span>)


(set-face-attribute 'helm-selection nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:background</span> <span class="org-string">"#191919"</span>
                    <span class="org-builtin">:weight</span> 'bold)


(set-face-attribute 'helm-ff-file-extension nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:foreground</span> 'unspecified)


(set-face-attribute 'helm-buffer-directory nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:background</span> 'unspecified
                    <span class="org-builtin">:foreground</span> 'unspecified
                    <span class="org-builtin">:underline</span> t
                    <span class="org-builtin">:weight</span> 'bold)


(set-face-attribute 'helm-source-header nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:background</span> <span class="org-string">"#121112"</span>
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#7d7461"</span>
                    <span class="org-builtin">:slant</span> 'italic
                    <span class="org-builtin">:family</span> <span class="org-string">"Victor Mono"</span>)


(set-face-attribute 'helm-buffer-saved-out nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:background</span> 'unspecified
                    <span class="org-builtin">:foreground</span> color-red)


(set-face-attribute 'helm-ff-denied nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:background</span> 'unspecified
                    <span class="org-builtin">:foreground</span> color-red)
</pre>
</div>

<p>
Define key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key helm-map (kbd <span class="org-string">"M-]"</span>) 'helm-next-source)
(define-key helm-map (kbd <span class="org-string">"M-["</span>) 'helm-previous-source)


(define-key helm-map (kbd <span class="org-string">"C-j"</span>) 'helm-confirm-and-exit-minibuffer)
(define-key helm-map (kbd <span class="org-string">"C-k"</span>) 'helm-execute-persistent-action)


(define-key helm-map (kbd <span class="org-string">"C-M-j"</span>) 'helm-cr-empty-string)


(define-key helm-read-file-map (kbd <span class="org-string">"C-j"</span>) 'helm-ff-RET)


(global-set-key (kbd <span class="org-string">"M-x"</span>) 'helm-M-x)
</pre>
</div>

<p>
Redefine buffers list to be more careful.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">helm-buffer-list</span> ()
  <span class="org-doc">"Return the current list of buffers.</span>
<span class="org-doc">The list is reordered with `</span><span class="org-doc"><span class="org-constant">helm-buffer-list-reorder-fn</span></span><span class="org-doc">'."</span>
  (helm-buffer-list-1))
</pre>
</div>
</div>

<div id="outline-container-org2e29e42" class="outline-4">
<h4 id="org2e29e42">Helm ag</h4>
<div class="outline-text-4" id="text-org2e29e42">
<p>
Ensure <code>helm-ag</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">helm-ag</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf0c5d38" class="outline-4">
<h4 id="orgf0c5d38">Helm projectile</h4>
<div class="outline-text-4" id="text-orgf0c5d38">
<p>
<code>helm-projectile</code> config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">helm-projectile</span>
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq-default</span> projectile-git-submodule-command nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">projectile not working until I figure it out</span>
  (<span class="org-keyword">setq-default</span> helm-mini-default-sources '(helm-source-bookmarks
                                            <span class="org-comment-delimiter">;; </span><span class="org-comment">helm-source-projectile-recentf-list</span>
                                            <span class="org-comment-delimiter">;; </span><span class="org-comment">helm-source-projectile-buffers-list</span>
                                            <span class="org-comment-delimiter">;; </span><span class="org-comment">helm-source-projectile-projects</span>
                                            <span class="org-comment-delimiter">;; </span><span class="org-comment">helm-source-projectile-files-list</span>
                                            helm-source-buffers-list
                                            helm-source-recentf)))
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdb40bef" class="outline-2">
<h2 id="orgdb40bef">Editing</h2>
<div class="outline-text-2" id="text-orgdb40bef">
<p>
General editing config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">tab width</span>
(<span class="org-keyword">setq-default</span> tab-width 4)
(<span class="org-keyword">setq-default</span> c-basic-offset 4)
(<span class="org-keyword">setq-default</span> indent-tabs-mode nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use C-j to join in visual mode</span>
(define-key evil-visual-state-map (kbd <span class="org-string">"C-j"</span>) #'evil-join)


<span class="org-comment-delimiter">;; </span><span class="org-comment">stop blinking, cursor. seriously.</span>
(blink-cursor-mode -1)


<span class="org-comment-delimiter">;; </span><span class="org-comment">show matching parenthesis</span>
(show-paren-mode t)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set fill column (obviously)</span>
(<span class="org-keyword">setq-default</span> fill-column 75)


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure sentences are not limited to those that are double-space-separated</span>
(<span class="org-keyword">setq-default</span> sentence-end-double-space nil)
</pre>
</div>

<p>
Hooks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">disable auto-fill-mode when asked politely</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">enable-polite-auto-fill</span> ()
  (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (org-keyword-activep <span class="org-string">"AUTOFILL"</span> nil)
             (not (org-keyword-activep <span class="org-string">"LITERARY"</span>)))
    (auto-fill-mode 1)))


(add-hook 'text-mode-hook #'enable-polite-auto-fill)


<span class="org-comment-delimiter">;; </span><span class="org-comment">highlight current line</span>
(add-hook 'prog-mode-hook #'hl-line-mode)
</pre>
</div>

<p>
Split paragraph into sentences.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">last-paragraph-sentence-split</span> nil
  <span class="org-doc">"Dotted list holding markers for the first and last paragraphs</span>
<span class="org-doc">after using split-paragraph-into-sentences."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">split-paragraph-into-sentences</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">save-excursion</span>
    (<span class="org-keyword">let*</span> ((sentence-count 0)
           (paragraph-bounds (<span class="org-keyword">if</span> (use-region-p)
                                 `(,(region-beginning) . ,(region-end))
                               (mark-paragraph)
                               `(,(point) . ,(mark))))
           (beginning-marker (<span class="org-keyword">progn</span>
                               (goto-char (car paragraph-bounds))
                               (point-marker))))
      (forward-sentence)
      (<span class="org-keyword">while</span> (&lt; (point) (cdr paragraph-bounds))
        (delete-char 1)
        (insert <span class="org-string">"\n\n"</span>)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(fill-paragraph)</span>
        (forward-sentence)
        (<span class="org-keyword">setq</span> sentence-count (+ 1 sentence-count)))
      (<span class="org-keyword">setq</span> last-paragraph-sentence-split
            `(,beginning-marker . ,(point-marker))))))


(<span class="org-keyword">defun</span> <span class="org-function-name">join-sentences-into-paragraph</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">save-excursion</span>
    (<span class="org-keyword">let</span> ((start (marker-position (car last-paragraph-sentence-split)))
          (end (marker-position (cdr last-paragraph-sentence-split))))
      (goto-char start)
      (join-line nil (+ 1 start) end)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(fill-paragraph)</span>
      )
    (<span class="org-keyword">setq</span> last-paragraph-sentence-split nil)))


(<span class="org-keyword">defun</span> <span class="org-function-name">toggle-sentence-split</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> last-paragraph-sentence-split
      (join-sentences-into-paragraph)
    (split-paragraph-into-sentences)))
</pre>
</div>

<p>
Rotate text (thanks, <a href="https://www.emacswiki.org/emacs/RotateText">Emacs Wiki</a>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">rotate-text-rotations</span>
  '((<span class="org-string">"true"</span> <span class="org-string">"false"</span>)
    (<span class="org-string">"True"</span> <span class="org-string">"False"</span>)
    (<span class="org-string">"yes"</span> <span class="org-string">"no"</span>)
    (<span class="org-string">"0"</span> <span class="org-string">"1"</span>)
    (<span class="org-string">"+"</span> <span class="org-string">"-"</span>))
  <span class="org-doc">"List of text rotation sets."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">rotate-region</span> (beg end)
  <span class="org-doc">"Rotate all matches in `</span><span class="org-doc"><span class="org-constant">rotate-text-rotations</span></span><span class="org-doc">' between point and mark."</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
  (<span class="org-keyword">let</span> ((regexp (rotate-convert-rotations-to-regexp
         rotate-text-rotations))
    (end-mark (copy-marker end)))
    (<span class="org-keyword">save-excursion</span>
      (goto-char beg)
      (<span class="org-keyword">while</span> (re-search-forward regexp (marker-position end-mark) t)
    (<span class="org-keyword">let*</span> ((found (match-string 0))
           (replace (rotate-next found)))
      (replace-match replace))))))


(<span class="org-keyword">defun</span> <span class="org-function-name">rotate-string</span> (string <span class="org-type">&amp;optional</span> rotations)
  <span class="org-doc">"Rotate all matches in STRING using associations in ROTATIONS.</span>
<span class="org-doc">If ROTATIONS are not given it defaults to `</span><span class="org-doc"><span class="org-constant">rotate-text-rotations</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">let</span> ((regexp (rotate-convert-rotations-to-regexp
         (<span class="org-keyword">or</span> rotations rotate-text-rotations)))
    (start 0))
    (<span class="org-keyword">while</span> (string-match regexp string start)
      (<span class="org-keyword">let*</span> ((found (match-string 0 string))
         (replace (rotate-next
               found
               (<span class="org-keyword">or</span> rotations rotate-text-rotations))))
    (<span class="org-keyword">setq</span> start (+ (match-end 0)
               (- (length replace) (length found))))
    (<span class="org-keyword">setq</span> string (replace-match replace nil t string))))
    string))


(<span class="org-keyword">defun</span> <span class="org-function-name">rotate-next</span> (string <span class="org-type">&amp;optional</span> rotations)
  <span class="org-doc">"Return the next element after STRING in ROTATIONS."</span>
  (<span class="org-keyword">let</span> ((rots (rotate-get-rotations-for
           string
           (<span class="org-keyword">or</span> rotations rotate-text-rotations))))
    (<span class="org-keyword">if</span> (&gt; (length rots) 1)
    (<span class="org-warning">error</span> (format <span class="org-string">"Ambiguous rotation for %s"</span> string))
      (<span class="org-keyword">if</span> (&lt; (length rots) 1)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">If we get this far, this should not occur:</span>
      (<span class="org-warning">error</span> (format <span class="org-string">"Unknown rotation for %s"</span> string))
    (<span class="org-keyword">let</span> ((occurs-in-rots (member string (car rots))))
      (<span class="org-keyword">if</span> (null occurs-in-rots)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">If we get this far, this should *never* occur:</span>
          (<span class="org-warning">error</span> (format <span class="org-string">"Unknown rotation for %s"</span> string))
      (<span class="org-keyword">if</span> (null (cdr occurs-in-rots))
          (caar rots)
        (cadr occurs-in-rots))))))))


(<span class="org-keyword">defun</span> <span class="org-function-name">rotate-get-rotations-for</span> (string <span class="org-type">&amp;optional</span> rotations)
  <span class="org-doc">"Return the string rotations for STRING in ROTATIONS."</span>
  (remq nil (mapcar (<span class="org-keyword">lambda</span> (rot) (<span class="org-keyword">if</span> (member string rot) rot))
            (<span class="org-keyword">or</span> rotations rotate-text-rotations))))


(<span class="org-keyword">defun</span> <span class="org-function-name">rotate-convert-rotations-to-regexp</span> (rotations)
  (regexp-opt (rotate-flatten-list rotations)))


(<span class="org-keyword">defun</span> <span class="org-function-name">rotate-flatten-list</span> (list-of-lists)
  <span class="org-doc">"Flatten LIST-OF-LISTS to a single list.</span>
<span class="org-doc">Example:</span>
<span class="org-doc">  (rotate-flatten-list '((a b c) (1 ((2 3)))))</span>
<span class="org-doc">    =&gt; (a b c 1 2 3)"</span>
  (<span class="org-keyword">if</span> (null list-of-lists)
      list-of-lists
    (<span class="org-keyword">if</span> (listp list-of-lists)
    (append (rotate-flatten-list (car list-of-lists))
        (rotate-flatten-list (cdr list-of-lists)))
      (list list-of-lists))))


(<span class="org-keyword">defun</span> <span class="org-function-name">rotate-word-at-point</span> ()
  <span class="org-doc">"Rotate word at point based on sets in `</span><span class="org-doc"><span class="org-constant">rotate-text-rotations</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((bounds (bounds-of-thing-at-point 'symbol))
        (opoint (point)))
    (<span class="org-keyword">when</span> (consp bounds)
      (<span class="org-keyword">let</span> ((beg (car bounds))
            (end (copy-marker (cdr bounds))))
        (rotate-region beg end)
        (goto-char (<span class="org-keyword">if</span> (&gt; opoint end) end opoint))))))


(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"g r r"</span>) #'rotate-word-at-point)
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">use C-j for command prompt</span>
(define-key evil-ex-completion-map (kbd <span class="org-string">"C-j"</span>) #'exit-minibuffer)


<span class="org-comment-delimiter">;; </span><span class="org-comment">insert spaces without leaving normal mode</span>
(<span class="org-keyword">evil-define-key</span> 'normal 'org-mode-map (kbd <span class="org-string">"z l"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                       (<span class="org-keyword">interactive</span>)
                                                       (forward-char)
                                                       (insert <span class="org-string">" "</span>)))
(<span class="org-keyword">evil-define-key</span> 'normal 'org-mode-map (kbd <span class="org-string">"z h"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                       (<span class="org-keyword">interactive</span>)
                                                       (insert <span class="org-string">" "</span>)
                                                       (evil-backward-char)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">capitalization</span>
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"g </span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">'"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                     (<span class="org-keyword">interactive</span>)
                                                     (<span class="org-keyword">save-excursion</span>
                                                       (<span class="org-keyword">if</span> (not (equal (char-before) ? ))
                                                           (evil-backward-word-begin 1))
                                                       (upcase-char 1))))
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"g \""</span>) #'(<span class="org-keyword">lambda</span> ()
                                                     (<span class="org-keyword">interactive</span>)
                                                     (<span class="org-keyword">save-excursion</span>
                                                       (<span class="org-keyword">if</span> (not (equal (char-before) ? ))
                                                           (evil-backward-word-begin 1))
                                                       (downcase-word 1))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure C-j doesn't actually create a new line in normal state</span>
(define-key evil-normal-state-map (kbd <span class="org-string">"C-j"</span>) #'evil-ret)


<span class="org-comment-delimiter">;; </span><span class="org-comment">delete char the fast way</span>
(define-key key-translation-map (kbd <span class="org-string">"C-h"</span>) [127])


<span class="org-comment-delimiter">;; </span><span class="org-comment">use C-j as RET</span>
(global-set-key (kbd <span class="org-string">"C-j"</span>) #'newline)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set convenient line-opening</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">open-line-down</span> ()
  <span class="org-doc">"Open and move to next line."</span>
  (<span class="org-keyword">interactive</span>)
  (call-interactively 'move-end-of-line)
  (newline))


(<span class="org-keyword">defun</span> <span class="org-function-name">open-line-up</span> ()
  <span class="org-doc">"Open and move to previous line."</span>
  (<span class="org-keyword">interactive</span>)
  (call-interactively 'move-beginning-of-line)
  (newline)
  (forward-line -1))


(define-key evil-normal-state-map (kbd <span class="org-string">"z j"</span>) #'open-line-down)
(define-key evil-normal-state-map (kbd <span class="org-string">"z k"</span>) #'open-line-up)


(<span class="org-keyword">defun</span> <span class="org-function-name">evil-shift-right-preserve</span> ()
  (<span class="org-keyword">interactive</span>)
  (evil-shift-right evil-visual-beginning evil-visual-end)
  (evil-normal-state)
  (evil-visual-restore))


(<span class="org-keyword">defun</span> <span class="org-function-name">evil-shift-left-preserve</span> ()
  (<span class="org-keyword">interactive</span>)
  (evil-shift-left evil-visual-beginning evil-visual-end)
  (evil-normal-state)
  (evil-visual-restore))


(define-key evil-visual-state-map (kbd <span class="org-string">"&gt;"</span>) #'evil-shift-right-preserve)
(define-key evil-visual-state-map (kbd <span class="org-string">"&lt;"</span>) #'evil-shift-left-preserve)


(<span class="org-keyword">evil-define-key</span> 'insert global-map (kbd <span class="org-string">"C-M-\\"</span>)
  #'(<span class="org-keyword">lambda</span> (literal-string)
      (<span class="org-keyword">interactive</span> <span class="org-string">"sInsert literal: "</span>)
      (insert literal-string)))
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">zoom in/out</span>
(evil-leader/set-key <span class="org-string">"="</span> #'text-scale-adjust)


<span class="org-comment-delimiter">;; </span><span class="org-comment">toggle sentence split</span>
(evil-leader/set-key <span class="org-string">"s"</span> #'toggle-sentence-split)


<span class="org-comment-delimiter">;; </span><span class="org-comment">switch input method</span>
(evil-leader/set-key <span class="org-string">"\\"</span> #'toggle-input-method)


<span class="org-comment-delimiter">;; </span><span class="org-comment">count occurrences</span>
(evil-leader/set-key <span class="org-string">"F"</span> #'count-matches)
</pre>
</div>
</div>

<div id="outline-container-org7d2cc5f" class="outline-3">
<h3 id="org7d2cc5f">Snippets</h3>
<div class="outline-text-3" id="text-org7d2cc5f">
<p>
Enable YASnippet.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">yasnippet</span>
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:config</span>
  (yas-global-mode)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">use C-, instead of tab to expand</span>
  (define-key yas-minor-mode-map [(tab)] nil)
  (define-key yas-minor-mode-map (kbd <span class="org-string">"TAB"</span>) nil)

  (define-key yas-minor-mode-map (kbd <span class="org-string">"C-b"</span>) #'yas-prev-field)

  (define-key yas-minor-mode-map (kbd <span class="org-string">"C-,"</span>)
              #'(<span class="org-keyword">lambda</span> ()
                  (<span class="org-keyword">interactive</span>)
                  (<span class="org-keyword">let</span> ((inhibit-message t))
                    (yas-expand)
                    (org-toggle-pretty-entities)
                    (org-toggle-pretty-entities))))
              


  <span class="org-comment-delimiter">;; </span><span class="org-comment">disable out-of-field modification warning (for laas)</span>
  (<span class="org-keyword">setq-default</span> yas-inhibit-overlay-modification-protection t) 


  <span class="org-comment-delimiter">;; </span><span class="org-comment">make sure latex snippets work in org-mode</span>
  (add-hook 'org-mode-hook (<span class="org-keyword">lambda</span> ()
                             (yas-minor-mode)
                             (yas-activate-extra-mode 'latex-mode))))
</pre>
</div>

<p>
Matrix-like snippets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">insert-matrix-like</span> (env rows cols <span class="org-type">&amp;optional</span> arguments)
  (<span class="org-keyword">interactive</span> <span class="org-string">"sEnvironment: \nnRows: \nnColumns: "</span>)
  (<span class="org-keyword">let</span> ((beginning-marker (point-marker))
        (end-marker (<span class="org-keyword">save-excursion</span>
                      (goto-char (1+ (point)))))
        (matrix-string <span class="org-string">""</span>))
    (insert (format <span class="org-string">"\\begin{%s}%s\n"</span> env (<span class="org-keyword">if</span> arguments arguments <span class="org-string">""</span>)))
    (<span class="org-keyword">dotimes</span> (i rows)
      (<span class="org-keyword">dotimes</span> (j cols)
        (<span class="org-keyword">setq</span> matrix-string (concat matrix-string
                                    (format
                                     (<span class="org-keyword">if</span> (equal j (1- cols)) <span class="org-string">"$%s"</span> <span class="org-string">"$%s &amp; "</span>)
                                     (+ 1 (* i cols) j)))))
      (<span class="org-keyword">setq</span> matrix-string (concat matrix-string (<span class="org-keyword">if</span> (equal i (1- rows)) (format <span class="org-string">"\n\\end{%s}"</span> env) <span class="org-string">"\\\\\\\n"</span>))))
    (<span class="org-keyword">setq</span> my/unhiding-current-line nil)
    (yas-expand-snippet matrix-string)
    (add-hook 'yas-after-exit-snippet-hook #'align-yasnippet-matrix)))


(<span class="org-keyword">defun</span> <span class="org-function-name">align-matrix</span> (start end)
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
  (<span class="org-keyword">if</span> (not (region-active-p))
      (<span class="org-keyword">save-mark-and-excursion</span>
        (<span class="org-keyword">let</span> ((inhibit-message t))
          (er/mark-LaTeX-inside-environment))
        (<span class="org-keyword">setq</span> start (point))
        (<span class="org-keyword">setq</span> end (mark))))
  (<span class="org-keyword">setq</span> my/unhiding-current-line nil)
  (align-regexp start end <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">\\s-*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"> &amp;"</span> 1 1 t)
  (<span class="org-keyword">setq</span> my/unhiding-current-line t))


(<span class="org-keyword">evil-define-key</span> 'visual org-mode-map (kbd <span class="org-string">"g r a"</span>) #'align-matrix)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g r a"</span>) #'align-matrix)


(<span class="org-keyword">defun</span> <span class="org-function-name">align-yasnippet-matrix</span> ()
  (align-regexp yas-snippet-beg yas-snippet-end <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">\\s-*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"> &amp;"</span> 1 1 t)
  (<span class="org-keyword">setq</span> my/unhiding-current-line t)
  (remove-hook 'yas-after-exit-snippet-hook #'align-yasnippet-matrix))
</pre>
</div>

<p>
Piecewise case snippet.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">snippet-create-n-cases</span> (n)
  (<span class="org-keyword">let</span> ((snippet-string <span class="org-string">""</span>)
        (yas-indent-line 'fixed)
        (yas-wrap-around-region 'nil))
    (<span class="org-keyword">dotimes</span> (i n)
      (<span class="org-keyword">setq</span> snippet-string (format <span class="org-string">"%s$%d &amp; \\text{if } $%d\\\\\\\n"</span>
                                   snippet-string
                                   (+ (* 2 i) 1)
                                   (+ (* 2 i) 2))))
    (yas-expand-snippet (format <span class="org-string">"\\begin{cases}\n%s\\end{cases}"</span> snippet-string))))

(<span class="org-keyword">defun</span> <span class="org-function-name">snippet-create-cases</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((n (<span class="org-keyword">save-excursion</span>
             (goto-char (- (point) 1))
             (number-at-point))))
    (<span class="org-keyword">if</span> n
        (<span class="org-keyword">progn</span>
          (<span class="org-keyword">save-excursion</span>
            (goto-char (- (point) 1))
            (<span class="org-keyword">let</span> ((bounds (bounds-of-thing-at-point 'number)))
              (delete-region (car bounds) (cdr bounds))))
          (snippet-create-n-cases n))
      (snippet-create-n-cases 2))))
</pre>
</div>

<p>
Automatic fraction snippets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">snippet-convert-fraction</span> (start end)
  (<span class="org-keyword">interactive</span>
   (<span class="org-keyword">if</span> (region-active-p)
       (list (region-beginning) (region-end))
     '(nil nil)))

  (<span class="org-keyword">if</span> (null start)
      (<span class="org-keyword">if</span> (not (texmathp))
          (insert <span class="org-string">"/"</span>)
        (<span class="org-keyword">pcase</span> (char-before)
          (?/
           (delete-backward-char 1)
           (yas-expand-snippet <span class="org-string">"\\dfrac{$1}{$2}$0"</span>))
          (?.
           (delete-backward-char 1)
           (insert <span class="org-string">"/"</span>))
          (?,
           (delete-backward-char 1)
           (insert <span class="org-string">"\\big/"</span>))
          (-
           (insert <span class="org-string">"/"</span>)

           (<span class="org-keyword">let</span> ((found-brace 0)
                 (limit (point))
                 (match nil)
                 (match-start nil))
             (<span class="org-keyword">save-excursion</span>
               (goto-char (1- (point)))
               (<span class="org-keyword">while</span> (<span class="org-keyword">and</span>
                       (texmathp)
                       (&gt; (point) (line-beginning-position))
                       (not (equal (char-after) ? ))
                       (not (equal (char-after) ?-))
                       (not (<span class="org-keyword">and</span> (memq (char-after) '(?{ ?\()) (equal found-brace 0))))
                 (<span class="org-keyword">pcase</span> (char-after)
                   ((<span class="org-keyword">or</span> ?} ?\)) (<span class="org-keyword">setq</span> found-brace (1+ found-brace)))
                   ((<span class="org-keyword">or</span> ?{ ?\() (<span class="org-keyword">setq</span> found-brace (1- found-brace))))
                 (goto-char (1- (point))))
               (<span class="org-keyword">when</span> (re-search-forward <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(?:</span></span><span class="org-string">^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(?1:</span></span><span class="org-string">.+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">/</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(?:</span></span><span class="org-string">[ -{(]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(?1:</span></span><span class="org-string">.+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">/</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> limit t)
                 (<span class="org-keyword">setq</span> match (match-string 1))
                 (<span class="org-keyword">setq</span> match-start (match-beginning 1))))

             (<span class="org-keyword">when</span> match-start
               (delete-region match-start limit)
               (yas-expand-snippet (format <span class="org-string">"\\dfrac{%s}{$1}$0"</span> match)))))))
    (<span class="org-keyword">let</span> ((numerator (buffer-substring start end)))
      (evil-insert-state)
      (delete-region start end)
      (yas-expand-snippet (format <span class="org-string">"\\dfrac{%s}{$1}$0"</span> numerator)))))


(<span class="org-keyword">evil-define-key</span> 'insert org-mode-map (kbd <span class="org-string">"/"</span>) #'snippet-convert-fraction)
(<span class="org-keyword">evil-define-key</span> 'visual org-mode-map (kbd <span class="org-string">"/"</span>) #'snippet-convert-fraction)
</pre>
</div>

<p>
Flip sides of equation.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">swap-equation-sides</span> (start end)
  (<span class="org-keyword">interactive</span>
   (<span class="org-keyword">if</span> (region-active-p)
       (list (region-beginning) (region-end))
     `(,(line-beginning-position) ,(line-end-position))))
  (<span class="org-keyword">save-excursion</span>
    (goto-char start)
    (re-search-forward <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*?</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[[:blank:]]*&amp;?=[[:blank:]]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> end)

    (<span class="org-keyword">let</span> ((LHS (match-string 1))
          (equals (match-string 2))
          (RHS (match-string 3)))
      (delete-region start end)
      (insert (format <span class="org-string">"%s%s%s"</span> RHS equals LHS)))))

(<span class="org-keyword">evil-define-key</span> 'visual org-mode-map (kbd <span class="org-string">"="</span>) #'swap-equation-sides)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g ="</span>) #'swap-equation-sides)
</pre>
</div>

<p>
Variable substitution (not strictly a snippet).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">TODO Create stronger criteria for variable subsitution (maybe incorporating thing at point, with exceptions for numbers and other variables)</span>

(<span class="org-keyword">defun</span> <span class="org-function-name">string-substitute-math-variables</span> (contents vars)
  (<span class="org-keyword">with-temp-buffer</span>
    (insert contents)
    (<span class="org-keyword">dolist</span> (pair (split-string vars <span class="org-string">","</span>))
      (<span class="org-keyword">-let</span> (((var value) (split-string pair <span class="org-string">"="</span>)))
        (<span class="org-keyword">condition-case</span> nil
            (<span class="org-keyword">while</span> (replace-regexp-in-region
                    var
                    (format <span class="org-string">"(%s)"</span> value)
                    (point-min) (point-max)))
          (<span class="org-warning">error</span> nil))))
    (buffer-string)))


(<span class="org-keyword">defun</span> <span class="org-function-name">substitute-math-variables</span> (vars start end)
  (<span class="org-keyword">interactive</span>
   (append (list (read-string <span class="org-string">"Enter variable-value pairs (e.g., \"x=4,y=7\"): "</span>))
           (<span class="org-keyword">if</span> (use-region-p)
               (list (region-beginning) (region-end))
             (list (line-beginning-position) (line-end-position)))))

  (<span class="org-keyword">save-excursion</span>
    (<span class="org-keyword">let</span> ((contents (buffer-substring start end)))
      (goto-char end)
      (insert (string-substitute-math-variables contents vars)))
    (delete-region start end)))


(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"g r s"</span>) #'substitute-math-variables)
</pre>
</div>

<p>
Anonymous snippets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">anonymous-snippet</span> <span class="org-string">""</span>
  <span class="org-doc">"Stores a temporary-use snippet."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">create-anonymous-snippet</span> (snippet)
  (<span class="org-keyword">interactive</span> <span class="org-string">"sSnippet: "</span>)
  (<span class="org-keyword">setq</span> anonymous-snippet snippet))


(define-key global-map (kbd <span class="org-string">"C-s"</span>) #'create-anonymous-snippet)


(<span class="org-keyword">defun</span> <span class="org-function-name">expand-anonymous-snippet</span> ()
  (<span class="org-keyword">interactive</span>)
  (yas-expand-snippet anonymous-snippet))
</pre>
</div>

<p>
Enable AAS.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">It may be interesting to note that the following combinations don't appear in</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">English: bx, cj, cv, cx, dx, fq, fx, gq, gx, hx, jc, jf, jg, jq, js, jv, jw,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">jx, jz, kq, kx, mx, px, pz, qb, qc, qd, qf, qg, qh, qj, qk, ql, qm, qn, qp,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">qs, qt, qv, qw, qx, qy, qz, sx, vb, vf, vh, vj, vm, vp, vq, vt, vw, vx, wx,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">xj, xx, zj, zq, zx</span>


  (<span class="org-keyword">use-package</span> <span class="org-constant">aas</span>
    <span class="org-builtin">:hook</span> (LaTeX-mode . aas-activate-for-major-mode)
    <span class="org-builtin">:hook</span> (org-mode . aas-activate-for-major-mode)
    <span class="org-builtin">:config</span>
    (aas-set-snippets 'text-mode
      <span class="org-string">";o-"</span> <span class="org-string">"&#333;"</span>
      <span class="org-string">";i-"</span> <span class="org-string">"&#299;"</span>
      <span class="org-string">";a-"</span> <span class="org-string">"&#257;"</span>
      <span class="org-string">";u-"</span> <span class="org-string">"&#363;"</span>
      <span class="org-string">";e-"</span> <span class="org-string">"&#275;"</span>
      <span class="org-string">"a-0"</span> #'expand-anonymous-snippet)

    (aas-set-snippets 'org-mode
      <span class="org-string">"js"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
             (yas-expand-snippet <span class="org-string">"\\\\( $1 \\\\)$0"</span>))
      <span class="org-string">"jf"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
             (yas-expand-snippet <span class="org-string">"\\begin{alignat*}{3}\n$0\n\\end{alignat*}"</span>)))

    (aas-set-snippets 'org-mode
      <span class="org-builtin">:cond</span> #'texmathp
      <span class="org-string">"cas"</span> #'snippet-create-cases
      <span class="org-string">"=-0"</span> #'swap-equation-sides
      <span class="org-string">"3det"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
               (insert-matrix-like <span class="org-string">"vmatrix"</span> 3 3))
      <span class="org-string">"2det"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
               (insert-matrix-like <span class="org-string">"vmatrix"</span> 2 2))
      <span class="org-string">"3mat"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
               (insert-matrix-like <span class="org-string">"bmatrix"</span> 3 3))
      <span class="org-string">"2mat"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
               (insert-matrix-like <span class="org-string">"bmatrix"</span> 2 2))
      <span class="org-string">"2amat"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
               (insert-matrix-like <span class="org-string">"amatrix"</span> 2 3 <span class="org-string">"{2}"</span>))
      <span class="org-string">"3amat"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
               (insert-matrix-like <span class="org-string">"amatrix"</span> 3 4 <span class="org-string">"{3}"</span>))
      <span class="org-string">"4amat"</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
               (insert-matrix-like <span class="org-string">"amatrix"</span> 4 5 <span class="org-string">"{4}"</span>))
      <span class="org-string">"matr"</span> (<span class="org-keyword">lambda</span> (rows cols) (<span class="org-keyword">interactive</span> <span class="org-string">"nRows: \nnColumns: "</span>)
               (insert-matrix-like <span class="org-string">"bmatrix"</span> rows cols))
      <span class="org-string">"cmat"</span> (<span class="org-keyword">lambda</span> (rows) (<span class="org-keyword">interactive</span> <span class="org-string">"nRows: "</span>)
               (insert-matrix-like <span class="org-string">"bmatrix"</span> rows 1))
      <span class="org-string">"amatr"</span> (<span class="org-keyword">lambda</span> (rows cols sep)
                (<span class="org-keyword">interactive</span> <span class="org-string">"nRows: \nnColumns: \nnSeparate at: "</span>)
                (insert-matrix-like <span class="org-string">"aamatrix"</span> rows cols
                                    (format <span class="org-string">"{%s}{%s}"</span> sep (- cols sep))))
      <span class="org-string">"matl"</span> #'insert-matrix-like)

    (<span class="org-keyword">let</span> ((snippets '((<span class="org-string">"sup"</span> . <span class="org-string">"^{$1$0"</span>)
                      (<span class="org-string">"ud"</span> . <span class="org-string">"_{$1$0"</span>)
                      (<span class="org-string">"jg"</span> . <span class="org-string">"^2$0"</span>)
                      (<span class="org-string">"jc"</span> . <span class="org-string">"^3$0"</span>)

                      (<span class="org-string">"gal"</span> . <span class="org-string">"\\alpha$0"</span>)
                      (<span class="org-string">"gbe"</span> . <span class="org-string">"\\beta$0"</span>)
                      (<span class="org-string">"gga"</span> . <span class="org-string">"\\gamma$0"</span>)
                      (<span class="org-string">"gde"</span> . <span class="org-string">"\\delta$0"</span>)
                      (<span class="org-string">"gep"</span> . <span class="org-string">"\\epsilon$0"</span>)
                      (<span class="org-string">"gze"</span> . <span class="org-string">"\\zeta$0"</span>)
                      (<span class="org-string">"geta"</span> . <span class="org-string">"\\eta$0"</span>)
                      (<span class="org-string">"gth"</span> . <span class="org-string">"\\theta$0"</span>)
                      (<span class="org-string">"gio"</span> . <span class="org-string">"\\iota$0"</span>)
                      (<span class="org-string">"gka"</span> . <span class="org-string">"\\kappa$0"</span>)
                      (<span class="org-string">"gla"</span> . <span class="org-string">"\\lambda$0"</span>)
                      (<span class="org-string">"gmu"</span> . <span class="org-string">"\\mu$0"</span>)
                      (<span class="org-string">"gnu"</span> . <span class="org-string">"\\nu$0"</span>)
                      (<span class="org-string">"gxi"</span> . <span class="org-string">"\\xi$0"</span>)
                      (<span class="org-string">"gmi"</span> . <span class="org-string">"\\omicron$0"</span>)
                      (<span class="org-string">"gpi"</span> . <span class="org-string">"\\pi$0"</span>)
                      (<span class="org-string">"grh"</span> . <span class="org-string">"\\rho$0"</span>)
                      (<span class="org-string">"gsi"</span> . <span class="org-string">"\\sigma$0"</span>)
                      (<span class="org-string">"gta"</span> . <span class="org-string">"\\tau$0"</span>)
                      (<span class="org-string">"gup"</span> . <span class="org-string">"\\upsilon$0"</span>)
                      (<span class="org-string">"gph"</span> . <span class="org-string">"\\phi$0"</span>)
                      (<span class="org-string">"gch"</span> . <span class="org-string">"\\chi$0"</span>)
                      (<span class="org-string">"gpsi"</span> . <span class="org-string">"\\psi$0"</span>)
                      (<span class="org-string">"gme"</span> . <span class="org-string">"\\omega$0"</span>)

                      (<span class="org-string">"Alpha"</span> . <span class="org-string">"\\Alpha$0"</span>)
                      (<span class="org-string">"Beta"</span> . <span class="org-string">"\\Beta$0"</span>)
                      (<span class="org-string">"Gamma"</span> . <span class="org-string">"\\Gamma$0"</span>)
                      (<span class="org-string">"Delta"</span> . <span class="org-string">"\\Delta$0"</span>)
                      (<span class="org-string">"Epsilon"</span> . <span class="org-string">"\\Epsilon$0"</span>)
                      (<span class="org-string">"Zeta"</span> . <span class="org-string">"\\Zeta$0"</span>)
                      (<span class="org-string">"Eta"</span> . <span class="org-string">"\\Eta$0"</span>)
                      (<span class="org-string">"Theta"</span> . <span class="org-string">"\\Theta$0"</span>)
                      (<span class="org-string">"Iota"</span> . <span class="org-string">"\\Iota$0"</span>)
                      (<span class="org-string">"Kappa"</span> . <span class="org-string">"\\Kappa$0"</span>)
                      (<span class="org-string">"Lambda"</span> . <span class="org-string">"\\Lambda$0"</span>)
                      (<span class="org-string">"Mu"</span> . <span class="org-string">"\\Mu$0"</span>)
                      (<span class="org-string">"Nu"</span> . <span class="org-string">"\\Nu$0"</span>)
                      (<span class="org-string">"Xi"</span> . <span class="org-string">"\\Xi$0"</span>)
                      (<span class="org-string">"Omicron"</span> . <span class="org-string">"\\Omicron$0"</span>)
                      (<span class="org-string">"Pi"</span> . <span class="org-string">"\\Pi$0"</span>)
                      (<span class="org-string">"Rho"</span> . <span class="org-string">"\\Rho$0"</span>)
                      (<span class="org-string">"Sigma"</span> . <span class="org-string">"\\Sigma$0"</span>)
                      (<span class="org-string">"Tau"</span> . <span class="org-string">"\\Tau$0"</span>)
                      (<span class="org-string">"Upsilon"</span> . <span class="org-string">"\\Upsilon$0"</span>)
                      (<span class="org-string">"Phi"</span> . <span class="org-string">"\\Phi$0"</span>)
                      (<span class="org-string">"Chi"</span> . <span class="org-string">"\\Chi$0"</span>)
                      (<span class="org-string">"Psi"</span> . <span class="org-string">"\\Psi$0"</span>)
                      (<span class="org-string">"Omega"</span> . <span class="org-string">"\\Omega$0"</span>)

                      (<span class="org-string">"ln"</span> . <span class="org-string">"\\ln $0"</span>)

                      (<span class="org-string">"cos"</span> . <span class="org-string">"\\cos{$1$0"</span>)
                      (<span class="org-string">"sec"</span> . <span class="org-string">"\\sec{$1$0"</span>)
                      (<span class="org-string">"sin"</span> . <span class="org-string">"\\sin{$1$0"</span>)
                      (<span class="org-string">"csc"</span> . <span class="org-string">"\\csc{$1$0"</span>)
                      (<span class="org-string">"tan"</span> . <span class="org-string">"\\tan{$1$0"</span>)
                      (<span class="org-string">"cot"</span> . <span class="org-string">"\\cot{$1$0"</span>)
                      (<span class="org-string">"acos"</span> . <span class="org-string">"\\arccos{$1$0"</span>)
                      (<span class="org-string">"asin"</span> . <span class="org-string">"\\arcsin{$1$0"</span>)
                      (<span class="org-string">"atan"</span> . <span class="org-string">"\\arctan{$1$0"</span>)

                      (<span class="org-string">"ncos"</span> . <span class="org-string">"\\cos^{$1{$2}$0"</span>)
                      (<span class="org-string">"nsec"</span> . <span class="org-string">"\\sec^{$1{$2}$0"</span>)
                      (<span class="org-string">"nsin"</span> . <span class="org-string">"\\sin^{$1{$2}$0"</span>)
                      (<span class="org-string">"ncsc"</span> . <span class="org-string">"\\csc^{$1{$2}$0"</span>)
                      (<span class="org-string">"ntan"</span> . <span class="org-string">"\\tan^{$1{$2}$0"</span>)
                      (<span class="org-string">"ncot"</span> . <span class="org-string">"\\cot^{$1{$2}$0"</span>)
                      (<span class="org-string">"nacos"</span> . <span class="org-string">"\\arccos^{$1{$2}$0"</span>)
                      (<span class="org-string">"nasin"</span> . <span class="org-string">"\\arcsin^{$1{$2}$0"</span>)
                      (<span class="org-string">"natan"</span> . <span class="org-string">"\\arctan^{$1{$2}$0"</span>)

                      (<span class="org-string">"2cos"</span> . <span class="org-string">"\\cos^2{$2$0"</span>)
                      (<span class="org-string">"2sec"</span> . <span class="org-string">"\\sec^2{$2$0"</span>)
                      (<span class="org-string">"2sin"</span> . <span class="org-string">"\\sin^2{$2$0"</span>)
                      (<span class="org-string">"2csc"</span> . <span class="org-string">"\\csc^2{$2$0"</span>)
                      (<span class="org-string">"2tan"</span> . <span class="org-string">"\\tan^2{$2$0"</span>)
                      (<span class="org-string">"2cot"</span> . <span class="org-string">"\\cot^2{$2$0"</span>)
                      (<span class="org-string">"2acos"</span> . <span class="org-string">"\\arccos^2{$2$0"</span>)
                      (<span class="org-string">"2asin"</span> . <span class="org-string">"\\arcsin^2{$2$0"</span>)
                      (<span class="org-string">"2atan"</span> . <span class="org-string">"\\arctan^2{$2$0"</span>)

                      (<span class="org-string">"exp"</span> . <span class="org-string">"\\exp$0"</span>)
                      (<span class="org-string">"log"</span> . <span class="org-string">"\\log$0"</span>)
                      (<span class="org-string">"ein"</span> . <span class="org-string">" \\in $0"</span>)

                      (<span class="org-string">"ooo"</span> . <span class="org-string">"\\infty$0"</span>)

                      (<span class="org-string">"par"</span> . <span class="org-string">"\\left( $1 \\right)$0"</span>)
                      (<span class="org-string">"bra"</span> . <span class="org-string">"\\left[ $1 \\right]$0"</span>)

                      (<span class="org-string">"cro"</span> . <span class="org-string">" \\times $0"</span>)
                      (<span class="org-string">"dot"</span> . <span class="org-string">" \\cdot $0"</span>)

                      (<span class="org-string">"3po"</span> . <span class="org-string">"\\left( $1, $2, $3 \\right)$0"</span>)
                      (<span class="org-string">"3ve"</span> . <span class="org-string">"\\left\\langle $1, $2, $3 \\right\\rangle$0"</span>)

                      (<span class="org-string">"2po"</span> . <span class="org-string">"\\left( $1, $2 \\right)$0"</span>)
                      (<span class="org-string">"2ve"</span> . <span class="org-string">"\\left\\langle $1, $2 \\right\\rangle$0"</span>)

                      (<span class="org-string">"kq"</span> . <span class="org-string">"\\sqrt{$1$0"</span>)

                      (<span class="org-string">"equ"</span> . <span class="org-string">" = $0"</span>)
                      (<span class="org-string">"&gt;&gt;"</span> . <span class="org-string">" \\&gt; $0"</span>)
                      (<span class="org-string">"nqu"</span> . <span class="org-string">" \\neq $0"</span>)
                      (<span class="org-string">"vm"</span> . <span class="org-string">" - $0"</span>)
                      (<span class="org-string">"vj"</span> . <span class="org-string">"-$0"</span>)
                      (<span class="org-string">"vp"</span> . <span class="org-string">" + $0"</span>)
                      (<span class="org-string">"seq"</span> . <span class="org-string">" &amp;= $0"</span>)
                      (<span class="org-string">"sim"</span> . <span class="org-string">"&amp;\\sim $0"</span>)
                      (<span class="org-string">"amp"</span> . <span class="org-string">" &amp; $0"</span>)
                      (<span class="org-string">"gtn"</span> . <span class="org-string">" &gt; $0"</span>)
                      (<span class="org-string">"sgt"</span> . <span class="org-string">" &amp;&gt; $0"</span>)
                      (<span class="org-string">"lst"</span> . <span class="org-string">" &lt; $0"</span>)
                      (<span class="org-string">"slt"</span> . <span class="org-string">" &amp;&lt; $0"</span>)
                      (<span class="org-string">"leq"</span> . <span class="org-string">" \\leq $0"</span>)
                      (<span class="org-string">"lseq"</span> . <span class="org-string">" &amp;\\leq $0"</span>)
                      (<span class="org-string">"geq"</span> . <span class="org-string">" \\geq $0"</span>)
                      (<span class="org-string">"rk"</span> . <span class="org-string">"\\\\\\\\"</span>)
                      (<span class="org-string">"gseq"</span> . <span class="org-string">" &amp;\\geq $0"</span>)
                      (<span class="org-string">"trip"</span> . <span class="org-string">" \\equiv $0"</span>)
                      (<span class="org-string">"strip"</span> . <span class="org-string">" &amp;\\equiv $0"</span>))))

      (<span class="org-keyword">dolist</span> (snippet snippets)
        (aas-set-snippets 'org-mode
          <span class="org-builtin">:cond</span> #'texmathp
          (car snippet) `(<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
                           (yas-expand-snippet ',(cdr snippet)))))))

</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">visit snippet</span>
(evil-leader/set-key <span class="org-string">"V"</span> #'yas-visit-snippet-file)


<span class="org-comment-delimiter">;; </span><span class="org-comment">new snippet</span>
(evil-leader/set-key <span class="org-string">"n"</span> #'yas-new-snippet)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgec1a8d7" class="outline-3">
<h3 id="orgec1a8d7">Spelling</h3>
<div class="outline-text-3" id="text-orgec1a8d7">
<p>
Set path to spellcheck program.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> ispell-program-name <span class="org-string">"/usr/local/bin/aspell"</span>)
</pre>
</div>

<p>
Automatically correct words when pressing space bar.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">autocorrect-words-on-type</span> t
  <span class="org-doc">"Whether to automatically correct a word after pressing space."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">correct-word-before-space</span> ()
  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span>
       autocorrect-words-on-type
       (memq major-mode '(org-mode mail-mode text-mode))
       (null (get-char-property (point) 'face))
       (not (texmathp))
       (not (yas-active-snippets))
       (not (equal (TeX-current-macro) <span class="org-string">"text"</span>))
       (not (org-in-src-block-p)))
      (<span class="org-keyword">when</span> (<span class="org-keyword">and</span>
             (equal (char-before) ? )
             (<span class="org-keyword">save-excursion</span>
               (goto-char (- (point) 1))
               (thing-at-point 'word)))
        (<span class="org-keyword">save-excursion</span>
          (flyspell-auto-correct-word)))))


(add-hook 'post-self-insert-hook #'correct-word-before-space)


<span class="org-comment-delimiter">;; </span><span class="org-comment">avoid triggering autocorrect</span>
(define-key org-mode-map (kbd <span class="org-string">"S-SPC"</span>) #'(<span class="org-keyword">lambda</span> ()
                                           (<span class="org-keyword">interactive</span>)
                                           (insert ? )))


(define-key org-mode-map (kbd <span class="org-string">"&lt;f3&gt;"</span>) #'(<span class="org-keyword">lambda</span> ()
                                          (<span class="org-keyword">interactive</span>)
                                          (<span class="org-keyword">if</span> autocorrect-words-on-type
                                              (<span class="org-keyword">progn</span>
                                                (<span class="org-keyword">setq</span> autocorrect-words-on-type nil)
                                                (message <span class="org-string">"Disabled autocorrect."</span>))
                                            (<span class="org-keyword">setq</span> autocorrect-words-on-type t)
                                            (message <span class="org-string">"Enabled autocorrect."</span>))))
</pre>
</div>

<p>
Create a ring of dictionary languages.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">let</span> ((langs '(<span class="org-string">"american"</span> <span class="org-string">"brasileiro"</span>)))
  (<span class="org-keyword">setq</span> lang-ring (make-ring (length langs)))
  (<span class="org-keyword">dolist</span> (elem langs) (ring-insert lang-ring elem)))


(<span class="org-keyword">defun</span> <span class="org-function-name">cycle-ispell-languages</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((lang (ring-ref lang-ring -1)))
    (ring-insert lang-ring lang)
    (ispell-change-dictionary lang)))
</pre>
</div>

<p>
Only spellcheck comments.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> flyspell-prog-text-faces '(font-lock-comment-face font-lock-doc-face))
</pre>
</div>

<p>
Set evil-leader key bindings for spelling-related functions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">start flyspell</span>
(evil-leader/set-key <span class="org-string">"S"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (derived-mode-p 'prog-mode) (not (equal (buffer-name) <span class="org-string">"*scratch*"</span>)))
                                 (flyspell-prog-mode)
                               (<span class="org-keyword">progn</span>
                                 (flyspell-mode)
                                 (<span class="org-keyword">if</span> (equal (buffer-name) <span class="org-string">"*scratch*"</span>)
                                     (flycheck-mode -1))))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">cycle through ispell languages</span>
(evil-leader/set-key <span class="org-string">"C"</span> #'cycle-ispell-languages)


<span class="org-comment-delimiter">;; </span><span class="org-comment">save spelling</span>
(evil-leader/set-key <span class="org-string">"["</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">let</span> ((current-location (point))
                                   (word (flyspell-get-word)))
                               (<span class="org-keyword">when</span> (consp word)
                                 (flyspell-do-correct 'save nil (car word) current-location (cadr word) (caddr word) current-location))
                               (<span class="org-keyword">setq</span> ispell-pdict-modified-p nil))))
</pre>
</div>

<p>
Customize fLyspell faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'flyspell-duplicate nil
                    <span class="org-builtin">:underline</span> color-blue)


(set-face-attribute 'flyspell-incorrect nil
                    <span class="org-builtin">:underline</span> color-red)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">flyspell</span>
  <span class="org-builtin">:config</span>
  &lt;&lt;flyspell-faces&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc044e0c" class="outline-3">
<h3 id="orgc044e0c">Smartparens</h3>
<div class="outline-text-3" id="text-orgc044e0c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">smartparens</span>
  <span class="org-builtin">:config</span>

  (smartparens-global-mode)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">disable pairing for single quotes in emacs lisp</span>
  (sp-local-pair 'emacs-lisp-mode <span class="org-string">"'"</span> nil <span class="org-builtin">:actions</span> nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7e7ba67" class="outline-3">
<h3 id="org7e7ba67">Templating</h3>
<div class="outline-text-3" id="text-org7e7ba67">
<p>
Placeholder for generic templates.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">template-placeholder-text</span> <span class="org-string">"&lt;++&gt;"</span>
  <span class="org-doc">"Placeholder text to be replaced by `</span><span class="org-doc"><span class="org-constant">edit-next-placeholder</span></span><span class="org-doc">'."</span>)
</pre>
</div>

<p>
Find and edit next placeholder. Adapted from somewhere a long time
ago.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">edit-next-placeholder</span> ()
  <span class="org-doc">"Jump to next `</span><span class="org-doc"><span class="org-constant">template-placeholder-text</span></span><span class="org-doc">' and edit."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (search-forward template-placeholder-text nil t)
      (<span class="org-keyword">progn</span>
        (delete-backward-char (length template-placeholder-text))
        (evil-insert-state))))
</pre>
</div>

<p>
Bind keys.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span class="org-string">"C-."</span>) #'edit-next-placeholder)
</pre>
</div>

<p>
Bind with <code>evil-leader</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span class="org-string">"r"</span> #'edit-next-placeholder)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga892f74" class="outline-3">
<h3 id="orga892f74">Macros</h3>
<div class="outline-text-3" id="text-orga892f74">
<p>
Use this macro to turn <code>org-mode</code> lists into table rows (for English
class).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(fset 'org-list-to-row
      (kmacro-lambda-form [?v ?i ?p ?\; ?s ?/ ?\\ ?n ?  ?  ?/ ?  ?\C-j ?g ?v ?\; ?s ?/ ?- ?  ?\\ ?\( ?. ?* ?\\ ?\) ?/ ?| ?  ?\\ ?1 ?  return ?g ?v ?\C-j ?A ?| ?j ?k] 0 <span class="org-string">"%d"</span>))

(<span class="org-keyword">with-eval-after-load</span> 'org
  (define-key org-mode-map (kbd <span class="org-string">"C-c C-r"</span>) 'org-list-to-row))
</pre>
</div>
</div>
</div>

<div id="outline-container-org888791d" class="outline-3">
<h3 id="org888791d">Undo tree</h3>
<div class="outline-text-3" id="text-org888791d">
<p>
Use undo tree.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">undo-tree</span>
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">stop creating automatic backups</span>
  (<span class="org-keyword">setq-default</span> undo-tree-auto-save-history nil)


  (global-undo-tree-mode))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6a76576" class="outline-2">
<h2 id="org6a76576">Shell</h2>
<div class="outline-text-2" id="text-org6a76576">
<p>
<code>vterm</code> config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">vterm-send-escape</span> ()
  (<span class="org-keyword">interactive</span>)
  (vterm-send-key <span class="org-string">"&lt;escape&gt;"</span>))


(<span class="org-keyword">use-package</span> <span class="org-constant">vterm</span>
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:config</span>
  (define-key vterm-mode-map (kbd <span class="org-string">"M-h"</span>) 'evil-window-left)
  (define-key vterm-mode-map (kbd <span class="org-string">"M-j"</span>) 'evil-window-down)
  (define-key vterm-mode-map (kbd <span class="org-string">"M-k"</span>) 'evil-window-up)
  (define-key vterm-mode-map (kbd <span class="org-string">"M-l"</span>) 'evil-window-right)
  (<span class="org-keyword">setq-local</span> evil-insert-state-cursor '(<span class="org-string">"#aaa"</span> box))


  (define-key vterm-mode-map (kbd <span class="org-string">"C-&lt;return&gt;"</span>) #'evil-normal-state)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">use C-return to escape external insert state</span>
  (<span class="org-keyword">evil-define-key</span> 'insert vterm-mode-map (kbd <span class="org-string">"&lt;escape&gt;"</span>) #'vterm-send-escape))
</pre>
</div>

<p>
Use <code>M-§</code> to start running shell command.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span class="org-string">"M-&#167;"</span>) 'shell-command)
</pre>
</div>

<p>
Insert file name with <code>C-o</code> in shell command prompt.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key minibuffer-local-map (kbd <span class="org-string">"C-o"</span>)
  (<span class="org-keyword">lambda</span> ()
    (<span class="org-keyword">interactive</span>) 
    (insert (buffer-name (window-buffer (minibuffer-selected-window))))))
</pre>
</div>

<p>
Use <code>C-n</code> and <code>C-p</code> to navigate shell command history (will work for lisp
eval too).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key minibuffer-local-map (kbd <span class="org-string">"C-p"</span>) 'previous-line-or-history-element)
(define-key minibuffer-local-map (kbd <span class="org-string">"C-n"</span>) 'next-line-or-history-element)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf95b292" class="outline-2">
<h2 id="orgf95b292">Remote</h2>
<div class="outline-text-2" id="text-orgf95b292">
</div>
<div id="outline-container-org4bcdb70" class="outline-3">
<h3 id="org4bcdb70">Tramp</h3>
<div class="outline-text-3" id="text-org4bcdb70">
<p>
Make tramp play nice with Marylou.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> tramp-password-prompt-regexp <span class="org-string">"^.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">Password</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Verification</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">.*:&#0;? *"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org612bfc6" class="outline-3">
<h3 id="org612bfc6">Git</h3>
<div class="outline-text-3" id="text-org612bfc6">
<p>
Use syntax highlighting in gitignore.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">gitignore-mode</span>
  <span class="org-builtin">:load-path</span> <span class="org-string">"lisp/"</span>)
</pre>
</div>

<p>
Use magit. Obviously. 
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">magit</span>)
</pre>
</div>

<p>
Make sure magit opens in the same window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> magit-display-buffer-function
              (<span class="org-keyword">lambda</span> (buffer)
                (display-buffer
                 buffer (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (derived-mode-p 'magit-mode)
                                 (memq (<span class="org-keyword">with-current-buffer</span> buffer major-mode)
                                       '(magit-process-mode
                                         magit-revision-mode
                                         magit-diff-mode
                                         magit-stash-mode
                                         magit-status-mode)))
                            nil
                          '(display-buffer-same-window)))))
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key (kbd <span class="org-string">"m"</span>) 'magit)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5d85a68" class="outline-2">
<h2 id="org5d85a68">Programming</h2>
<div class="outline-text-2" id="text-org5d85a68">
</div>
<div id="outline-container-orgc257f6b" class="outline-3">
<h3 id="orgc257f6b">Flycheck</h3>
<div class="outline-text-3" id="text-orgc257f6b">
<p>
Customize faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'flycheck-error nil
                    <span class="org-builtin">:underline</span> color-red)


(set-face-attribute 'flycheck-info nil
                    <span class="org-builtin">:underline</span> color-light-green)


(set-face-attribute 'flycheck-warning nil
                    <span class="org-builtin">:underline</span> color-light-orange)
</pre>
</div>

<p>
Start up.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> flycheck-disabled-checkers '(emacs-lisp-checkdoc))

(global-flycheck-mode)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">flycheck</span>
  <span class="org-builtin">:config</span>
  &lt;&lt;flycheck-faces&gt;&gt;
  &lt;&lt;flycheck-config&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org09c6e33" class="outline-3">
<h3 id="org09c6e33">Flymake</h3>
<div class="outline-text-3" id="text-org09c6e33">
<p>
Customize faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'flymake-error nil
                    <span class="org-builtin">:underline</span> color-red)


(set-face-attribute 'flymake-note nil
                    <span class="org-builtin">:underline</span> color-light-green)


(set-face-attribute 'flymake-warning nil
                    <span class="org-builtin">:underline</span> color-light-orange)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">flymake</span>
  <span class="org-builtin">:config</span>
  &lt;&lt;flymake-faces&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c74e5e" class="outline-3">
<h3 id="org0c74e5e">Company</h3>
<div class="outline-text-3" id="text-org0c74e5e">
<p>
Company config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">company</span>
  <span class="org-builtin">:init</span> (add-hook 'after-init-hook 'global-company-mode)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq-default</span> company-tooltip-align-annotations t)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">use icons in company mode</span>
  (<span class="org-keyword">setq-default</span> company-format-margin-function 'company-vscode-dark-icons-margin)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">use C-j to complete</span>
  (define-key company-active-map (kbd <span class="org-string">"C-j"</span>) #'company-complete-selection)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">change company faces</span>
  (set-face-attribute 'company-tooltip nil
                      <span class="org-builtin">:inherit</span> 'default
                      <span class="org-builtin">:background</span> color-background)


  (set-face-attribute 'company-scrollbar-fg nil
                      <span class="org-builtin">:background</span> color-dark-subdued)


  (set-face-attribute 'company-scrollbar-bg nil
                      <span class="org-builtin">:background</span> color-background)


  (set-face-attribute 'company-tooltip-mouse nil
                      <span class="org-builtin">:background</span> color-dark-subdued)


  (set-face-attribute 'company-tooltip-selection nil
                      <span class="org-builtin">:background</span> color-dark-subdued)


  (set-face-attribute 'company-tooltip-annotation nil
                      <span class="org-builtin">:foreground</span> color-blue)


  (<span class="org-keyword">setq-default</span> company-idle-delay              0.1
                company-minimum-prefix-length   2
                company-show-numbers            t
                company-tooltip-limit           20
                company-dabbrev-downcase        nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge442350" class="outline-3">
<h3 id="orge442350">Languages</h3>
</div>

<div id="outline-container-orgf9f451f" class="outline-3">
<h3 id="orgf9f451f">Python</h3>
<div class="outline-text-3" id="text-orgf9f451f">
<p>
Elpy config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">elpy</span>
  <span class="org-builtin">:config</span>
  (elpy-enable)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">stop weird indentation guides from elpy</span>
  (add-hook 'elpy-mode-hook (<span class="org-keyword">lambda</span> () (highlight-indentation-mode -1)))


  (<span class="org-keyword">setq-default</span> elpy-rpc-backend <span class="org-string">"jedi"</span>)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">use global environment</span>
  (<span class="org-keyword">setq-default</span> elpy-rpc-virtualenv-path 'current))
</pre>
</div>

<p>
Jedi config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">company-jedi</span>
  <span class="org-builtin">:config</span>

  (add-hook 'python-mode-hook #'(<span class="org-keyword">lambda</span> ()
                                  (<span class="org-keyword">interactive</span>)
                                  (add-to-list 'company-backends 'company-jedi))))
</pre>
</div>

<p>
Set variables.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">setting python executable</span>
(<span class="org-keyword">setq-default</span> flycheck-python-flake8-executable <span class="org-string">"python"</span>)
(<span class="org-keyword">setq-default</span> flycheck-python-pycompile-executable <span class="org-string">"python"</span>)
(<span class="org-keyword">setq-default</span> flycheck-python-pylint-executable <span class="org-string">"python"</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">set python path</span>
(setenv <span class="org-string">"PYTHONPATH"</span> (shell-command-to-string <span class="org-string">"$SHELL --login -c 'echo -n $PYTHONPATH'"</span>))
</pre>
</div>

<p>
Add a font lock face for method calls.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defface</span> <span class="org-variable-name">method-call-lock</span>
  '((t <span class="org-builtin">:foreground</span> <span class="org-string">"#b5bd68"</span>))
  <span class="org-doc">"Face for method calls."</span>
  <span class="org-builtin">:group</span> 'python-mode)
</pre>
</div>

<p>
Add a font lock face for operators.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defface</span> <span class="org-variable-name">operator-lock</span>
  '((t <span class="org-builtin">:foreground</span> <span class="org-string">"#cc6666"</span>))
  <span class="org-doc">"Face for operators."</span>
  <span class="org-builtin">:group</span> 'python-mode)
</pre>
</div>

<p>
Define Python method calls and operators as font lock keywords.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(font-lock-add-keywords 'python-mode
                        `((,(concat
                             <span class="org-string">"\\."</span>
                             <span class="org-string">"\\&lt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[_a-zA-Z][_a-zA-Z0-9]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">\\&gt;"</span>
                             <span class="org-string">"("</span>) <span class="org-warning">1 'method-call-lock keep t)</span>
                          (<span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[=+-/*&gt;&lt;]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> . 'operator-lock)))
</pre>
</div>

<p>
Remove <code>matplotlib</code> line from graph in HTML export.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">remove-ipython-matplotlib-line</span> (text backend info)
  (replace-regexp-in-string <span class="org-string">"&lt;pre class=\"example\"[[:ascii:][:nonascii:]]*?\\[&amp;lt;matplotlib.lines.Line2D at 0x[0-9a-f]*&amp;gt;\\][[:ascii:][:nonascii:]]*?&lt;/pre&gt;"</span> <span class="org-string">""</span> text))


(add-to-list 'org-export-filter-drawer-functions
             'remove-ipython-matplotlib-line)


<span class="org-comment-delimiter">;; </span><span class="org-comment">load python in org-mode</span>
(org-babel-do-load-languages
 'org-babel-load-languages
 '((python . t)))
</pre>
</div>

<p>
Add docstrings to embrace pairs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'python-mode-hook (<span class="org-keyword">lambda</span> ()
                              (embrace-add-pair ?d <span class="org-string">"\"\"\""</span> <span class="org-string">"\"\"\""</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org77f391c" class="outline-3">
<h3 id="org77f391c">Rust</h3>
<div class="outline-text-3" id="text-org77f391c">
<p>
Rust config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> lsp-rust-server 'rust-analyzer)

(<span class="org-keyword">use-package</span> <span class="org-constant">rust-mode</span>
  <span class="org-builtin">:config</span>
  (add-hook 'rust-mode-hook #'racer-mode)


  (define-key rust-mode-map (kbd <span class="org-string">"TAB"</span>) #'company-indent-or-complete-common)


  (<span class="org-keyword">setq-default</span> racer-rust-src-path
                (concat (string-trim
                         (shell-command-to-string <span class="org-string">"rustc --print sysroot"</span>))
                        <span class="org-string">"/lib/rustlib/src/rust/library"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org875e748" class="outline-3">
<h3 id="org875e748">Elisp</h3>
<div class="outline-text-3" id="text-org875e748">
<p>
Convenient way to open lisp eval.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span class="org-string">"C-;"</span>) 'eval-expression)
</pre>
</div>

<p>
Stop using <code>C-j</code> to evaluate line.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key lisp-interaction-mode-map (kbd <span class="org-string">"C-j"</span>) #'newline)
</pre>
</div>
</div>
</div>

<div id="outline-container-org12419f8" class="outline-3">
<h3 id="org12419f8">SGML/HTML</h3>
<div class="outline-text-3" id="text-org12419f8">
<p>
Set indentation to 4 spaces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> sgml-basic-offset 4)
(<span class="org-keyword">setq-default</span> sgml-specials nil)
</pre>
</div>

<p>
Emmet config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">emmet-mode</span>
  <span class="org-builtin">:config</span>
  (add-hook 'html-mode-hook 'emmet-mode)

  (define-key emmet-mode-keymap (kbd <span class="org-string">"C-j"</span>) #'newline)
  (define-key emmet-mode-keymap (kbd <span class="org-string">"C-,"</span>) #'emmet-expand-line))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf0c84db" class="outline-3">
<h3 id="orgf0c84db">Auctex/latex</h3>
<div class="outline-text-3" id="text-orgf0c84db">
<p>
LaTeX config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">latex</span>
  <span class="org-builtin">:ensure</span> auctex
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq-default</span> TeX-auto-save t)
  (<span class="org-keyword">setq-default</span> TeX-parse-self t)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">refresh PDF constantly</span>
  (<span class="org-keyword">setq-default</span> auto-revert-interval 0.5)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">stop showing revert messages</span>
  (<span class="org-keyword">setq-default</span> auto-revert-verbose nil)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">disable inline sub-/superscript --- gets annoying</span>
  (<span class="org-keyword">setq-default</span> font-latex-fontify-script nil)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">add math pairing</span>
  (sp-local-pair '(latex-mode org-mode) <span class="org-string">"$"</span> <span class="org-string">"$"</span>)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">add pairings for \left \right delimiters</span>
  (sp-local-pair '(latex-mode org-mode) <span class="org-string">"\\left("</span> <span class="org-string">"\\right)"</span>)
  (sp-local-pair '(latex-mode org-mode) <span class="org-string">"\\left["</span> <span class="org-string">"\\right]"</span>)
  (sp-local-pair '(latex-mode org-mode) <span class="org-string">"\\left\\langle"</span> <span class="org-string">"\\right\\rangle"</span>)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use pdf-tools to open PDF files</span>
  (<span class="org-keyword">setq-default</span> TeX-view-program-selection '((output-pdf <span class="org-string">"PDF Tools"</span>))
                TeX-source-correlate-start-server t)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">Update PDF buffers after successful LaTeX runs</span>
  (add-hook 'TeX-after-compilation-finished-functions
            #'TeX-revert-document-buffer))
</pre>
</div>

<p>
Add <code>evil-embrace</code> pairs to LaTeX mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">embrace-with-latex-environment</span> ()
  (<span class="org-keyword">let</span> ((cname (<span class="org-keyword">or</span> (read-string <span class="org-string">"Environment: "</span>) <span class="org-string">""</span>)))
    (cons (format <span class="org-string">"\\begin{%s}\n"</span> cname) (format <span class="org-string">"\n\\end{%s}"</span> cname))))


(<span class="org-keyword">defun</span> <span class="org-function-name">embrace-with-latex-command</span> ()
  (<span class="org-keyword">let</span> ((cname (read-string <span class="org-string">"Command: "</span>)))
    (cons (format <span class="org-string">"\\%s{"</span> (<span class="org-keyword">or</span> cname <span class="org-string">""</span>)) <span class="org-string">"}"</span>)))


(add-hook 'LaTeX-mode-hook (<span class="org-keyword">lambda</span> ()
                             (embrace-add-pair ?i <span class="org-string">"\\emph{"</span> <span class="org-string">"}"</span>)
                             (embrace-add-pair ?m <span class="org-string">"$"</span> <span class="org-string">"$"</span>)
                             (embrace-add-pair ?\[ <span class="org-string">"\\left["</span> <span class="org-string">"\\right]"</span>)
                             (embrace-add-pair ?\( <span class="org-string">"\\left("</span> <span class="org-string">"\\right)"</span>)
                             (embrace-add-pair ?\] <span class="org-string">"\\left[ "</span> <span class="org-string">" \\right]"</span>)
                             (embrace-add-pair ?\) <span class="org-string">"\\left( "</span> <span class="org-string">" \\right)"</span>)
                             (embrace-add-pair-regexp ?c <span class="org-string">"\\[</span><span class="org-string"><span class="org-negation-char"><span class="org-constant">^</span></span></span><span class="org-string"><span class="org-constant">{</span></span><span class="org-string">]*?{"</span> <span class="org-string">"}"</span>
                                                      #'embrace-with-latex-command
                                                      (embrace-build-help <span class="org-string">"\\command{"</span> <span class="org-string">"}"</span>))
                             (embrace-add-pair-regexp ?e <span class="org-string">"\\begin{[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">{]*?}"</span> <span class="org-string">"\\end{[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">{]*?}"</span>
                                                      #'embrace-with-latex-environment
                                                      (embrace-build-help <span class="org-string">"\\begin{environment}"</span> <span class="org-string">"\\end{environment}"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6a53b6e" class="outline-3">
<h3 id="org6a53b6e">Scripts</h3>
<div class="outline-text-3" id="text-org6a53b6e">
<p>
Run Python script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-current-python</span> (arguments)
  <span class="org-doc">"Run current Python file."</span>
  (shell-command-to-string
   (format
    <span class="org-string">"export PYTHONPATH='</span><span class="org-string"><span class="org-constant">${PYTHONPATH}:/Users/jetblack/maxwell/src/:/Users/jetblack/pyimports/</span></span><span class="org-string">' &amp;&amp; python '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' %s"</span>
    (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run Node.js script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-current-javascript</span> (arguments)
  <span class="org-doc">"Run current JavaScript file."</span>
  (shell-command-to-string
   (format
    <span class="org-string">"node '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' %s"</span>
    (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run Julia script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-current-julia</span> (arguments)
  <span class="org-doc">"Run current Python file."</span>
  (shell-command-to-string
   (format
    <span class="org-string">"export PYTHONPATH='</span><span class="org-string"><span class="org-constant">${PYTHONPATH}:/Users/jetblack/maxwell/src/</span></span><span class="org-string">' &amp;&amp; /Applications/Julia-1.6.app/Contents/Resources/julia/bin/julia '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' %s"</span>
    (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run shell script.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-current-shell</span> (arguments)
  <span class="org-doc">"Run current shell script."</span>
  (shell-command-to-string (format <span class="org-string">"zsh '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' %s"</span> (buffer-file-name) arguments)))
</pre>
</div>

<p>
Run script based on current major mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-script-without-args</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">cond</span> ((equal major-mode 'dired-mode) (dired-find-file) (run-script-without-args))
        ((equal major-mode 'python-mode) (princ (run-current-python <span class="org-string">""</span>)))
        ((equal major-mode 'js-mode) (princ (run-current-javascript <span class="org-string">""</span>)))
        ((equal major-mode 'julia-mode) (princ (run-current-julia <span class="org-string">""</span>)))
        ((equal major-mode 'sh-mode) (princ (run-current-shell <span class="org-string">""</span>)))
        ((equal major-mode 'org-mode) (org-babel-execute-src-block))
        (t (message <span class="org-string">"File type not supported."</span>))))


(<span class="org-keyword">defun</span> <span class="org-function-name">run-script-with-args</span> (arguments)
  (<span class="org-keyword">interactive</span> <span class="org-string">"MArguments: "</span>)
  (<span class="org-keyword">cond</span> ((equal major-mode 'dired-mode) (dired-find-file) (run-script-with-args arguments))
        ((equal major-mode 'python-mode) (princ (run-current-python arguments)))
        ((equal major-mode 'js-mode) (princ (run-current-javascript arguments)))
        ((equal major-mode 'julia-mode) (princ (run-current-julia arguments)))
        ((equal major-mode 'sh-mode) (princ (run-current-shell arguments)))
        ((equal major-mode 'org-mode) (org-babel-execute-src-block))
        (t (message <span class="org-string">"File type not supported."</span>))))
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">run scripts</span>
(evil-leader/set-key <span class="org-string">","</span> #'run-script-without-args)
(evil-leader/set-key <span class="org-string">"'"</span> #'run-script-without-args)


<span class="org-comment-delimiter">;; </span><span class="org-comment">run scripts with arguments</span>
(evil-leader/set-key <span class="org-string">"."</span> #'run-script-with-args)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org242d5b1" class="outline-2">
<h2 id="org242d5b1">Mail</h2>
<div class="outline-text-2" id="text-org242d5b1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">notmuch</span>
  <span class="org-builtin">:config</span>
  &lt;&lt;notmuch-keybindings&gt;&gt;)
</pre>
</div>

<p>
Configure notmuch startup screen.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">hide ugly notmuch logo</span>
(<span class="org-keyword">setq-default</span> notmuch-show-logo nil)
</pre>
</div>

<p>
Configure to work with msmtp.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> send-mail-function 'sendmail-query-once
              sendmail-program <span class="org-string">"/usr/sbin/sendmail"</span>
              mail-specify-envelope-from t
              message-sendmail-envelope-from 'header
              mail-envelope-from 'header)
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">bind C-j properly</span>
(<span class="org-keyword">evil-define-key</span> 'normal notmuch-search-mode-map (kbd <span class="org-string">"C-j"</span>) #'notmuch-search-show-thread)


<span class="org-comment-delimiter">;; </span><span class="org-comment">search by tag in notmuch</span>
(<span class="org-keyword">evil-define-key</span> 'normal notmuch-hello-mode-map (kbd <span class="org-string">"?"</span>) #'notmuch-search-by-tag)
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">open send mail buffer</span>
(evil-leader/set-key <span class="org-string">"M"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (switch-to-buffer <span class="org-string">"*mail*"</span> nil t)
                             (mail-mode)
                             (company-mode -1)
                             (auto-fill-mode -1)
                             (distraction-free t)
                             (evil-insert-state)
                             (yas-minor-mode)
                             (yas-expand-snippet
                              <span class="org-string">"From: William Aguiar Roque <a href="mailto:william.aroque%40gmail.com">&lt;william.aroque@gmail.com&gt;</a></span>
<span class="org-string">To: $1</span>
<span class="org-string">Subject: $2</span>
<span class="org-string">--text follows this line--</span>
<span class="org-string">$0"</span>)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">open read mail buffer</span>
(evil-leader/set-key <span class="org-string">"1"</span> #'(<span class="org-keyword">lambda</span> (refresh-email)
                             (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
                             (<span class="org-keyword">when</span> refresh-email
                               (message <span class="org-string">"Refreshing email..."</span>)
                               (shell-command-to-string <span class="org-string">"mbsync gmail; notmuch new"</span>))
                             (notmuch)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgff5632f" class="outline-2">
<h2 id="orgff5632f">Files</h2>
<div class="outline-text-2" id="text-orgff5632f">
</div>
<div id="outline-container-org9a45358" class="outline-3">
<h3 id="org9a45358">Dired</h3>
<div class="outline-text-3" id="text-org9a45358">
<p>
Get a list of marked files from all Dired buffers. <a href="https://emacs.stackexchange.com/a/64591/33585">Thanks Drew!</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">get-all-marked-files-and-unmark</span> ()
  <span class="org-doc">"Return a list of marked files from all Dired buffers."</span>
  (<span class="org-keyword">let</span> ((files  ())
        (here   ()))
    (<span class="org-keyword">dolist</span> (buf  (mapcar #'cdr dired-buffers))
      (<span class="org-keyword">with-current-buffer</span> buf
        (<span class="org-keyword">setq</span> here  (dired-get-marked-files nil nil nil t))
        (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> (null (cdr here))  (eq t (car here)))
          (<span class="org-keyword">setq</span> here  (cdr here)))
        (<span class="org-keyword">setq</span> files  (nconc here files))
        (<span class="org-keyword">let</span> ((inhibit-message t))
          (dired-unmark-all-marks))))
    (<span class="org-keyword">setq</span> files  (delete-dups files))))
</pre>
</div>

<p>
Make dired update automatically.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-mode-hook #'auto-revert-mode)
</pre>
</div>

<p>
Close dired buffers by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dired-kill-when-opening-new-dired-buffer t)
</pre>
</div>

<p>
Make dired stop showing as modified by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-after-readin-hook #'(<span class="org-keyword">lambda</span> () (set-buffer-modified-p nil)))
</pre>
</div>
</div>

<div id="outline-container-org54be168" class="outline-4">
<h4 id="org54be168">User interface</h4>
<div class="outline-text-4" id="text-org54be168">
<p>
Remove weird face in dired. I couldn&rsquo;t avoid <code>custom-set-faces</code> for this one.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(custom-set-faces
 '(bookmark-face ((t nil))))
</pre>
</div>

<p>
Show less information when opening dired (can be toggled with `(`).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-mode-hook 'dired-hide-details-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga9d1edd" class="outline-4">
<h4 id="orga9d1edd">Backend</h4>
<div class="outline-text-4" id="text-orga9d1edd">
<p>
Use <code>gnu-ls</code> and numerical sorting.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dired-use-ls-dired t)
(<span class="org-keyword">setq-default</span> insert-directory-program <span class="org-string">"/usr/local/bin/gls"</span>)
(<span class="org-keyword">setq-default</span> dired-listing-switches <span class="org-string">"-lGh1v --group-directories-first"</span>)


(<span class="org-keyword">defvar</span> <span class="org-variable-name">dired-show-hidden-files</span> nil
  <span class="org-doc">"Whether to show hidden files in dired."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">toggle-dired-show-hidden-files</span> ()
  <span class="org-doc">"Toggle showing hidden dired files."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> dired-show-hidden-files
      (<span class="org-keyword">progn</span>
        (<span class="org-keyword">setq</span> dired-listing-switches <span class="org-string">"-lGh1v --group-directories-first"</span>)
        (<span class="org-keyword">setq</span> dired-show-hidden-files nil)
        (message <span class="org-string">"Hiding hidden files."</span>))
    (<span class="org-keyword">setq</span> dired-listing-switches <span class="org-string">"-lAGh1v --group-directories-first"</span>)
    (<span class="org-keyword">setq</span> dired-show-hidden-files t)
    (message <span class="org-string">"Showing hidden files."</span>))
  (<span class="org-keyword">let</span> ((current-directory dired-directory))
    (kill-buffer)
    (dired current-directory)))
</pre>
</div>

<p>
Fix to open file in default application (macOS).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-open-in-default</span> ()
  <span class="org-doc">"Opens current file in default application.  `browse-url-of-dired-file` wasn't working."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((marked-files (dired-get-marked-files)))
    (<span class="org-keyword">if</span> (null marked-files)
        (shell-command (format <span class="org-string">"open '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">'"</span> (dired-current-directory)))
      (dired-do-shell-command <span class="org-string">"open"</span> 1 marked-files))))

(<span class="org-keyword">evil-define-key</span> 'normal dired-mode-map <span class="org-string">"W"</span> #'dired-open-in-default)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9d18526" class="outline-4">
<h4 id="org9d18526">Key bindings</h4>
<div class="outline-text-4" id="text-org9d18526">
<p>
Make sure S-j, S-k, and C-j are bound correctly for dired.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">evil-define-key</span> 'normal dired-mode-map <span class="org-string">"K"</span> #'(<span class="org-keyword">lambda</span> ()
                                                (<span class="org-keyword">interactive</span>)
                                                (scroll-down 3)))
(<span class="org-keyword">evil-define-key</span> 'normal dired-mode-map <span class="org-string">"J"</span> #'(<span class="org-keyword">lambda</span> ()
                                                (<span class="org-keyword">interactive</span>)
                                                (scroll-up 3)))
(<span class="org-keyword">evil-define-key</span> 'normal dired-mode-map (kbd <span class="org-string">"C-j"</span>) 'dired-find-file)
</pre>
</div>

<p>
Make sure <code>q</code> works in dired-mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">evil-define-key</span> 'normal 'dired-mode-map <span class="org-string">"q"</span> 'evil-owl-record-macro)
</pre>
</div>

<p>
Toggle showing hidden files.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key dired-mode-map (kbd <span class="org-string">"&lt;f5&gt;"</span>) #'toggle-dired-show-hidden-files)
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">open dired at cwd or go up directory</span>
(evil-leader/set-key <span class="org-string">"I"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">if</span> (equal major-mode 'dired-mode)
                                 (dired-up-directory)
                               (dired <span class="org-string">"."</span>))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">close current buffer and open dired at cwd or go up directory</span>
(evil-leader/set-key <span class="org-string">"i"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">if</span> (not (equal dired-directory <span class="org-string">"/"</span>))
                                 (<span class="org-keyword">let</span> ((old-buffer (current-buffer)))
                                   (<span class="org-keyword">if</span> (equal major-mode 'dired-mode)
                                       (<span class="org-keyword">progn</span>
                                         (dired-up-directory)
                                         (kill-buffer old-buffer))
                                     (dired <span class="org-string">"."</span>))))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">open marked files in dired</span>
(evil-leader/set-key <span class="org-string">"w"</span> #'(<span class="org-keyword">lambda</span> (open-all-marked)
                             (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
                             (<span class="org-keyword">if</span> (null open-all-marked)
                                 (shell-command (format <span class="org-string">"open '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">'"</span> buffer-file-name))
                               (<span class="org-keyword">let</span> ((files (get-all-marked-files-and-unmark)))
                                 (mapc #'browse-url files)
                                 (message <span class="org-string">"Unmarked %d files."</span> (length files))))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">open desktop</span>
(evil-leader/set-key <span class="org-string">"?"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (find-file (expand-file-name <span class="org-string">"~/Desktop/"</span>))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">open home</span>
(evil-leader/set-key <span class="org-string">"/"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (find-file (expand-file-name <span class="org-string">"~/"</span>))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgabffaed" class="outline-3">
<h3 id="orgabffaed">PDFs/images</h3>
<div class="outline-text-3" id="text-orgabffaed">
<p>
Revert buffer without confirmation.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> revert-without-query '(<span class="org-string">".pdf"</span>))
(add-hook 'pdf-view-mode-hook #'auto-revert-mode)
</pre>
</div>

<p>
Use <code>pdf-tools</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">pdf-hiding-cursor</span> nil
  <span class="org-doc">"Last buffer was a PDF and was hiding cursor."</span>)


(<span class="org-keyword">use-package</span> <span class="org-constant">pdf-tools</span>
  <span class="org-builtin">:config</span>
  (add-hook 'pdf-view-mode-hook
            #'(<span class="org-keyword">lambda</span> ()
                (add-to-list 'pdf-annot-default-annotation-properties '(text (icon . <span class="org-string">"Note"</span>)
                                                                             (color . <span class="org-string">"#fff"</span>)))
                (set (make-local-variable 'evil-normal-state-cursor) (list nil))))

  (pdf-tools-install))
</pre>
</div>

<p>
Scale images in image mode
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key image-mode-map (kbd <span class="org-string">"g ="</span>) 'image-increase-size)
(define-key image-mode-map (kbd <span class="org-string">"g -"</span>) 'image-decrease-size)
</pre>
</div>

<p>
Use light mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">pdf-has-set-light-mode</span> nil
  <span class="org-doc">"Whether PDf view has turned on light mode."</span>)

(add-hook 'post-command-hook #'(<span class="org-keyword">lambda</span> ()
                                 (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (not (equal major-mode 'pdf-view-mode)) pdf-has-set-light-mode)
                                   (reset-temporary-face-attributes)
                                   (set-background-color color-background)
                                   (set-foreground-color color-foreground)
                                   (<span class="org-keyword">setq</span> evil-normal-state-cursor '(<span class="org-string">"#fdf4c1"</span> box))
                                   (<span class="org-keyword">setq</span> pdf-has-set-light-mode nil))))

(add-hook 'post-command-hook #'(<span class="org-keyword">lambda</span> ()
                                 (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (equal major-mode 'pdf-view-mode)
                                            (equal (count-windows) 1))
                                   (<span class="org-keyword">setq</span> pdf-has-set-light-mode t)
                                   (set-background-color <span class="org-string">"#FFF"</span>)
                                   (set-foreground-color color-background)
                                   (<span class="org-keyword">setq</span> evil-normal-state-cursor '(<span class="org-string">"#FFF"</span> box))

                                   (set-temporary-face-attributes
                                    <span class="org-builtin">:background</span> <span class="org-string">"#FFF"</span>
                                    '(header-line
                                      mode-line))

                                   (set-temporary-face-attributes
                                    <span class="org-builtin">:foreground</span> color-background
                                    '(mode-line
                                      mood-line-buffer-name
                                      mood-line-major-mode
                                      mood-line-modified
                                      mood-line-status-error
                                      mood-line-status-info
                                      mood-line-status-neutral
                                      mood-line-status-success
                                      mood-line-status-warning
                                      mood-line-unimportant)))))
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">evil-define-key</span> 'visual pdf-view-mode-map (kbd <span class="org-string">"g h"</span>) #'pdf-annot-add-highlight-markup-annotation)

(<span class="org-keyword">evil-define-key</span> 'visual pdf-view-mode-map (kbd <span class="org-string">"g t"</span>) #'pdf-annot-add-text-annotation)
(<span class="org-keyword">evil-define-key</span> 'normal pdf-view-mode-map (kbd <span class="org-string">"g t"</span>) #'pdf-annot-add-text-annotation)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org06a7c27" class="outline-2">
<h2 id="org06a7c27">Org</h2>
<div class="outline-text-2" id="text-org06a7c27">
<p>
Make sure all code is run after org mode is loaded.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">org</span>
  <span class="org-builtin">:hook</span> ((org-mode . flyspell-mode)
         (text-mode . flyspell-mode))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq-default</span> org-emphasis-regexp-components
                '(<span class="org-string">"   ('\"{\x200B"</span> <span class="org-string">"-     .,:!?;'\")}\\[\x200B"</span> <span class="org-string">" ,\"'"</span> <span class="org-string">"."</span> 20))
  
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">ox</span>)

  &lt;&lt;org-mode-variables&gt;&gt;
  &lt;&lt;org-mode-config&gt;&gt;
  &lt;&lt;org-mode-compilation&gt;&gt;
  &lt;&lt;org-mode-emphasis-markers&gt;&gt;
  &lt;&lt;org-mode-greek&gt;&gt;
  &lt;&lt;org-mode-keybindings&gt;&gt;
  &lt;&lt;org-mode-faces&gt;&gt;
  &lt;&lt;org-mode-references&gt;&gt;
  &lt;&lt;autocorrect-words&gt;&gt;
  &lt;&lt;python-babel&gt;&gt;
  &lt;&lt;org-capture-popup&gt;&gt;
  &lt;&lt;org-mode-extend-emphasis&gt;&gt;)
</pre>
</div>

<p>
Set defaults.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> org-return-follows-link nil)
(<span class="org-keyword">setq-default</span> org-src-preserve-indentation t)
(<span class="org-keyword">setq-default</span> org-src-window-setup 'current-window)
(<span class="org-keyword">setq-default</span> org-src-tab-acts-natively t)
(<span class="org-keyword">setq-default</span> org-html-htmlize-output-type 'css)


<span class="org-comment-delimiter">;; </span><span class="org-comment">prevent org from splitting line on meta return       </span>
(<span class="org-keyword">setq-default</span> org-M-RET-may-split-line nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">pretty LaTeX entities for org mode</span>
(<span class="org-keyword">setq-default</span> org-pretty-entities t)


<span class="org-comment-delimiter">;; </span><span class="org-comment">prevent confirmation prompt when executing code blocks</span>
(<span class="org-keyword">setq-default</span> org-confirm-babel-evaluate nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">prevent section indentation</span>
(<span class="org-keyword">setq-default</span> org-adapt-indentation nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use all agenda files as refile targets</span>
(<span class="org-keyword">setq-default</span> org-refile-targets '((org-agenda-files <span class="org-builtin">:maxlevel</span> . 1)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">prevent section numbering in exports</span>
(<span class="org-keyword">setq-default</span> org-export-with-section-numbers nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">show markdown for org-mode</span>
(<span class="org-keyword">setq-default</span> org-hide-emphasis-markers nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use different ellipsis for folded content</span>
(<span class="org-keyword">setq-default</span> org-ellipsis <span class="org-string">" [...]"</span>)


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure to color latex</span>
(<span class="org-keyword">setq-default</span> org-highlight-latex-and-related '(latex entities))


<span class="org-comment-delimiter">;; </span><span class="org-comment">latex formatting</span>
(<span class="org-keyword">setq-default</span> org-format-latex-options '(<span class="org-builtin">:foreground</span> default
                                                     <span class="org-builtin">:background</span> default
                                                     <span class="org-builtin">:scale</span> 1.0
                                                     <span class="org-builtin">:html-foreground</span> <span class="org-string">"Black"</span>
                                                     <span class="org-builtin">:html-background</span> <span class="org-string">"Transparent"</span>
                                                     <span class="org-builtin">:html-scale</span> 0.4
                                                     <span class="org-builtin">:matchers</span> (<span class="org-string">"begin"</span> <span class="org-string">"$1"</span> <span class="org-string">"$"</span> <span class="org-string">"$$"</span> <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">"</span> <span class="org-string">"\\["</span>)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">prevent html export from having postamble</span>
(<span class="org-keyword">setq-default</span> org-html-postamble nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">remove table of contents from export</span>
(<span class="org-keyword">setq-default</span> org-export-with-toc nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use smart quotation marks</span>
(<span class="org-keyword">setq-default</span> org-export-with-smart-quotes t)


<span class="org-comment-delimiter">;; </span><span class="org-comment">stop displaying inline images in org-mode</span>
(<span class="org-keyword">setq-default</span> org-startup-with-inline-images nil)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-babel-after-execute-hook 'org-display-inline-images 'append)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">default image width </span>
(<span class="org-keyword">setq-default</span> org-image-actual-width 600)


<span class="org-comment-delimiter">;; </span><span class="org-comment">change MathJax formatting</span>
(<span class="org-keyword">setf</span> org-html-mathjax-options
      '((path <span class="org-string">"https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"</span>)
        (scale <span class="org-string">"90"</span>) 
        (align <span class="org-string">"center"</span>) 
        (indent <span class="org-string">"2em"</span>)
        (mathml nil)
        (font <span class="org-string">"Neo-Euler"</span>)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">change custom date format</span>
(<span class="org-keyword">setq-default</span> org-time-stamp-custom-formats '(<span class="org-string">"&lt;%A, %m/%d/%y&gt;"</span> . <span class="org-string">"&lt;%A, %m/%d/%y, %H:%M&gt;"</span>))
</pre>
</div>

<p>
Use section numbering.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">org-section-num-format</span> (numbering)
  (<span class="org-keyword">if</span> (= (length numbering) 1)
      (propertize (concat (mapconcat
                           #'number-to-string
                           numbering <span class="org-string">"."</span>) <span class="org-string"><span class="org-warning">" | "</span></span><span class="org-warning"> )</span>
                  'face `(<span class="org-builtin">:family</span> <span class="org-string">"Victor Mono"</span>
                                  <span class="org-builtin">:height</span> 140
                                  <span class="org-builtin">:foreground</span> ,color-darkish-subdued))
    (propertize (concat (mapconcat
                         #'number-to-string
                         numbering <span class="org-string">"."</span>) <span class="org-string"><span class="org-warning">" &#8212; "</span></span><span class="org-warning"> )</span>
                'face `(<span class="org-builtin">:family</span> <span class="org-string">"Victor Mono"</span>
                                <span class="org-builtin">:height</span> 140
                                <span class="org-builtin">:foreground</span> ,color-dark-subdued))))


(font-lock-add-keywords 'org-mode
                        `((<span class="org-string">"^*+ "</span> . 'org-meta-line)))


(<span class="org-keyword">setq-default</span> org-num-format-function #'org-section-num-format)


(add-hook 'org-mode-hook #'org-num-mode)
</pre>
</div>
</div>

<div id="outline-container-org41b3730" class="outline-3">
<h3 id="org41b3730">Compilation</h3>
<div class="outline-text-3" id="text-org41b3730">
<p>
Compile all org files with a given name into one file (recursive).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">replace-all</span> (regexp string)
  (<span class="org-keyword">save-excursion</span>
    (goto-char (point-min))
    (<span class="org-keyword">while</span> (re-search-forward regexp nil t)
      (replace-match string))))

(<span class="org-keyword">defun</span> <span class="org-function-name">org-compile-files</span> (dir regexp title)
  (<span class="org-keyword">interactive</span> <span class="org-string">"DWhich directory? \nsWhich files? \nsWhat title? "</span>)
  (<span class="org-keyword">let</span> ((files (directory-files-recursively dir regexp))
        (output-path (concat dir <span class="org-string">"compilation.org"</span>)))
    (write-region (format <span class="org-string">"#+title: %s\n\n"</span> title) nil output-path)
    (mapc (<span class="org-keyword">lambda</span> (file)
            (<span class="org-keyword">with-temp-buffer</span>
              (insert-file-contents file)
              (replace-all <span class="org-string">"^\\*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">\\** </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> <span class="org-string">"**\\1"</span>)
              (replace-all <span class="org-string">"#\\+title: </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> <span class="org-string">"* \\1"</span>)
              (goto-char (point-max))
              (newline)
              (append-to-file (point-min) (point-max) output-path)))
          files)
    (find-file output-path)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd96dd9c" class="outline-3">
<h3 id="orgd96dd9c">Capture</h3>
<div class="outline-text-3" id="text-orgd96dd9c">
<p>
Stop creating bookmarks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> org-capture-bookmark nil)
</pre>
</div>

<p>
Make sure capture is the only window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-capture-mode-hook #'(<span class="org-keyword">lambda</span> ()
                                     (delete-other-windows)
                                     (evil-insert-state)
                                     (<span class="org-keyword">setq-local</span> header-line-format nil)))
</pre>
</div>

<p>
Customize org capture popup.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">org-capture-select-template</span> (<span class="org-type">&amp;optional</span> keys)
  <span class="org-doc">"Select a capture template.</span>
<span class="org-doc">Lisp programs can force the template by setting KEYS to a string."</span>
  (<span class="org-keyword">let</span> ((org-capture-templates
         (<span class="org-keyword">or</span> (org-contextualize-keys
              (org-capture-upgrade-templates org-capture-templates)
              org-capture-templates-contexts)
             '((<span class="org-string">"t"</span> <span class="org-string">"Task"</span> entry (file+headline <span class="org-string">""</span> <span class="org-string">"Tasks"</span>)
                <span class="org-string">"* TODO %?\n  %u\n  %a"</span>)))))
    (<span class="org-keyword">if</span> keys
        (<span class="org-keyword">or</span> (assoc keys org-capture-templates)
            (<span class="org-warning">error</span> <span class="org-string">"No capture template referred to by \"%s\" keys"</span> keys))
      (org-mks org-capture-templates
               (concat
                <span class="org-string">"Select a capture template\n"</span>
                (make-string 25 9472))
               <span class="org-string">"Template key: "</span>
               '((<span class="org-string">"C"</span> <span class="org-string">"Customize org-capture-templates"</span>)
                 (<span class="org-string">"q"</span> <span class="org-string">"Abort"</span>))))))


(<span class="org-keyword">defun</span> <span class="org-function-name">org-mks</span> (table title <span class="org-type">&amp;optional</span> prompt specials)
  <span class="org-doc">"Select a member of an alist with multiple keys.</span>

<span class="org-doc">TABLE is the alist which should contain entries where the car is a string.</span>
<span class="org-doc">There should be two types of entries.</span>

<span class="org-doc">1. prefix descriptions like (\"a\" \"Description\")</span>
<span class="org-doc">   This indicates that `</span><span class="org-doc"><span class="org-constant">a</span></span><span class="org-doc">' is a prefix key for multi-letter selection, and</span>
<span class="org-doc">   that there are entries following with keys like \"ab\", \"ax\"...</span>

<span class="org-doc">2. Select-able members must have more than two elements, with the first</span>
<span class="org-doc">   being the string of keys that lead to selecting it, and the second a</span>
<span class="org-doc">   short description string of the item.</span>

<span class="org-doc">The command will then make a temporary buffer listing all entries</span>
<span class="org-doc">that can be selected with a single key, and all the single key</span>
<span class="org-doc">prefixes.  When you press the key for a single-letter entry, it is selected.</span>
<span class="org-doc">When you press a prefix key, the commands (and maybe further prefixes)</span>
<span class="org-doc">under this key will be shown and offered for selection.</span>

<span class="org-doc">TITLE will be placed over the selection in the temporary buffer,</span>
<span class="org-doc">PROMPT will be used when prompting for a key.  SPECIALS is an</span>
<span class="org-doc">alist with (\"key\" \"description\") entries.  When one of these</span>
<span class="org-doc">is selected, only the bare key is returned."</span>
  (<span class="org-keyword">save-window-excursion</span>
    (<span class="org-keyword">let</span> ((inhibit-quit t)
          (buffer (org-switch-to-buffer-other-window <span class="org-string">"*Org Select*"</span>))
          (prompt (<span class="org-keyword">or</span> prompt <span class="org-string">"Select: "</span>))
          case-fold-search
          current)
      (<span class="org-keyword">setq-local</span> olivetti-body-width 50)
      (olivetti-mode 1)
      (<span class="org-keyword">unwind-protect</span>
          (<span class="org-keyword">catch</span> '<span class="org-constant">exit</span>
            (<span class="org-keyword">while</span> t
              (erase-buffer)
              (insert title <span class="org-string">"\n\n"</span>)
              (<span class="org-keyword">let</span> ((des-keys nil)
                    (allowed-keys '(<span class="org-string">"\C-g"</span>))
                    (tab-alternatives '(<span class="org-string">"\s"</span> <span class="org-string">"\t"</span> <span class="org-string">"\r"</span>))
                    (cursor-type nil))
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Populate allowed keys and descriptions keys</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">available with CURRENT selector.</span>
                (<span class="org-keyword">let</span> ((re (format <span class="org-string">"\\`%s</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">\\'"</span>
                                  (<span class="org-keyword">if</span> current (regexp-quote current) <span class="org-string">""</span>)))
                      (prefix (<span class="org-keyword">if</span> current (concat current <span class="org-string">" "</span>) <span class="org-string">""</span>)))
                  (<span class="org-keyword">dolist</span> (entry table)
                    (<span class="org-keyword">pcase</span> entry
                      <span class="org-comment-delimiter">;; </span><span class="org-comment">Description.</span>
                      (`(,(<span class="org-keyword">and</span> key (pred (string-match re))) ,desc)
                       (<span class="org-keyword">let</span> ((k (match-string 1 key)))
                         (<span class="org-keyword">push</span> k des-keys)
                         <span class="org-comment-delimiter">;; </span><span class="org-comment">Keys ending in tab, space or RET are equivalent.</span>
                         (<span class="org-keyword">if</span> (member k tab-alternatives)
                             (<span class="org-keyword">push</span> <span class="org-string">"\t"</span> allowed-keys)
                           (<span class="org-keyword">push</span> k allowed-keys))
                         (insert prefix <span class="org-string">"["</span> k <span class="org-string">"]"</span> <span class="org-string">"..."</span> <span class="org-string">"  "</span> desc <span class="org-string">"..."</span> <span class="org-string">"\n"</span>)))
                      <span class="org-comment-delimiter">;; </span><span class="org-comment">Usable entry.</span>
                      (`(,(<span class="org-keyword">and</span> key (pred (string-match re))) ,desc . ,_)
                       (<span class="org-keyword">let</span> ((k (match-string 1 key)))
                         (insert prefix <span class="org-string">"["</span> k <span class="org-string">"]"</span> <span class="org-string">"     "</span> desc <span class="org-string">"\n"</span>)
                         (<span class="org-keyword">push</span> k allowed-keys)))
                      (_ nil))))
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert special entries, if any.</span>
                (<span class="org-keyword">when</span> specials
                  (insert (concat <span class="org-string">"\n"</span> (make-string (- (window-width) 1) 9472) <span class="org-string">"\n"</span> <span class="org-string">"\n"</span>))
                  (<span class="org-keyword">pcase-dolist</span> (`(,key ,description) specials)
                    (insert (format <span class="org-string">"[%s]     %s\n"</span> key description))
                    (<span class="org-keyword">push</span> key allowed-keys)))
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Display UI and let user select an entry or</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">a sub-level prefix.</span>
                (goto-char (point-min))
                (org-fit-window-to-buffer)
                (message <span class="org-string">""</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">With this line the prompt appears in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">the minibuffer. Else keystrokes may</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">appear, which is spurious.</span>
                (<span class="org-keyword">let</span> ((pressed (org--mks-read-key
                                allowed-keys prompt
                                (not (pos-visible-in-window-p (1- (point-max)))))))
                  (<span class="org-keyword">setq</span> current (concat current pressed))
                  (<span class="org-keyword">cond</span>
                   ((equal pressed <span class="org-string">"\C-g"</span>) (<span class="org-warning">user-error</span> <span class="org-string">"Abort"</span>))
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Selection is a prefix: open a new menu.</span>
                   ((member pressed des-keys))
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Selection matches an association: return it.</span>
                   ((<span class="org-keyword">let</span> ((entry (assoc current table)))
                      (<span class="org-keyword">and</span> entry (<span class="org-keyword">throw</span> '<span class="org-constant">exit</span> entry))))
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Selection matches a special entry: return the</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">selection prefix.</span>
                   ((assoc current specials) (<span class="org-keyword">throw</span> '<span class="org-constant">exit</span> current))
                   (t (<span class="org-warning">error</span> <span class="org-string">"No entry available"</span>)))))))
        (<span class="org-keyword">when</span> buffer (kill-buffer buffer))))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">stop opening new window</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">org-switch-to-buffer-other-window</span> (<span class="org-type">&amp;rest</span> args)
  <span class="org-doc">"Switch to buffer in a second window on the current frame.</span>
<span class="org-doc">In particular, do not allow pop-up frames.</span>
<span class="org-doc">Returns the newly created buffer."</span>
  (<span class="org-keyword">org-no-popups</span> (apply #'switch-to-buffer args)))
</pre>
</div>

<p>
Templates.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> org-capture-templates
              '((<span class="org-string">"g"</span> <span class="org-string">"General"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"General"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"m"</span> <span class="org-string">"Meeting"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"General"</span>)
                 <span class="org-string">"** %?  :meeting:"</span>)
                (<span class="org-string">"i"</span> <span class="org-string">"BYU IS"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"Work"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"r"</span> <span class="org-string">"Research"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"Research"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"v"</span> <span class="org-string">"Event"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"General"</span>)
                 <span class="org-string">"** %?  :event:"</span>)
                (<span class="org-string">"c"</span> <span class="org-string">"MATH 215"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"MATH 215"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"l"</span> <span class="org-string">"MATH 213"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"MATH 213"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"a"</span> <span class="org-string">"PHSCS 127"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"PHSCS 127"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"p"</span> <span class="org-string">"CS 111"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"CS 111"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"f"</span> <span class="org-string">"REL C 200"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"REL C 200"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"w"</span> <span class="org-string">"PHSCS 123"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"PHSCS 123"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"s"</span> <span class="org-string">"PHSCS 191"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"PHSCS 191"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"j"</span> <span class="org-string">"Major"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"Major"</span>)
                 <span class="org-string">"** TODO %?"</span>)
                (<span class="org-string">"e"</span> <span class="org-string">"Emacs"</span> entry (file+headline <span class="org-string">"~/Documents/Education/schedule.org"</span> <span class="org-string">"Emacs"</span>)
                 <span class="org-string">"** TODO %?"</span>)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span class="org-string">"c"</span> #'org-capture)
</pre>
</div>
</div>
</div>

<div id="outline-container-org450eecc" class="outline-3">
<h3 id="org450eecc">User interface</h3>
<div class="outline-text-3" id="text-org450eecc">
<p>
Code to show emphasis markers using a particular face.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">change face for emphasis markers</span>
(<span class="org-keyword">defface</span> <span class="org-variable-name">org-emphasis-marker</span> '((t (<span class="org-builtin">:inherit</span> shadow)))
  <span class="org-doc">"Face for Org emphasis markers"</span>
  <span class="org-builtin">:group</span> 'org-faces)


(<span class="org-keyword">defun</span> <span class="org-function-name">org-do-emphasis-faces</span> (limit)
  <span class="org-doc">"Run through the buffer and emphasize strings."</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">org-macs</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">org-compat</span>)
  (<span class="org-keyword">let</span> ((quick-re (format <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[%s]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[~=*/_+]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>
                          (car org-emphasis-regexp-components))))
    (<span class="org-keyword">catch</span> <span class="org-constant">:exit</span>
      (<span class="org-keyword">while</span> (re-search-forward quick-re limit t)
        (<span class="org-keyword">let*</span> ((marker (match-string 2))
               (verbatim? (member marker '(<span class="org-string">"~"</span> <span class="org-string">"="</span>))))
          (<span class="org-keyword">when</span> (<span class="org-keyword">save-excursion</span>
                  (goto-char (match-beginning 0))
                  (<span class="org-keyword">and</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not match table hlines.</span>
                   (not (<span class="org-keyword">and</span> (equal marker <span class="org-string">"+"</span>)
                             (org-match-line
                              <span class="org-string">"[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">|[-+]+|?</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\+[-+]+\\+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*$"</span>)))
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not match headline stars.  Do not consider</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">stars of a headline as closing marker for bold</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">markup either.</span>
                   (not (<span class="org-keyword">and</span> (equal marker <span class="org-string">"*"</span>)
                             (<span class="org-keyword">save-excursion</span>
                               (forward-char)
                               (skip-chars-backward <span class="org-string">"*"</span>)
                               (looking-at-p org-outline-regexp-bol))))
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Match full emphasis markup regexp.</span>
                   (looking-at (<span class="org-keyword">if</span> verbatim? org-verbatim-re org-emph-re))
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not span over paragraph boundaries.</span>
                   (not (string-match-p org-element-paragraph-separate
                                        (match-string 2)))
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not span over cells in table rows.</span>
                   (not (<span class="org-keyword">and</span> (<span class="org-keyword">save-match-data</span> (org-match-line <span class="org-string">"[ \t]*|"</span>))
                             (string-match-p <span class="org-string">"|"</span> (match-string 4))))))
            (<span class="org-keyword">pcase-let</span> ((`(,_ ,face ,_) (assoc marker org-emphasis-alist)))
              (font-lock-prepend-text-property
               (match-beginning 2) (match-end 2) 'face face)
              (<span class="org-keyword">when</span> verbatim?
                (org-remove-flyspell-overlays-in
                 (match-beginning 0) (match-end 0))
                (remove-text-properties (match-beginning 2) (match-end 2)
                                        '(display t invisible t intangible t)))
              (add-text-properties (match-beginning 2) (match-end 2)
                                   '(font-lock-multiline t org-emphasis t)))

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Begin new code</span>
            (font-lock-prepend-text-property
             (match-beginning 3) (match-end 3) 'face 'org-emphasis-marker)
            (font-lock-prepend-text-property
             (match-end 4) (match-beginning 5) 'face 'org-emphasis-marker)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">End new code</span>

            (<span class="org-keyword">when</span> org-hide-emphasis-markers
              (add-text-properties (match-end 4) (match-beginning 5)
                                   '(invisible org-link))
              (add-text-properties (match-beginning 3) (match-end 3)
                                   '(invisible org-link))))
          (<span class="org-keyword">throw</span> <span class="org-constant">:exit</span> t))))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">thanks, https://www.reddit.com/r/emacs/comments/eipbvk/org_emphasis_marker_face/</span>
</pre>
</div>

<p>
Use other font for Greek text.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">not necessarily the best approach, but it works</span>
(add-hook 'org-mode-hook #'(<span class="org-keyword">lambda</span> ()
                             (set-fontset-font t 'greek (font-spec <span class="org-builtin">:family</span> <span class="org-string">"Helvetica"</span> <span class="org-builtin">:weight</span> 'normal <span class="org-builtin">:height</span> 0.75))))

</pre>
</div>

<p>
Use variable pitch in org buffers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">mixed-pitch</span>
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq-default</span> mixed-pitch-set-height t)
  (set-face-attribute 'variable-pitch nil <span class="org-builtin">:height</span> 1.15))
</pre>
</div>

<p>
Hide source blocks by default (thanks, <a href="https://emacs.stackexchange.com/a/7366">https://emacs.stackexchange.com/a/7366</a>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">org-blocks-hidden</span> nil)

(<span class="org-keyword">defun</span> <span class="org-function-name">org-toggle-blocks</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> org-blocks-hidden
      (org-show-block-all)
    (org-hide-block-all))
  (<span class="org-keyword">setq-local</span> org-blocks-hidden (not org-blocks-hidden)))

(add-hook 'org-mode-hook #'org-toggle-blocks)
</pre>
</div>

<p>
Indent <code>src</code> block header.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-src-mode-hook #'(<span class="org-keyword">lambda</span> ()
                                 (<span class="org-keyword">setq</span> header-line-format <span class="org-string">""</span>)))
</pre>
</div>

<p>
Customize faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'org-block-begin-line nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:background</span> color-background
                    <span class="org-builtin">:foreground</span> color-dark-subdued)


(set-face-attribute 'org-block nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#fdf4c1"</span>
                    <span class="org-builtin">:background</span> <span class="org-string">"#121112"</span>)


(set-face-attribute 'org-code nil
                    <span class="org-builtin">:inherit</span> 'shadow)


(set-face-attribute 'org-document-info-keyword nil
                    <span class="org-builtin">:inherit</span> 'shadow)


(set-face-attribute 'org-document-title nil
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>
                    <span class="org-builtin">:height</span> 190
                    <span class="org-builtin">:foreground</span> color-foreground)


(set-face-attribute 'org-link nil
                    <span class="org-builtin">:inherit</span> 'custom-link)


(set-face-attribute 'org-meta-line nil
                    <span class="org-builtin">:foreground</span> color-dark-subdued)


(set-face-attribute 'org-property-value nil
                    <span class="org-builtin">:inherit</span> nil
                    <span class="org-builtin">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-special-keyword nil
                    <span class="org-builtin">:inherit</span> 'font-lock-comment-face
                    <span class="org-builtin">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-todo nil
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-dark-brown)


(set-face-attribute 'org-verbatim nil
                    <span class="org-builtin">:inherit</span> 'shadow
                    <span class="org-builtin">:foreground</span> color-light-green)


(set-face-attribute 'outline-1 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 180
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'outline-2 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 160
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'outline-3 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 160
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'outline-4 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 160
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'outline-5 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 160
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'outline-6 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 160
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'outline-7 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 160
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'outline-8 nil
                    <span class="org-builtin">:extend</span> t
                    <span class="org-builtin">:height</span> 160
                    <span class="org-builtin">:weight</span> 'bold
                    <span class="org-builtin">:foreground</span> color-light-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Optima"</span>)


(set-face-attribute 'org-emphasis-marker nil
                    <span class="org-builtin">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-table nil
                    <span class="org-builtin">:foreground</span> color-brown)


(set-face-attribute 'org-ellipsis nil
                    <span class="org-builtin">:foreground</span> color-dark-subdued
                    <span class="org-builtin">:family</span> <span class="org-string">"Victor Mono"</span>
                    <span class="org-builtin">:height</span> 120)


(set-face-attribute 'org-tag nil
                    <span class="org-builtin">:foreground</span> color-dark-subdued
                    <span class="org-builtin">:height</span> 140)


(set-face-attribute 'org-checkbox nil
                    <span class="org-builtin">:foreground</span> color-brown
                    <span class="org-builtin">:height</span> 140)


(set-face-attribute 'org-latex-and-related nil
                    <span class="org-builtin">:foreground</span> color-green
                    <span class="org-builtin">:weight</span> 'bold)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd2e3d0" class="outline-3">
<h3 id="orgbd2e3d0">Editing</h3>
<div class="outline-text-3" id="text-orgbd2e3d0">
<p>
Add <code>evil-embrace</code> pairs to org mode and add text objects.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-mode-hook #'(<span class="org-keyword">lambda</span> ()
                             (delete ?b evil-embrace-evil-surround-keys)

                             (embrace-add-pair ?i <span class="org-string">"/"</span> <span class="org-string">"/"</span>)
                             (embrace-add-pair ?b <span class="org-string">"*"</span> <span class="org-string">"*"</span>)
                             (embrace-add-pair ?u <span class="org-string">"_"</span> <span class="org-string">"_"</span>)))


(<span class="org-keyword">use-package</span> <span class="org-constant">evil-tex</span>
  <span class="org-builtin">:config</span>
  (add-hook 'org-mode-hook #'evil-tex-mode)

  (<span class="org-keyword">setq-default</span> evil-tex-surround-delimiters
                `((?m <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"> "</span> . <span class="org-string">" </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>)
                  (?M <span class="org-string">"\\[ "</span> . <span class="org-string">" \\]"</span>)
                  (?c . ,#'evil-tex-surround-command-prompt)
                  (?e . ,#'evil-tex-surround-env-prompt)
                  (?d . ,#'evil-tex-surround-delim-prompt)
                  (?\; . ,#'evil-tex-surround-cdlatex-accents-prompt)
                  (?q <span class="org-string">"`"</span> . <span class="org-string">"'"</span>)
                  (?Q <span class="org-string">"``"</span> . <span class="org-string">"''"</span>)
                  (?^ <span class="org-string">"^{"</span> . <span class="org-string">"}"</span>)
                  (?_ <span class="org-string">"_{"</span> . <span class="org-string">"}"</span>)
                  (?T <span class="org-string">"&amp;"</span> . <span class="org-string">"&amp;"</span>)))

  (<span class="org-keyword">setq-default</span> evil-tex-delim-map
                (<span class="org-keyword">let</span> ((keymap (make-sparse-keymap)))
                  (evil-tex-bind-to-delim-map
                   '((<span class="org-string">"P"</span>  <span class="org-string">"("</span> . <span class="org-string">")"</span>)
                     (<span class="org-string">"p"</span>  <span class="org-string">"\\left( "</span> . <span class="org-string">" \\right)"</span>)
                     (<span class="org-string">"S"</span>  <span class="org-string">"["</span> . <span class="org-string">"]"</span>)
                     (<span class="org-string">"s"</span>  <span class="org-string">"\\left[ "</span> . <span class="org-string">" \\right]"</span>)
                     (<span class="org-string">"C"</span>  <span class="org-string">"\\{ "</span> . <span class="org-string">" \\}"</span>)
                     (<span class="org-string">"c"</span>  <span class="org-string">"\\left\\{ "</span> . <span class="org-string">" \\right\\}"</span>)
                     (<span class="org-string">"R"</span>  <span class="org-string">"\\langle "</span> . <span class="org-string">" \\rangle"</span>)
                     (<span class="org-string">"r"</span>  <span class="org-string">"\\left\\langle "</span> . <span class="org-string">" \\right\\rangle"</span>)
                     (<span class="org-string">"v"</span> <span class="org-string">"\\left\\lvert "</span> . <span class="org-string">" \\right\\rvert"</span>)
                     (<span class="org-string">"V"</span> <span class="org-string">"\\lvert "</span> . <span class="org-string">" \\rvert"</span>)
                     (<span class="org-string">"n"</span> <span class="org-string">"\\left\\lVert "</span> . <span class="org-string">" \\right\\rVert"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">(n for norm)</span>
                     (<span class="org-string">"N"</span> <span class="org-string">"\\lVert "</span> . <span class="org-string">" \\rVert"</span>))
                   keymap)
                  keymap)))
</pre>
</div>

<p>
Display entities in current line (thanks <a href="https://www.reddit.com/r/emacs/comments/i9pfld/disable_orgprettyentities_on_the_current_line/">Reddit</a>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">my/current-line</span> '(0 . 0)
  <span class="org-doc">"(start . end) of current line in current buffer"</span>)
(make-variable-buffer-local 'my/current-line)


(<span class="org-keyword">defvar</span> <span class="org-variable-name">my/unhiding-current-line</span> t
  <span class="org-doc">"Whether to unhide current line."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">my/unhide-current-line</span> (limit)
  <span class="org-doc">"Font-lock function"</span>
  (<span class="org-keyword">when</span> my/unhiding-current-line
    (<span class="org-keyword">let</span> ((start (max (point) (car my/current-line)))
          (end (min limit (cdr my/current-line))))
      (<span class="org-keyword">when</span> (&lt; start end)
        (remove-text-properties start end '(invisible t display <span class="org-string">""</span> composition <span class="org-string">""</span>))
        (goto-char limit)
        t))))


(<span class="org-keyword">defun</span> <span class="org-function-name">my/refontify-on-linemove</span> ()
  <span class="org-doc">"Post-command-hook"</span>
  (<span class="org-keyword">let*</span> ((start (line-beginning-position))
         (end (line-beginning-position 2))
         (needs-update (not (equal start (car my/current-line)))))
    (<span class="org-keyword">setq</span> my/current-line (cons start end))
    (<span class="org-keyword">when</span> needs-update
      (font-lock-fontify-block 2))))


(<span class="org-keyword">defun</span> <span class="org-function-name">my/entity-unhighlight</span> ()
  <span class="org-doc">"Install"</span>
  (font-lock-add-keywords nil '((my/unhide-current-line)) t)
  (add-hook 'post-command-hook #'my/refontify-on-linemove nil t))

(add-hook 'org-mode-hook #'my/entity-unhighlight)
</pre>
</div>

<p>
Make sure emphasis works across multiple lines.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
</pre>
</div>

<p>
Copy text without newlines (useful due to auto-fill mode).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">evil-define-operator</span> <span class="org-function-name">evil-yank-no-newlines</span> (beg end type register yank-handler)
  <span class="org-doc">"Yank text from BEG to END with TYPE while stripping newlines."</span>
  <span class="org-builtin">:move-point</span> nil
  <span class="org-builtin">:repeat</span> nil
  (<span class="org-keyword">interactive</span> <span class="org-string">"&lt;R&gt;&lt;x&gt;&lt;y&gt;"</span>)
  (<span class="org-keyword">let</span> ((evil-was-yanked-without-register
         (<span class="org-keyword">and</span> evil-was-yanked-without-register (not register))))
    (<span class="org-keyword">let</span> ((old-buffer (current-buffer)))
      (<span class="org-keyword">with-temp-buffer</span>
        (insert-buffer-substring old-buffer beg end)
        (<span class="org-keyword">let</span> ((fill-column (point-max)))
          (fill-region (point-min) (point-max)))
      (<span class="org-keyword">cond</span>
       ((eq type 'block)
        (evil-yank-rectangle (point-min) (point-max) register yank-handler))
       ((memq type '(line screen-line))
        (evil-yank-lines (point-min) (point-max) register yank-handler))
       (t
        (evil-yank-characters (point-min) (point-max) register yank-handler)))))))


(<span class="org-keyword">evil-define-key</span> 'visual org-mode-map <span class="org-string">"Y"</span> 'evil-yank-no-newlines)
</pre>
</div>

<p>
Blank table region (only works on one column at a time for now).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">org-table-blank-selected-fields</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let*</span> ((start (region-beginning))
         (end (region-end))
         (start-line (line-number-at-pos start))
         (end-line (line-number-at-pos end))
         (line-count (- end-line start-line)))
    (<span class="org-keyword">save-excursion</span>
      (goto-char start)
      (<span class="org-keyword">dotimes</span> (_ line-count)
        (org-table-blank-field)
        (next-line))
      (org-table-blank-field))))


(<span class="org-keyword">evil-define-key</span> 'visual org-mode-map (kbd <span class="org-string">"RET"</span>) #'org-table-blank-selected-fields)
</pre>
</div>

<p>
Auto-capitalize words.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">auto-capitalize</span>
  <span class="org-builtin">:load-path</span> <span class="org-string">"lisp/"</span>
  <span class="org-builtin">:hook</span> (org-mode . auto-capitalize-mode)

  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq-default</span> auto-capitalize-predicate
                #'(<span class="org-keyword">lambda</span> ()
                    (<span class="org-keyword">and</span> (not (texmathp))
                         (not (org-in-src-block-p))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1ecf4d4" class="outline-3">
<h3 id="org1ecf4d4">Key bindings</h3>
<div class="outline-text-3" id="text-org1ecf4d4">
<p>
Set key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">make sure C-; works in org-mode</span>
(define-key org-mode-map (kbd <span class="org-string">"C-;"</span>) #'eval-expression)
(define-key flyspell-mode-map (kbd <span class="org-string">"C-;"</span>) #'eval-expression)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use RET for newline and to fill paragraph</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key org-mode-map (kbd "&lt;RET&gt;")</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">#'(lambda ()</span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(interactive)</span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(newline)</span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(when (equal (char-before (- (point) 1)) ?\C-j)</span>
<span class="org-comment-delimiter">;;         </span><span class="org-comment">(fill-paragraph))))</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">toggle link display</span>
(define-key org-mode-map (kbd <span class="org-string">"&lt;f8&gt;"</span>) #'org-toggle-link-display)


<span class="org-comment-delimiter">;; </span><span class="org-comment">compile org files</span>
(define-key org-mode-map (kbd <span class="org-string">"&lt;f4&gt;"</span>) #'org-compile-files)
(define-key dired-mode-map (kbd <span class="org-string">"&lt;f4&gt;"</span>) #'org-compile-files)


<span class="org-comment-delimiter">;; </span><span class="org-comment">define term in notes</span>
(<span class="org-keyword">evil-define-key</span> 'visual org-mode-map (kbd <span class="org-string">"C-d"</span>) #'org-note-create-definition)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-d"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                      (<span class="org-keyword">interactive</span>)
                                                      (org-note-create-definition nil nil)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure C-i works like TAB</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">org-c-i</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (texmathp)
      (yas-expand)
    (org-cycle)))

(define-key org-mode-map (kbd <span class="org-string">"C-i"</span>) #'org-c-i)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-i"</span>) #'org-c-i)
(<span class="org-keyword">evil-define-key</span> 'visual org-mode-map (kbd <span class="org-string">"C-i"</span>) #'org-c-i)


<span class="org-comment-delimiter">;; </span><span class="org-comment">schedule todo items</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g s"</span>) #'org-schedule)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set todo item deadlines</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g d"</span>) #'org-deadline)


<span class="org-comment-delimiter">;; </span><span class="org-comment">schedule item without being a task</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g ."</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">save-excursion</span>
        (<span class="org-keyword">if</span> (equal (line-end-position) (point-max))
            (open-line-down))
        (<span class="org-keyword">save-excursion</span>
          (org-previous-visible-heading 1)
          (goto-char (line-end-position))
          (insert (format <span class="org-string">"\n%s"</span> (<span class="org-keyword">with-temp-buffer</span>
                                   (org-time-stamp nil)))))
        (delete-region (1- (line-beginning-position)) (line-end-position)))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">set tag</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g T"</span>) #'org-set-tags-command)


<span class="org-comment-delimiter">;; </span><span class="org-comment">save and close org capture</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-capture-mode-map (kbd <span class="org-string">"g f"</span>) #'org-capture-finalize)


<span class="org-comment-delimiter">;; </span><span class="org-comment">save and close org capture</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-capture-mode-map (kbd <span class="org-string">"g q"</span>) #'org-capture-kill)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use org-specific jump back</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-o"</span>) #'org-mark-ring-goto)


<span class="org-comment-delimiter">;; </span><span class="org-comment">fix paragraph navigation</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"] ]"</span> ) #'evil-forward-section-begin)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"[ ["</span> ) #'evil-backward-section-begin)


<span class="org-comment-delimiter">;; </span><span class="org-comment">move headings</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-M-k"</span>) #'org-metaup)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-M-j"</span>) #'org-metadown)


<span class="org-comment-delimiter">;; </span><span class="org-comment">meta return in normal mode</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g o"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                      (<span class="org-keyword">interactive</span>)
                                                      (end-of-line)
                                                      (org-meta-return)
                                                      (evil-insert-state)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">create headings</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-n"</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-insert-heading-respect-content)
      (evil-insert-state)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">create new todo haeding</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-t"</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-insert-todo-heading-respect-content)
      (evil-insert-state)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">copy cell contents</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"C-c C-y"</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">when</span> (org-at-table-p)
        (kill-new
         (string-trim
          (substring-no-properties (org-table-get-field))))
        (message <span class="org-string">"Copied cell contents."</span>))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">toggle source block visibility </span>
(define-key org-mode-map (kbd <span class="org-string">"&lt;f12&gt;"</span>) #'org-toggle-blocks)


<span class="org-comment-delimiter">;; </span><span class="org-comment">create org-mode links across files</span>
(global-set-key (kbd <span class="org-string">"C-c l"</span>) #'org-store-link)
(global-set-key (kbd <span class="org-string">"C-c C-l"</span>) #'org-insert-link)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use `g j' and `g k' for navigating lists</span>
(add-hook 'org-mode-hook (<span class="org-keyword">lambda</span> ()
                           (define-key evil-normal-state-local-map (kbd <span class="org-string">"g j"</span>) #'org-shiftdown)
                           (define-key evil-normal-state-local-map (kbd <span class="org-string">"g k"</span>) #'org-shiftup)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">export English text</span>
(define-key org-mode-map (kbd <span class="org-string">"&lt;f5&gt;"</span>) #'export-colored)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use C-S-j as M-RET</span>
(define-key org-mode-map (kbd <span class="org-string">"C-M-j"</span>) 'org-meta-return)


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure `z j` and `z k` are properly bound</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"z j"</span>) #'open-line-down)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"z k"</span>) #'open-line-up)


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure that window switching works</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"M-h"</span>) #'evil-window-left)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"M-j"</span>) #'evil-window-down)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"M-k"</span>) #'evil-window-up)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"M-l"</span>) #'evil-window-right)


<span class="org-comment-delimiter">;; </span><span class="org-comment">insert today's date</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g D"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                      (<span class="org-keyword">interactive</span>)
                                                      (forward-char)
                                                      (insert (format-time-string <span class="org-string">"%d/%m/%Y --- %A"</span>))))
</pre>
</div>

<p>
Better integration with evil.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">org-evil</span>)
</pre>
</div>

<p>
Add evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">export org/latex file as HTML</span>
(evil-leader/set-key <span class="org-string">"h"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">if</span> (equal major-mode 'org-mode)
                                 (export-and-open-html)
                               (<span class="org-keyword">if</span> (equal major-mode 'latex-mode)
                                   (call-interactively 'TeX-command-run-all)
                                 (browse-url-of-file)))))


(<span class="org-keyword">defvar</span> <span class="org-variable-name">org-export-html-live-online</span> nil
  <span class="org-doc">"Whether the live Org HTML export server is on."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">org-export-html-toggle-live-server</span> ()
  <span class="org-doc">"Toggle the liver Org HTMl export server."</span>
  (<span class="org-keyword">if</span> org-export-html-live-online
      (<span class="org-keyword">progn</span>
        (kill-process <span class="org-string">"org-export-html-live-server"</span>)
        (message <span class="org-string">"Killed live export server."</span>)
        (<span class="org-keyword">setq</span> org-export-html-live-online nil))
    (<span class="org-keyword">let</span> ((html-path (format <span class="org-string">"%s.html"</span> (file-name-base (buffer-file-name)))))
      (message html-path)
      (set-process-sentinel (start-process <span class="org-string">"org-export-html-live-server"</span>
                                           <span class="org-string">"*Org Live Export*"</span>
                                           <span class="org-string">"/Users/jetblack/.npm-global/bin/reload"</span>
                                           <span class="org-string">"-b"</span>
                                           <span class="org-string">"-s"</span>
                                           html-path)
                            #'(<span class="org-keyword">lambda</span> (process event)
                                (<span class="org-keyword">when</span> (memq (process-status process) '(exit signal))
                                  (kill-buffer <span class="org-string">"*Org Live Export*"</span>)))))
    (message <span class="org-string">"Started live export server."</span>)
    (<span class="org-keyword">setq</span> org-export-html-live-online t)))


(evil-leader/set-key <span class="org-string">"H"</span> #'(<span class="org-keyword">lambda</span> (start-server)
                             (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
                             (<span class="org-keyword">if</span> start-server
                                 (org-export-html-toggle-live-server)
                               (<span class="org-keyword">when</span> (equal major-mode 'org-mode)
                                 (org-html-export-to-html)
                                 (shell-command (format <span class="org-string">"open -a Vivaldi"</span> ))))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">export org/latex file as PDF</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">org-pdf-separate-window</span> '())

(add-hook 'kill-buffer-hook #'(<span class="org-keyword">lambda</span> ()
                                (<span class="org-keyword">if</span> (member (current-buffer) org-pdf-separate-window)
                                    (<span class="org-keyword">setq</span> org-pdf-separate-window (delete (current-buffer) org-pdf-separate-window)))))

(add-hook 'after-save-hook #'(<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (equal major-mode 'org-mode)
                                        (member (current-buffer) org-pdf-separate-window))
                                   (org-export-pdf-update))))

(<span class="org-keyword">defun</span> <span class="org-function-name">org-latex-preview-pdf</span> (separate-window)
  (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
  (<span class="org-keyword">cond</span> ((equal separate-window 1)
         (<span class="org-keyword">if</span> (member (current-buffer) org-pdf-separate-window)
             (<span class="org-keyword">progn</span>
               (<span class="org-keyword">setq</span> org-pdf-separate-window (delete (current-buffer) org-pdf-separate-window))
               (message <span class="org-string">"Stopped live compilation for this buffer."</span>))
           (message <span class="org-string">"Started live compilation for this buffer."</span>)
           (<span class="org-keyword">push</span> (current-buffer) org-pdf-separate-window)))
        ((equal separate-window 2)
         (expand-org-latex-workspace))
        ((equal major-mode 'org-mode)
         (export-and-open-pdf separate-window))
        ((equal major-mode 'latex-mode)
         (call-interactively 'TeX-command-run-all))
        (t (browse-url-of-file))))

(evil-leader/set-key <span class="org-string">"P"</span> #'org-latex-preview-pdf)

<span class="org-comment-delimiter">;; </span><span class="org-comment">fill paragraph</span>
(evil-leader/set-key <span class="org-string">"p"</span> #'fill-paragraph)


<span class="org-comment-delimiter">;; </span><span class="org-comment">open links</span>
(evil-leader/set-key <span class="org-string">"o"</span> #'(<span class="org-keyword">lambda</span> ()
                             (<span class="org-keyword">interactive</span>)
                             (<span class="org-keyword">cond</span>
                              ((equal major-mode 'org-mode) (org-open-at-point))
                              ((equal major-mode 'notmuch-show-mode) (shr-browse-url)))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">convenient way to toggle latex preview in org-mode</span>
(evil-leader/set-key <span class="org-string">"l"</span> #'org-latex-preview)


<span class="org-comment-delimiter">;; </span><span class="org-comment">convenient way to execute all code blocks at once</span>
(evil-leader/set-key <span class="org-string">"\""</span> 'org-babel-execute-buffer)


<span class="org-comment-delimiter">;; </span><span class="org-comment">edit in separate buffer</span>
(evil-leader/set-key <span class="org-string">"`"</span> (<span class="org-keyword">lambda</span> ()
                           (<span class="org-keyword">interactive</span>)
                           (<span class="org-keyword">if</span> (not (equal major-mode 'org-mode))
                               (org-edit-src-exit)
                             (org-edit-special))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">org babel tangle</span>
(evil-leader/set-key <span class="org-string">"SPC"</span> 'org-babel-tangle)
</pre>
</div>
</div>
</div>

<div id="outline-container-org20f642c" class="outline-3">
<h3 id="org20f642c">Packages</h3>
<div class="outline-text-3" id="text-org20f642c">
</div>
<div id="outline-container-orgdd84206" class="outline-4">
<h4 id="orgdd84206">Org download</h4>
<div class="outline-text-4" id="text-orgdd84206">
<p>
Drag and drop images.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">org-download</span>
  <span class="org-builtin">:config</span>
  (add-hook 'dired-mode-hook 'org-download-enable))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgda2f53a" class="outline-4">
<h4 id="orgda2f53a">Helm org</h4>
<div class="outline-text-4" id="text-orgda2f53a">
<p>
Configuration for <code>helm-org</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">helm-org</span>
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">evil-define-key</span> 'normal org-mode-map <span class="org-string">"?"</span> #'helm-org-in-buffer-headings))
</pre>
</div>
</div>
</div>

<div id="outline-container-org997f52c" class="outline-4">
<h4 id="org997f52c">Org Agenda</h4>
<div class="outline-text-4" id="text-org997f52c">
<p>
Org agenda variables.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">set directory for global org files</span>
(<span class="org-keyword">setq-default</span> org-agenda-files '(<span class="org-string">"~/Documents/Education/schedule.org"</span>
                                 <span class="org-string">"~/Documents/general.org"</span>
                                 <span class="org-string">"~/Documents/calendar.org"</span>))


<span class="org-comment-delimiter">;; </span><span class="org-comment">open org-agenda in the same window</span>
(<span class="org-keyword">setq-default</span> org-agenda-window-setup 'current-window)


<span class="org-comment-delimiter">;; </span><span class="org-comment">stop showing warnings for deadlines</span>
(<span class="org-keyword">setq-default</span> org-agenda-skip-deadline-prewarning-if-scheduled t)


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure the week starts on Sunday</span>
(<span class="org-keyword">setq-default</span> org-agenda-start-on-weekday nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">hide deadlines by default</span>
(<span class="org-keyword">setq-default</span> org-agenda-include-deadlines nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">customize "now" string for agenda view; "King of the moment"</span>
(<span class="org-keyword">setq-default</span> org-agenda-current-time-string <span class="org-string">"&#9472;&#9472;&#9472;*&#9472;*&#9472;  &#9818;  &#9472;*&#9472;*&#9472;&#9472;&#9472;"</span>)
(<span class="org-keyword">setq-default</span> org-agenda-time-grid
              '((daily today require-timed)
                (800 1000 1200 1400 1600 1800 2000)
                <span class="org-string">"......"</span> <span class="org-string">"--------------------"</span>))


<span class="org-comment-delimiter">;; </span><span class="org-comment">hide tags from agenda items</span>
(<span class="org-keyword">setq-default</span> org-agenda-remove-tags t)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set org agenda item display</span>
(<span class="org-keyword">setq-default</span> org-agenda-prefix-format '((agenda . <span class="org-string">"  %-12:c%?-12t"</span>)
                                         (timeline . <span class="org-string">"  % s"</span>)
                                         (todo . <span class="org-string">" %i %-12:c"</span>)
                                         (tags . <span class="org-string">" %i %-12:c"</span>)
                                         (search . <span class="org-string">" %i %-12:c"</span>)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">add line dividers between dates</span>
(<span class="org-keyword">setq-default</span> org-agenda-format-date (<span class="org-keyword">lambda</span> (date) (concat <span class="org-string">"\n"</span>
                                                            (make-string 68 9472)
                                                            <span class="org-string">"\n"</span>
                                                            (org-agenda-format-date-aligned date))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">set heading</span>
(<span class="org-keyword">setq-default</span> org-agenda-overriding-header <span class="org-string">""</span>)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set tag alignment column</span>
(<span class="org-keyword">setq-default</span> org-tags-column 60)
(<span class="org-keyword">setq-default</span> org-agenda-tags-column 60)
</pre>
</div>

<p>
Org agenda faces.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'org-agenda-date nil
                    <span class="org-builtin">:foreground</span> color-medium-subdued
                    <span class="org-builtin">:weight</span> 'normal)


(set-face-attribute 'org-agenda-date-today nil
                    <span class="org-builtin">:foreground</span> color-foreground
                    <span class="org-builtin">:weight</span> 'normal)


(set-face-attribute 'org-agenda-date-weekend nil
                    <span class="org-builtin">:foreground</span> color-darkish-subdued
                    <span class="org-builtin">:weight</span> 'normal)


(set-face-attribute 'org-scheduled nil
                    <span class="org-builtin">:foreground</span> color-medium-subdued)


(set-face-attribute 'org-scheduled-today nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#fdf4c1"</span>)


(set-face-attribute 'org-scheduled-previously nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#fdf4c1"</span>
                    <span class="org-builtin">:weight</span> 'normal)


(set-face-attribute 'org-agenda-structure nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#bdb491"</span>
                    <span class="org-builtin">:weight</span> 'ultra-bold)


(<span class="org-keyword">setq-default</span> org-priority-faces `((?A . (<span class="org-builtin">:foreground</span> ,color-red <span class="org-builtin">:weight</span> bold))
                                   (?B . (<span class="org-builtin">:foreground</span> ,color-light-orange <span class="org-builtin">:weight</span> medium))
                                   (?C . (<span class="org-builtin">:foreground</span> ,color-light-green <span class="org-builtin">:weight</span> normal))))
</pre>
</div>

<p>
Show notifications.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">appt</span>)

(<span class="org-keyword">setq-default</span> appt-time-msg-list nil)
(<span class="org-keyword">setq-default</span> appt-display-interval '5)
(<span class="org-keyword">setq-default</span> appt-message-warning-time '15)
(<span class="org-keyword">setq-default</span> appt-display-mode-line nil)
(<span class="org-keyword">setq-default</span> appt-display-format 'window)

(<span class="org-keyword">setq-default</span> appt-disp-window-function (<span class="org-keyword">function</span> appt-display-notification))

(appt-activate 1)


(<span class="org-keyword">defun</span> <span class="org-function-name">appt-display-notification</span> (min-to-app new-time msg)
  (shell-command-to-string
   (format
    <span class="org-string">"terminal-notifier -title \"Appointment in %s\" -message \"%s\" -sender org.gnu.Emacs"</span>
    min-to-app
    msg))
  (<span class="org-keyword">let</span> ((org-agenda-category-filter-preset '(<span class="org-string">"-Calendar"</span>)))
    (org-agenda-list)))


(org-agenda-to-appt)
(run-at-time <span class="org-string">"24:01"</span> 3600 'org-agenda-to-appt)
(add-hook 'org-agenda-finalize-hook #'org-agenda-to-appt)
</pre>
</div>

<p>
Use Olivetti mode in agenda.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-agenda-mode-hook #'(<span class="org-keyword">lambda</span> ()
                                    (olivetti-set-width 70)
                                    (olivetti-mode 1)
                                    (<span class="org-keyword">setq</span> default-mode-line-format mode-line-format)
                                    (<span class="org-keyword">setq</span> mode-line-format nil)))
</pre>
</div>

<p>
Make it easier to use agenda on its dedicated laptop screen.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dedicate-monitor-to-org-agenda</span> ()
  (<span class="org-keyword">interactive</span>)
  (modify-frame-parameters nil '((fullscreen . fullboth)))
  (<span class="org-keyword">let</span> ((org-agenda-category-filter-preset '(<span class="org-string">"-Calendar"</span>)))
    (org-agenda-list))
  (olivetti-set-width 72)
  (text-scale-set 1.5))
</pre>
</div>

<p>
Publish agenda.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">progenda-schedule-path</span> <span class="org-string">"/Users/jetblack/Documents/Education/schedule.org"</span>)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">progenda-publish-path</span> <span class="org-string">"/Users/jetblack/Documents/Education/Progenda/"</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">progenda-publish-schedule</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">save-window-excursion</span>
    (<span class="org-keyword">let*</span> ((json-data (<span class="org-keyword">with-current-buffer</span> (find-file-noselect progenda-schedule-path)
                        (ox-json-export-to-buffer)
                        (<span class="org-keyword">let</span> ((contents (buffer-string)))
                          (kill-buffer)
                          contents)))
           (js-data (concat <span class="org-string">"const data = "</span> json-data)))
      (write-region js-data nil (concat progenda-publish-path <span class="org-string">"data.js"</span>))))
  (shell-command-to-string (format <span class="org-string">"cd %s &amp;&amp; git add . &amp;&amp; git commit -m '</span><span class="org-string"><span class="org-constant">Updated.</span></span><span class="org-string">' &amp;&amp; git push"</span> progenda-publish-path))
  (message <span class="org-string">"Published schedule."</span>))
</pre>
</div>

<p>
Org agenda hooks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'org-agenda-mode-hook
          #'(<span class="org-keyword">lambda</span> ()
              (hl-line-mode 1)
              (<span class="org-keyword">setq-local</span> evil-normal-state-cursor '(<span class="org-string">"#151719"</span> bar))))


(advice-add #'org-agenda-redo <span class="org-builtin">:after</span> #'(<span class="org-keyword">lambda</span> (<span class="org-type">&amp;rest</span> args)
                                         (evil-refresh-cursor)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">move cursor to first item</span>
(advice-add 'org-agenda-list <span class="org-builtin">:after</span> #'(<span class="org-keyword">lambda</span> (<span class="org-type">&amp;rest</span> args)
                                        (org-agenda-next-item 1)))


(add-hook 'org-agenda-finalize-hook #'(<span class="org-keyword">lambda</span> ()
                                        (<span class="org-keyword">interactive</span>)
                                        (<span class="org-keyword">if</span> (&gt; text-scale-mode-amount 0)
                                            (olivetti-set-width 72))))
</pre>
</div>

<p>
Org agenda key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">make sure normal state is enabled by default in org agenda</span>
(evil-set-initial-state 'org-agenda-mode 'normal)


<span class="org-comment-delimiter">;; </span><span class="org-comment">open agenda from calendar</span>
(<span class="org-keyword">evil-define-key</span> 'normal calendar-mode-map (kbd <span class="org-string">"g l"</span>) #'org-calendar-goto-agenda)


<span class="org-comment-delimiter">;; </span><span class="org-comment">use j k to navigate items</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"j"</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-agenda-next-item 1)
      (beginning-of-line)))
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"k"</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-agenda-previous-item 1)
      (beginning-of-line)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">save all org buffers from agenda</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"g s"</span>) #'org-save-all-org-buffers)


<span class="org-comment-delimiter">;; </span><span class="org-comment">open agenda item with return in normal state</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"C-j"</span>) #'org-agenda-switch-to)
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"RET"</span>) #'org-agenda-switch-to)


<span class="org-comment-delimiter">;; </span><span class="org-comment">toggle todo</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"t"</span>) #'org-agenda-todo)


<span class="org-comment-delimiter">;; </span><span class="org-comment">reschedule task</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"s"</span>) #'org-agenda-schedule)


<span class="org-comment-delimiter">;; </span><span class="org-comment">refile task</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"R"</span>) #'org-agenda-refile)


<span class="org-comment-delimiter">;; </span><span class="org-comment">search for task</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"S"</span>) #'org-search-view)


<span class="org-comment-delimiter">;; </span><span class="org-comment">reload</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"r"</span>) #'org-agenda-redo)


<span class="org-comment-delimiter">;; </span><span class="org-comment">filter by current category</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"c"</span>) #'org-agenda-filter-by-category)


<span class="org-comment-delimiter">;; </span><span class="org-comment">inverse filter by current category</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"-"</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-agenda-filter-by-category t)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">set priority</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">","</span>) #'org-agenda-priority)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set day view</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"."</span>) #'org-agenda-day-view)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set week view</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"w"</span>) #'org-agenda-week-view)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set fortnight view</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"F"</span>) #'org-agenda-fortnight-view)


<span class="org-comment-delimiter">;; </span><span class="org-comment">goto date</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"f"</span>) #'org-agenda-goto-date)


<span class="org-comment-delimiter">;; </span><span class="org-comment">delete item</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"D"</span>) #'org-agenda-kill)


<span class="org-comment-delimiter">;; </span><span class="org-comment">set deadline</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"d"</span>) #'org-agenda-deadline)


<span class="org-comment-delimiter">;; </span><span class="org-comment">toggle deadlines</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"g d"</span>) #'org-agenda-toggle-deadlines)


<span class="org-comment-delimiter">;; </span><span class="org-comment">filter</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"/"</span>) #'org-agenda-filter)


<span class="org-comment-delimiter">;; </span><span class="org-comment">add tag</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"'"</span>) #'org-agenda-set-tags)


<span class="org-comment-delimiter">;; </span><span class="org-comment">add and display text related to item</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"E"</span>) #'org-agenda-add-note)
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"e"</span>) #'org-agenda-entry-text-mode)


<span class="org-comment-delimiter">;; </span><span class="org-comment">exit agenda</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-agenda-mode-map (kbd <span class="org-string">"x"</span>) #'org-agenda-exit)
</pre>
</div>

<p>
Org agenda evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">open agenda without calendar; the proper way to do this is with a custom view</span>
(evil-leader/set-key <span class="org-string">"a"</span> #'(<span class="org-keyword">lambda</span> (dedicate-monitor)
                             (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
                             (<span class="org-keyword">if</span> dedicate-monitor
                                 (dedicate-monitor-to-org-agenda)
                               (<span class="org-keyword">let</span> ((org-agenda-category-filter-preset '(<span class="org-string">"-Calendar"</span>)))
                                 (org-agenda-list)))))


(evil-leader/set-key <span class="org-string">"A"</span> #'(<span class="org-keyword">lambda</span> (sync)
                             (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
                             (<span class="org-keyword">if</span> sync
                                 (shell-command-to-string <span class="org-string">"/Users/jetblack/cbin/sync-calendar"</span>))
                             (org-agenda-list)))


(evil-leader/set-key <span class="org-string">"G"</span> #'progenda-publish-schedule)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">with-eval-after-load</span> 'org-agenda
  &lt;&lt;org-agenda-variables&gt;&gt;
  &lt;&lt;org-agenda-faces&gt;&gt;
  &lt;&lt;org-agenda-hooks&gt;&gt;
  &lt;&lt;org-agenda-keybindings&gt;&gt;)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf459a75" class="outline-4">
<h4 id="orgf459a75">Olivetti</h4>
<div class="outline-text-4" id="text-orgf459a75">
<p>
Use Olivetti.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">olivetti</span>)
</pre>
</div>

<p>
Distraction-free environment.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">message-filter-center</span> (args)
  <span class="org-doc">"Center message string.</span>
<span class="org-doc">This is a :filter-args advice for `message`."</span>
  (<span class="org-keyword">if</span> (car args)
      (<span class="org-keyword">with-current-buffer</span> (window-buffer (minibuffer-window))
        (<span class="org-keyword">let*</span> ((str (apply #'format-message args))
               (filler (make-string (max 0 (/ (- (window-width (minibuffer-window)) (string-width str)) 2)) ? )))
          (list <span class="org-string">"%s%s"</span> filler str)))
    args))


(<span class="org-keyword">defun</span> <span class="org-function-name">org-detect-distraction-free-keyword</span> ()
  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (org-keyword-activep <span class="org-string">"DFREE"</span> t) (not (string-prefix-p <span class="org-string">"*scratch"</span> (buffer-name))))
      (distraction-free (org-keyword-activep <span class="org-string">"LITERARY"</span>))))


(add-hook 'org-mode-hook #'org-detect-distraction-free-keyword)


(<span class="org-keyword">defvar</span> <span class="org-variable-name">distraction-free-background-set</span> nil)


(<span class="org-keyword">defvar</span> <span class="org-variable-name">stored-face-attributes</span> nil)


(<span class="org-keyword">defun</span> <span class="org-function-name">set-temporary-face-attributes</span> (attribute value faces)
  (<span class="org-keyword">dolist</span> (face faces)
    (add-to-list 'stored-face-attributes
                 (list face attribute (face-attribute face attribute)))
    (set-face-attribute face nil attribute value)))


(<span class="org-keyword">defun</span> <span class="org-function-name">reset-temporary-face-attributes</span> ()
  (<span class="org-keyword">dolist</span> (item stored-face-attributes)
    (set-face-attribute (car item) nil (nth 1 item) (nth 2 item)))
  (<span class="org-keyword">setq</span> stored-face-attributes nil))


(<span class="org-keyword">defun</span> <span class="org-function-name">set-distraction-free-background</span> ()
  (<span class="org-keyword">if</span> (org-keyword-activep <span class="org-string">"LITERARY"</span>)
      (<span class="org-keyword">progn</span>
        (<span class="org-keyword">when</span> (not distraction-free-background-set)
          (<span class="org-keyword">setq</span> evil-emacs-state-cursor `(,color-background box))
          (<span class="org-keyword">setq</span> evil-normal-state-cursor `(,color-background box))
          (<span class="org-keyword">setq</span> evil-insert-state-cursor `(,color-background bar))

          (set-temporary-face-attributes
           <span class="org-builtin">:foreground</span> color-background
           '(org-document-title
             header-line
             outline-1
             outline-2
             outline-3
             outline-4
             outline-5
             outline-6
             outline-7
             outline-8))

          (set-temporary-face-attributes
           <span class="org-builtin">:background</span> <span class="org-string">"#FFF"</span>
           '(org-block-begin-line
             org-block-end-line
             sp-pair-overlay-face
             header-line
             yas-field-highlight-face))

          (set-temporary-face-attributes
           <span class="org-builtin">:foreground</span> color-green
           '(yas-field-highlight-face))

          (set-background-color <span class="org-string">"#FFF"</span>)
          (set-foreground-color color-background))
        (<span class="org-keyword">setq</span> distraction-free-background-set t))
    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> distraction-free-background-set
               (not pdf-has-set-light-mode)
               (<span class="org-keyword">or</span> helm-alive-p
                   (not (equal major-mode 'minibuffer-mode))))
      (<span class="org-keyword">setq</span> evil-emacs-state-cursor `(<span class="org-string">"white"</span> box))
      (<span class="org-keyword">setq</span> evil-normal-state-cursor `(<span class="org-string">"#fdf4c1"</span> box))
      (<span class="org-keyword">setq</span> evil-insert-state-cursor `(<span class="org-string">"#fdf4c1"</span> bar))
      (reset-temporary-face-attributes)
      (set-background-color color-background)
      (set-foreground-color color-foreground))
    (<span class="org-keyword">setq</span> distraction-free-background-set nil)))


(add-hook 'post-command-hook #'set-distraction-free-background)


(<span class="org-keyword">defun</span> <span class="org-function-name">distraction-free</span> (use-mixed-pitch <span class="org-type">&amp;optional</span> no-spell)
  (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
  (<span class="org-keyword">if</span> (equal olivetti-mode nil)
      (<span class="org-keyword">progn</span>
        (<span class="org-keyword">when</span> use-mixed-pitch
          (olivetti-set-width 75)
          (mixed-pitch-mode 1)
          (<span class="org-keyword">setq-local</span> line-spacing 4))
        (<span class="org-keyword">setq-local</span> default-mode-line-format mode-line-format)
        (<span class="org-keyword">setq-local</span> mode-line-format nil)
        (olivetti-mode 1)
        (<span class="org-keyword">if</span> (not no-spell)
            (flyspell-mode)))
    (mixed-pitch-mode 0)
    (olivetti-mode 0)
    (set-window-margins (get-buffer-window) 2)
    (<span class="org-keyword">setq-local</span> mode-line-format default-mode-line-format)
    (<span class="org-keyword">setq-local</span> line-spacing nil)))


(add-hook 'evil-insert-state-entry-hook
          #'(<span class="org-keyword">lambda</span> ()
              (<span class="org-keyword">when</span> line-spacing
                (<span class="org-keyword">save-excursion</span>
                  (end-of-line)
                  (insert ? )))))


(add-hook 'evil-insert-state-exit-hook
          #'(<span class="org-keyword">lambda</span> ()
              (<span class="org-keyword">when</span> line-spacing
                (<span class="org-keyword">save-excursion</span>
                  (end-of-line)
                  (<span class="org-keyword">when</span> (equal (char-before) ? )
                    (delete-backward-char 1))))))
</pre>
</div>

<p>
Evil leader bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span class="org-string">"u"</span> #'distraction-free)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdbf011b" class="outline-4">
<h4 id="orgdbf011b">Dictionary</h4>
<div class="outline-text-4" id="text-orgdbf011b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">osx-dictionary</span>
  <span class="org-builtin">:config</span>
  &lt;&lt;dictionary-goto-function&gt;&gt;
  &lt;&lt;dictionary-display-functions&gt;&gt;
  &lt;&lt;dictionary-search-function&gt;&gt;)
</pre>
</div>

<p>
Redefine function to open dictionary in the same window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">osx-dictionary--goto-dictionary</span> (word)
  <span class="org-doc">"Switch to osx-dictionary buffer in other window."</span>
  (<span class="org-keyword">setq</span> osx-dictionary-previous-window-configuration
        (current-window-configuration))
  (<span class="org-keyword">let*</span> ((buffer (osx-dictionary--get-buffer word))
         (window (get-buffer-window buffer)))
    (<span class="org-keyword">if</span> (null window)
        (switch-to-buffer buffer)
      (select-window window))))
</pre>
</div>

<p>
Use Olivetti in buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">osx-dictionary--view-result</span> (word)
  <span class="org-doc">"Make buffer for the searching result of WORD."</span>
  (<span class="org-keyword">if</span> word
      (<span class="org-keyword">with-current-buffer</span> (get-buffer-create
                            (funcall osx-dictionary-generate-buffer-name-function word))
        (<span class="org-keyword">let</span> ((inhibit-read-only t))
          (erase-buffer)
          (<span class="org-keyword">let</span> ((progress-reporter
                 (make-progress-reporter (format <span class="org-string">"Searching (%s)..."</span> word)
                                         nil nil)))
            (insert (osx-dictionary--search word))
            (progress-reporter-done progress-reporter))
          (osx-dictionary--goto-dictionary word)
          (goto-char (point-min))

          (olivetti-set-width 70)
          (olivetti-mode 1)
          (mixed-pitch-mode 1)
          (<span class="org-keyword">setq</span> default-mode-line-format mode-line-format)
          (<span class="org-keyword">setq</span> mode-line-format nil)
          (<span class="org-keyword">setq</span> line-spacing 4)

          (<span class="org-keyword">let</span> ((buffer-read-only nil))
            (whitespace-cleanup))))
    (message <span class="org-string">"Nothing to look up"</span>)))


(<span class="org-keyword">defun</span> <span class="org-function-name">osx-dictionary-quit</span> ()
  <span class="org-doc">"Quit osx-dictionary: reselect previously selected buffer."</span>
  (<span class="org-keyword">interactive</span>)
  (mixed-pitch-mode 0)
  (olivetti-mode 0)
  (<span class="org-keyword">setq</span> mode-line-format default-mode-line-format)
  (set-window-margins (get-buffer-window) 2)
  (<span class="org-keyword">setq</span> line-spacing nil)
  (<span class="org-keyword">if</span> (window-configuration-p osx-dictionary-previous-window-configuration)
      (<span class="org-keyword">progn</span>
        (set-window-configuration osx-dictionary-previous-window-configuration)
        (<span class="org-keyword">setq</span> osx-dictionary-previous-window-configuration nil)
        (kill-buffer))
    (kill-buffer)))
</pre>
</div>

<p>
Customize appearance.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defface</span> <span class="org-variable-name">phonetics-lock</span>
  '((t <span class="org-builtin">:family</span> <span class="org-string">"Gentium Plus"</span>))
  <span class="org-doc">"Face for dictionary phonetics."</span>
  <span class="org-builtin">:group</span> 'osx-dictionary-mode)


(<span class="org-keyword">defvar</span> <span class="org-variable-name">phonetics-lock</span> 'phonetics-lock
  <span class="org-doc">"Face for dictionary phonetics."</span>)


(<span class="org-keyword">setq-default</span> osx-dictionary-mode-font-lock-keywords
              '(
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Word class</span>
                (<span class="org-string">"\\b</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">noun</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">adjective</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">det</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">verb</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">adverb</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">abbreviation</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">preposition</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">suffix</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">prefix</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">conjunction</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">symb</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">\\b"</span> . font-lock-type-face)
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Serial number</span>
                (<span class="org-string">"^[0-9]+"</span> . font-lock-builtin-face)
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Phonetics</span>
                (<span class="org-string">"|</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">|"</span> . phonetics-lock)
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Dictionary comment</span>
                (<span class="org-string">"^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">DERIVATIVES</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">ORIGIN</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">PHRASES</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> . font-lock-comment-face)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">center header</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">center-header</span> (header)
  <span class="org-doc">"Center HEADER string."</span>
  (<span class="org-keyword">let</span> ((header-length 70))
    (append
     `(,(make-string (- (/ (window-total-width) 2)
                        (/ header-length 2))
                     (string-to-char <span class="org-string">" "</span>)))
     header)))


(<span class="org-keyword">define-derived-mode</span> <span class="org-function-name">osx-dictionary-mode</span> fundamental-mode <span class="org-string">"osx-dictionary"</span>
  <span class="org-doc">"Major mode to look up word through dictionary.</span>
<span class="org-doc">\\{osx-dictionary-mode-map}.</span>
<span class="org-doc">Turning on Text mode runs the normal hook `</span><span class="org-doc"><span class="org-constant">osx-dictionary-mode-hook</span></span><span class="org-doc">'."</span>

  (<span class="org-keyword">setq</span> header-line-format (center-header osx-dictionary-mode-header-line))
  (<span class="org-keyword">setq</span> font-lock-defaults '(osx-dictionary-mode-font-lock-keywords)))
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'osx-dictionary-mode-hook
          #'(<span class="org-keyword">lambda</span> ()
              (evil-local-set-key 'normal (kbd <span class="org-string">"q"</span>) #'osx-dictionary-quit)))
</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span class="org-string">"d"</span> #'osx-dictionary-search-input)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1d18f9a" class="outline-4">
<h4 id="org1d18f9a">Calc</h4>
<div class="outline-text-4" id="text-org1d18f9a">
<p>
Convenient way to use quick-calc.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">clean-quick-calc</span> (start end)
  (<span class="org-keyword">interactive</span>
   (<span class="org-keyword">if</span> (region-active-p)
       (list (region-beginning) (region-end))
     '(nil nil)))

  (<span class="org-keyword">if</span> (null start)
      (<span class="org-keyword">with-temp-buffer</span>
        (<span class="org-keyword">let</span> ((calc-language 'latex))
          (quick-calc t))
        (kill-ring-save (point-min) (point-max)))
    (<span class="org-keyword">progn</span>
      (<span class="org-keyword">let*</span> ((expression-start start)
             (prefix (<span class="org-keyword">save-excursion</span>
                       (goto-char start)
                       (<span class="org-keyword">condition-case</span> nil
                           (<span class="org-keyword">progn</span>
                             (re-search-forward <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[[:space:]]*&amp;= </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[[:space:]]*= </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> end)
                             (<span class="org-keyword">setq</span> expression-start (match-end 0))
                             (match-string 0))
                         (<span class="org-warning">error</span> <span class="org-string">""</span>))))
             (expression (replace-regexp-in-string
                          <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[abcxyz]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">_[[:digit:]]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[[:space:]]*("</span>
                          <span class="org-string">"\\1*("</span>
                          (replace-regexp-in-string
                           <span class="org-string">"\\\\left</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\\\right"</span>
                           <span class="org-string">""</span>
                           (buffer-substring expression-start end)))))
        (delete-region start (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (equal (evil-visual-type) 'line)
                                      (not (equal end (point-max))))
                                 (- end 1) end))
        (<span class="org-keyword">save-excursion</span>
          (goto-char start)
          (insert prefix)
          (<span class="org-keyword">let</span> ((calc-language 'latex))
            (insert (calc-eval expression))))))))
</pre>
</div>

<p>
Add special constants to &ldquo;s k&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">calc-special-constants</span> '((<span class="org-string">""</span>)
                                 (<span class="org-string">"e"</span> . (special-const (math-e)))
                                 (<span class="org-string">"pi"</span> . (special-const (math-pi)))
                                 (<span class="org-string">"i"</span> . (special-const (math-imaginary 1)))
                                 (<span class="org-string">"phi"</span> . (special-const (math-phi)))
                                 (<span class="org-string">"gamma"</span> . (special-const (math-gamma-const)))))


(<span class="org-keyword">defun</span> <span class="org-function-name">calc-copy-special-constant</span> (<span class="org-type">&amp;optional</span> sconst var)
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((sc calc-special-constants))
    (<span class="org-keyword">calc-wrapper</span>
     (<span class="org-keyword">or</span> sconst (<span class="org-keyword">setq</span> sconst (completing-read <span class="org-string">"Special constant: "</span> sc nil t)))
     (<span class="org-keyword">unless</span> (string= sconst <span class="org-string">""</span>)
       (<span class="org-keyword">let</span> ((value (cdr (assoc sconst sc))))
         (<span class="org-keyword">or</span> var (<span class="org-keyword">setq</span> var (calc-read-var-name
                            (format <span class="org-string">"Copy special constant %s, to: "</span>
                                    sconst))))
         (<span class="org-keyword">if</span> var
             (<span class="org-keyword">let</span> ((msg (calc-store-value var value <span class="org-string">""</span>)))
               (message <span class="org-string">"Special constant \"%s\" copied to \"%s\"%s"</span>
                        sconst (calc-var-name var) msg))))))))
</pre>
</div>

<p>
Convenient way to define new constants.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">calc-define-constant</span> (name variable key)
  <span class="org-doc">"Define a constant for Calc from a predefined variable."</span>
  (add-to-list 'calc-special-constants `(,name . (special-const ,variable)))

  (<span class="org-keyword">let</span> ((name name)
        (variable variable))
    (<span class="org-keyword">evil-define-key</span> 'normal calc-mode-map (kbd key)
      `(<span class="org-keyword">lambda</span> ()
          (<span class="org-keyword">interactive</span>)
          (<span class="org-keyword">calc-slow-wrapper</span>
           (<span class="org-keyword">if</span> calc-symbolic-mode
               (calc-pop-push-record 0 ,name '(var ,(intern name) ,variable))
             (calc-pop-push-record 0 ,name (symbol-value ,variable))))))))
</pre>
</div>

<p>
Add constants.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">var-G</span> `(special-const (math-read-expr <span class="org-string">"6.6743e-11 m^3/kg/s^2"</span>))
  <span class="org-doc">"The gravitational constant."</span>)
(calc-define-constant <span class="org-string">"G"</span> 'var-G <span class="org-string">"c k G"</span>)


(<span class="org-keyword">defvar</span> <span class="org-variable-name">var-C</span> `(special-const (math-read-expr <span class="org-string">"299792458 m/s"</span>))
  <span class="org-doc">"The speed of light in a vacuum."</span>)
(calc-define-constant <span class="org-string">"C"</span> 'var-C <span class="org-string">"c k C"</span>)
</pre>
</div>

<p>
Calc styling.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> calc-highlight-selections-with-faces t)
</pre>
</div>

<p>
Evaluate expression at limits.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">evaluate-math-expression-at-point</span> (substition start end)
  (<span class="org-keyword">interactive</span>
   (append (list (read-string <span class="org-string">"Evaluate at (e.g., \"x=1,y=2\"): "</span>))
           (<span class="org-keyword">if</span> (use-region-p)
               (list (region-beginning) (region-end))
             (list (line-beginning-position) (line-end-position)))))

  (<span class="org-keyword">save-excursion</span>
    (goto-char end)
    (insert (<span class="org-keyword">let</span> ((contents (buffer-substring start end)))
              (<span class="org-keyword">with-temp-buffer</span>
                (insert (string-substitute-math-variables contents substition))
                (clean-quick-calc (point-min) (point-max))
                (buffer-string))))
    (delete-region start end)))

(<span class="org-keyword">defun</span> <span class="org-function-name">evaluate-math-expression-at-limits</span> (var a b start end)
  (<span class="org-keyword">interactive</span>
   (append (split-string (read-string <span class="org-string">"Evaluate at (e.g., \"x,1,2\"): "</span>) <span class="org-string">","</span>)
           (<span class="org-keyword">if</span> (use-region-p)
               (list (region-beginning) (region-end))
             (list (line-beginning-position) (line-end-position)))))

  (<span class="org-keyword">save-excursion</span>
    (goto-char end)
    (insert (<span class="org-keyword">let</span> ((contents (buffer-substring start end)))
              (<span class="org-keyword">with-temp-buffer</span>
                (insert (format <span class="org-string">"(%s) - (%s)"</span>
                                (string-substitute-math-variables contents (format <span class="org-string">"%s=%s"</span> var b))
                                (string-substitute-math-variables contents (format <span class="org-string">"%s=%s"</span> var a))))
                (clean-quick-calc (point-min) (point-max))
                (buffer-string))))
    (delete-region start end)))


(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"g r l"</span>) #'evaluate-math-expression-at-limits)
(<span class="org-keyword">evil-define-key</span> 'normal global-map (kbd <span class="org-string">"g r p"</span>) #'evaluate-math-expression-at-point)
</pre>
</div>

<p>
Use square brackets for matrices.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(put 'latex 'math-matrix-formatter
     (<span class="org-keyword">lambda</span> (a)
       (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (integerp calc-language-option)
                (<span class="org-keyword">or</span> (= calc-language-option 0)
                    (&gt; calc-language-option 1)
                    (&lt; calc-language-option -1)))
           (append '(vleft 0 <span class="org-string">"\\begin{bmatrix}"</span>)
                   (math-compose-tex-matrix (cdr a) t)
                   '(<span class="org-string">"\\end{bmatrix}"</span>))
         (append '(horiz <span class="org-string">"\\begin{bmatrix} "</span>)
                 (math-compose-tex-matrix (cdr a) t)
                 '(<span class="org-string">" \\end{bmatrix}"</span>)))))
</pre>
</div>

<p>
Copy calc results as kill. <a href="https://emacs.stackexchange.com/a/48362">Thanks, Akinori!</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">calc-copy-as-kill-clean</span> ()
    <span class="org-doc">"Copy the top of stack as kill."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((buffer (generate-new-buffer <span class="org-string">"*copy-here*"</span>)))
      (<span class="org-keyword">unwind-protect</span>
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">cl-letf</span>
                (((symbol-function 'calc-find-writable-buffer)
                  (<span class="org-keyword">lambda</span> (buf mode) buffer)))
              (call-interactively 'calc-copy-to-buffer))
            (<span class="org-keyword">with-current-buffer</span> buffer
              (kill-new (buffer-substring-no-properties (point-min) (point-max))))
            (message <span class="org-string">"Copied the result: %s"</span> (car kill-ring)))
        (<span class="org-keyword">and</span> (buffer-name buffer)
             (kill-buffer buffer)))))
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key global-map (kbd <span class="org-string">"C-'"</span>) #'clean-quick-calc)
(define-key org-mode-map (kbd <span class="org-string">"C-'"</span>) #'clean-quick-calc)

(define-key global-map (kbd <span class="org-string">"C-M-'"</span>) #'calc)
(define-key org-mode-map (kbd <span class="org-string">"C-M-'"</span>) #'calc)

(define-key global-map (kbd <span class="org-string">"C-M-;"</span>) #'calc-embedded)
(define-key org-mode-map (kbd <span class="org-string">"C-M-;"</span>) #'calc-embedded)

(add-hook 'calc-mode-hook
          #'(<span class="org-keyword">lambda</span> ()
              (evil-local-set-key 'normal (kbd <span class="org-string">"q"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                        (<span class="org-keyword">interactive</span>)
                                                        (calc-quit)))))
(<span class="org-keyword">evil-define-key</span> 'normal calc-mode-map (kbd <span class="org-string">"q"</span>) #'calc-quit)

(<span class="org-keyword">evil-define-key</span> 'normal calc-mode-map (kbd <span class="org-string">"r r"</span>) #'calc-reset)

(define-key calc-mode-map (kbd <span class="org-string">"C-c C-y"</span>) #'calc-copy-as-kill-clean)
</pre>
</div>

<p>
Hooks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'calc-mode-hook #'(<span class="org-keyword">lambda</span> ()
                              (calc-symbolic-mode 1)
                              (calc-frac-mode 1)
                              (calc-radians-mode)

                              (<span class="org-keyword">setq-default</span> calc-show-banner nil)
                              (<span class="org-keyword">setq-default</span> calc-gnuplot-default-device <span class="org-string">"qt"</span>)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org28e05f1" class="outline-3">
<h3 id="org28e05f1">External applications</h3>
<div class="outline-text-3" id="text-org28e05f1">
</div>
<div id="outline-container-org4eea079" class="outline-4">
<h4 id="org4eea079">Zoom</h4>
<div class="outline-text-4" id="text-org4eea079">
<p>
Open Zoom links directly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">follow-zoom-link</span> (link-url)
  <span class="org-doc">"Open zoommtg:// links."</span>
  (shell-command (format <span class="org-string">"open '</span><span class="org-string"><span class="org-constant">zoommtg:%s</span></span><span class="org-string">'"</span> link-url)))


(org-link-set-parameters <span class="org-string">"zoommtg"</span> <span class="org-builtin">:follow</span> #'follow-zoom-link)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8897958" class="outline-4">
<h4 id="org8897958">Maxwell</h4>
<div class="outline-text-4" id="text-org8897958">
<p>
For capturing drawings and diagrams:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">maxwell-create-link</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (not (file-exists-p <span class="org-string">"mxl"</span>))
      (make-directory <span class="org-string">"mxl"</span>))
  (<span class="org-keyword">let*</span> ((cwd (file-name-directory buffer-file-name))
         (name (make-temp-name <span class="org-string">"diagram_"</span>))
         (image-path (concat cwd (file-name-as-directory <span class="org-string">"mxl"</span>) name <span class="org-string">".png"</span>)))
    (shell-command
     (format
      <span class="org-string">"python -c 'from maxwell import capture_area; capture_area(\"%s\")'"</span>
      image-path))
    (select-frame-set-input-focus (selected-frame))
    (insert (format <span class="org-string">"#+attr_latex: :placement [H] :scale .4\n[[%s]]\n\n"</span> image-path))
    (org-remove-inline-images)))


(define-key org-mode-map (kbd <span class="org-string">"&lt;f7&gt;"</span>) #'maxwell-create-link)
</pre>
</div>

<p>
Prompt for writing Latex.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">define-minor-mode</span> <span class="org-function-name">maxwell-get-latex-prompt-mode</span>
  <span class="org-doc">"Minor mode to simulate buffer local keybindings."</span>
  <span class="org-builtin">:init-value</span> nil
  <span class="org-builtin">:keymap</span> (make-keymap))


(define-key maxwell-get-latex-prompt-mode-map (kbd <span class="org-string">"C-j"</span>)
            #'(<span class="org-keyword">lambda</span> ()
                (<span class="org-keyword">interactive</span>)
                (write-file (expand-file-name <span class="org-string">"~/temp.org"</span>))
                (kill-buffer)
                (delete-frame)
                (shell-command-to-string <span class="org-string">"osascript -e 'activate application \"Electron\"'"</span>)))


(<span class="org-keyword">defun</span> <span class="org-function-name">maxwell-get-latex-prompt</span> ()
  (<span class="org-keyword">let</span> ((should-center-frame nil))
    (make-frame `((width . 50)
                  (height . 13)
                  (left . ,(- (round (/ (display-pixel-width) 2)) 202))
                  (top . -200)))
    (set-frame-parameter nil 'height 5)
    (set-frame-parameter nil 'top -100))
  (select-frame-set-input-focus (selected-frame))
  (switch-to-buffer <span class="org-string">"*Prompt*"</span>)
  (erase-buffer)
  (org-mode)
  (<span class="org-keyword">setq-local</span> olivetti-body-width 40)
  (maxwell-get-latex-prompt-mode)
  (yas-expand-snippet <span class="org-string">"\\\\( $0 \\\\)"</span>)
  (evil-insert-state))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2f3c720" class="outline-3">
<h3 id="org2f3c720">References</h3>
<div class="outline-text-3" id="text-org2f3c720">
<p>
Use org-ref for references management.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">org-ref</span>
  <span class="org-builtin">:config</span>

  (<span class="org-keyword">require</span> '<span class="org-constant">bibtex</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">doi-utils</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">org-ref-pdf</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">org-ref-url-utils</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">org-ref-arxiv</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">org-ref-bibtex</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">org-ref-isbn</span>)

  (<span class="org-keyword">setq-default</span> bibtex-autokey-year-length 4
                bibtex-autokey-name-year-separator <span class="org-string">"-"</span>
                bibtex-autokey-year-title-separator <span class="org-string">"-"</span>
                bibtex-autokey-titleword-separator <span class="org-string">"-"</span>
                bibtex-autokey-titlewords 2
                bibtex-autokey-titlewords-stretch 1
                bibtex-autokey-titleword-length 5)

  (<span class="org-keyword">defun</span> <span class="org-function-name">bibtex-generate-autokey</span> ()
    (<span class="org-keyword">let*</span> ((names (bibtex-autokey-get-names))
           (year (bibtex-autokey-get-year))
           (title (bibtex-autokey-get-title))
           (autokey (concat bibtex-autokey-prefix-string
                            title
                            (<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> (equal names <span class="org-string">""</span>)
                                        (equal year <span class="org-string">""</span>))
                              bibtex-autokey-name-year-separator)
                            names
                            (<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> (<span class="org-keyword">and</span> (equal names <span class="org-string">""</span>)
                                             (equal year <span class="org-string">""</span>))
                                        (equal title <span class="org-string">""</span>))
                              bibtex-autokey-year-title-separator)
                            year)))
      (<span class="org-keyword">if</span> bibtex-autokey-before-presentation-function
          (funcall bibtex-autokey-before-presentation-function autokey)
        autokey)))

  (define-key org-mode-map (kbd <span class="org-string">"C-]"</span>) #'org-ref-insert-link))
</pre>
</div>

<p>
Download papers to current directory and insert BibTeX entry to current
buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">arxiv-local-add-bibtex-entry</span> (arxiv-number)
  <span class="org-doc">"Add bibtex entry for ARXIV-NUMBER to current buffer."</span>
  (<span class="org-keyword">interactive</span>
   (list (read-string
          <span class="org-string">"arxiv: "</span>
          (arxiv-maybe-arxiv-id-from-current-kill))))
  (<span class="org-keyword">save-excursion</span>
    (goto-char (point-max))
    (<span class="org-keyword">when</span> (not (looking-at <span class="org-string">"^"</span>)) (insert <span class="org-string">"\n"</span>))
    (insert (arxiv-get-bibtex-entry-via-arxiv-api arxiv-number))
    (org-ref-clean-bibtex-entry)
    (goto-char (point-max))
    (<span class="org-keyword">when</span> (not (looking-at <span class="org-string">"^"</span>)) (insert <span class="org-string">"\n"</span>))))


(<span class="org-keyword">defun</span> <span class="org-function-name">arxiv-local-get-pdf-add-bibtex-entry</span> (arxiv-number pdfdir)
  <span class="org-doc">"Add bibtex entry for ARXIV-NUMBER to current buffer.</span>
<span class="org-doc">Remove troublesome chars from the bibtex key, retrieve a pdf</span>
<span class="org-doc">for ARXIV-NUMBER and save it to PDFDIR with the same name of the</span>
<span class="org-doc">key."</span>
  (<span class="org-keyword">interactive</span>
   (list (read-string
          <span class="org-string">"arxiv: "</span>
          (arxiv-maybe-arxiv-id-from-current-kill))
         default-directory))

  (arxiv-local-add-bibtex-entry arxiv-number)

  (<span class="org-keyword">save-excursion</span>
    (<span class="org-keyword">let</span> ((key <span class="org-string">""</span>))
      (goto-char (point-max))
      (bibtex-beginning-of-entry)
      (re-search-forward bibtex-entry-maybe-empty-head)
      (<span class="org-keyword">if</span> (match-beginning bibtex-key-in-head)
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">setq</span> key (delete-and-extract-region
                       (match-beginning bibtex-key-in-head)
                       (match-end bibtex-key-in-head)))
            <span class="org-comment-delimiter">;; </span><span class="org-comment">remove potentially troublesome characters from key</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">as it will be used as  a filename</span>
            (<span class="org-keyword">setq</span> key (replace-regexp-in-string   <span class="org-string">"\"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">/</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">:</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">&lt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">&gt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\?</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\\\</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">|</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">,</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\.</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">=</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\[</span><span class="org-string"><span class="org-constant"><span class="org-regexp-grouping-backslash">\\</span></span></span><span class="org-string"><span class="org-constant"><span class="org-regexp-grouping-construct">|</span></span></span><span class="org-string">]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">!</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">@"</span>
                                                  <span class="org-string">""</span> key))
            <span class="org-comment-delimiter">;; </span><span class="org-comment">check if the key is in the buffer</span>
            (<span class="org-keyword">when</span> (<span class="org-keyword">save-excursion</span>
                    (bibtex-search-entry key))
              (<span class="org-keyword">save-excursion</span>
                (bibtex-search-entry key)
                (bibtex-copy-entry-as-kill)
                (switch-to-buffer-other-window <span class="org-string">"*duplicate entry*"</span>)
                (bibtex-yank))
              (<span class="org-keyword">setq</span> key (bibtex-read-key <span class="org-string">"Duplicate Key found, edit: "</span> key))))
        (<span class="org-keyword">setq</span> key (bibtex-read-key <span class="org-string">"Key not found, insert: "</span>)))
      (insert key)
      (arxiv-get-pdf arxiv-number (concat pdfdir key <span class="org-string">".pdf"</span>))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Check that it worked, and insert a field for it.</span>
      (<span class="org-keyword">when</span> (file-exists-p (concat pdfdir key <span class="org-string">".pdf"</span>))
        (bibtex-end-of-entry)
        (backward-char)
        (insert (format <span class="org-string">"  file = {%s}\n  "</span> (concat pdfdir key <span class="org-string">".pdf"</span>)))))))


(<span class="org-keyword">defun</span> <span class="org-function-name">doi-utils-local-async-download-pdf</span> ()
  <span class="org-doc">"Download the PDF for bibtex entry at point asynchronously.</span>
<span class="org-doc">It is not fully async, only the download is. Fully async is</span>
<span class="org-doc">harder because you need to run `</span><span class="org-doc"><span class="org-constant">doi-utils-get-pdf-url</span></span><span class="org-doc">' async</span>
<span class="org-doc">too. "</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">async</span>)
  (<span class="org-keyword">save-excursion</span>
    (bibtex-beginning-of-entry)
    (<span class="org-keyword">let</span> (<span class="org-comment-delimiter">;; </span><span class="org-comment">get doi, removing http://dx.doi.org/ if it is there.</span>
          (doi (replace-regexp-in-string
                <span class="org-string">"https?://</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">dx.</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?.doi.org/"</span> <span class="org-string">""</span>
                (bibtex-autokey-get-field <span class="org-string">"doi"</span>)))
          (key (cdr (assoc <span class="org-string">"=key="</span> (bibtex-parse-entry))))
          (pdf-url)
          (pdf-file))

      (<span class="org-keyword">setq</span> pdf-file (concat default-directory key <span class="org-string">".pdf"</span>))

      (<span class="org-keyword">unless</span> doi (<span class="org-warning">error</span> <span class="org-string">"No DOI found to get a pdf for"</span>))

      (<span class="org-keyword">when</span> (file-exists-p pdf-file)
        (<span class="org-warning">error</span> <span class="org-string">"%s already exists. Delete to re-download"</span> pdf-file))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(doi-utils-get-pdf-url "10.1063/1.5019667")</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">If you get here, try getting the pdf file</span>
      (async-start
       `(<span class="org-keyword">lambda</span> ()
          (<span class="org-keyword">setq</span> package-user-dir ,package-user-dir)
          (<span class="org-keyword">require</span> '<span class="org-constant">package</span>)
          (package-initialize)
          (<span class="org-keyword">setq</span> load-path (list ,@load-path))
          (<span class="org-keyword">require</span> '<span class="org-constant">doi-utils</span>)

          (<span class="org-keyword">setq</span> pdf-url (doi-utils-get-pdf-url ,doi))
          (<span class="org-keyword">when</span> pdf-url
            (url-copy-file pdf-url ,pdf-file t)

            (<span class="org-keyword">let*</span> ((header (<span class="org-keyword">with-temp-buffer</span>
                             (set-buffer-multibyte nil)
                             (insert-file-contents-literally ,pdf-file nil 0 5)
                             (buffer-string)))
                   (valid (<span class="org-keyword">and</span> (stringp header)
                               (string-equal (encode-coding-string header 'utf-8) <span class="org-string">"%PDF-"</span>))))
              (<span class="org-keyword">if</span> valid
                  (format <span class="org-string">"%s downloaded"</span> ,pdf-file)
                (delete-file ,pdf-file)
                (<span class="org-keyword">require</span> '<span class="org-constant">browse-url</span>)
                (browse-url pdf-url)
                (message <span class="org-string">"Invalid pdf (file deleted). Header = %s"</span> header)))))
       `(<span class="org-keyword">lambda</span> (result)
          (message <span class="org-string">"doi-utils-async-download-pdf: %s"</span>  result))))))


(<span class="org-keyword">defun</span> <span class="org-function-name">doi-utils-local-get-bibtex-entry-pdf</span> (<span class="org-type">&amp;optional</span> arg)
  <span class="org-doc">"Download pdf for entry at point if the pdf does not already exist locally.</span>
<span class="org-doc">The entry must have a doi. The pdf will be saved, by the name</span>
<span class="org-doc">%s.pdf where %s is the bibtex label. Files will not be</span>
<span class="org-doc">overwritten. The pdf will be checked to make sure it is a pdf,</span>
<span class="org-doc">and not some html failure page. You must have permission to</span>
<span class="org-doc">access the pdf. We open the pdf at the end if</span>
<span class="org-doc">`</span><span class="org-doc"><span class="org-constant">doi-utils-open-pdf-after-download</span></span><span class="org-doc">' is non-nil.</span>

<span class="org-doc">With one prefix ARG, directly get the pdf from a file (through</span>
<span class="org-doc">`</span><span class="org-doc"><span class="org-constant">read-file-name</span></span><span class="org-doc">') instead of looking up a DOI. With a double</span>
<span class="org-doc">prefix ARG, directly get the pdf from an open buffer (through</span>
<span class="org-doc">`</span><span class="org-doc"><span class="org-constant">read-buffer-to-switch</span></span><span class="org-doc">') instead. These two alternative methods</span>
<span class="org-doc">work even if the entry has no DOI, and the pdf file is not</span>
<span class="org-doc">checked."</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
  (<span class="org-keyword">save-excursion</span>
    (bibtex-beginning-of-entry)
    (<span class="org-keyword">let</span> (<span class="org-comment-delimiter">;; </span><span class="org-comment">get doi, removing http://dx.doi.org/ if it is there.</span>
          (doi (replace-regexp-in-string
                <span class="org-string">"https?://</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">dx.</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?.doi.org/"</span> <span class="org-string">""</span>
                (bibtex-autokey-get-field <span class="org-string">"doi"</span>)))
          (key (cdr (assoc <span class="org-string">"=key="</span> (bibtex-parse-entry))))
          (pdf-url)
          (pdf-file))

      (<span class="org-keyword">setq</span> pdf-file (concat default-directory key <span class="org-string">".pdf"</span>))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">now get file if needed.</span>
      (<span class="org-keyword">unless</span> (file-exists-p pdf-file)
    (<span class="org-keyword">cond</span>
     ((<span class="org-keyword">and</span> (not arg)
           doi
           (<span class="org-keyword">setq</span> pdf-url (doi-utils-get-pdf-url doi)))
      (url-copy-file pdf-url pdf-file)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">now check if we got a pdf</span>
          (<span class="org-keyword">if</span> (org-ref-pdf-p pdf-file)
              (message <span class="org-string">"%s saved"</span> pdf-file)
            (delete-file pdf-file)
            (message <span class="org-string">"No pdf was downloaded."</span>)
            (browse-url pdf-url)))
     ((equal arg '(4))
      (copy-file (expand-file-name (read-file-name <span class="org-string">"Pdf file: "</span> nil nil t))
             pdf-file))
     ((equal arg '(16))
      (<span class="org-keyword">with-current-buffer</span> (read-buffer-to-switch <span class="org-string">"Pdf buffer: "</span>)
        (write-file pdf-file)))
     (t
      (message <span class="org-string">"We don't have a recipe for this journal."</span>)))

    (<span class="org-keyword">when</span> (file-exists-p pdf-file)
      (bibtex-set-field <span class="org-string">"file"</span> pdf-file))

    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> doi-utils-open-pdf-after-download (file-exists-p pdf-file))
      (org-open-file pdf-file))))))


(<span class="org-keyword">defun</span> <span class="org-function-name">doi-utils-add-bibtex-entry-from-doi</span> (doi)
  <span class="org-doc">"Add DOI entry to end of a file in the current directory.</span>
<span class="org-doc">Pick the file ending with .bib or in .  If you have an active region that</span>
<span class="org-doc">starts like a DOI, that will be the initial prompt.  If no region</span>
<span class="org-doc">is selected and the first entry of the &#8216;</span><span class="org-doc"><span class="org-constant">kill-ring</span></span><span class="org-doc">&#8217; starts like a</span>
<span class="org-doc">DOI, then that is the intial prompt.  Otherwise, you have to type</span>
<span class="org-doc">or paste in a DOI.</span>
<span class="org-doc">Argument BIBFILE the bibliography to use."</span>
  (<span class="org-keyword">interactive</span>
   (list (read-string
          <span class="org-string">"DOI: "</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">now set initial input</span>
          (doi-utils-maybe-doi-from-region-or-current-kill))))

  
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Wrap in save-window-excursion to restore your window arrangement after this</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">is done.</span>
  (<span class="org-keyword">save-excursion</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Check if the doi already exists</span>
      (goto-char (point-min))
      (<span class="org-keyword">if</span> (re-search-forward (concat doi <span class="org-string">"\\_&gt;"</span>) nil t)
          (message <span class="org-string">"%s is already in this file"</span> doi)
        (goto-char (point-max))

    (<span class="org-keyword">when</span> (not (looking-back <span class="org-string">"\n\n"</span> (min 3 (point))))
      (insert <span class="org-string">"\n\n"</span>))

        (doi-utils-insert-bibtex-entry-from-doi doi))))


(<span class="org-keyword">defun</span> <span class="org-function-name">doi-utils-local-add-bibtex-entry-from-doi</span> (doi)
  <span class="org-doc">"Add DOI entry to end of a file in the current directory.</span>
<span class="org-doc">Pick the file ending with .bib or in .  If you have an active region that</span>
<span class="org-doc">starts like a DOI, that will be the initial prompt.  If no region</span>
<span class="org-doc">is selected and the first entry of the &#8216;</span><span class="org-doc"><span class="org-constant">kill-ring</span></span><span class="org-doc">&#8217; starts like a</span>
<span class="org-doc">DOI, then that is the intial prompt.  Otherwise, you have to type</span>
<span class="org-doc">or paste in a DOI.</span>
<span class="org-doc">Argument BIBFILE the bibliography to use."</span>
  (<span class="org-keyword">interactive</span>
   (list (read-string
          <span class="org-string">"DOI: "</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">now set initial input</span>
          (doi-utils-maybe-doi-from-region-or-current-kill))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Wrap in save-window-excursion to restore your window arrangement after this</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">is done.</span>
  (<span class="org-keyword">save-excursion</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Check if the doi already exists</span>
      (goto-char (point-min))
      (<span class="org-keyword">if</span> (re-search-forward (concat doi <span class="org-string">"\\_&gt;"</span>) nil t)
          (message <span class="org-string">"%s is already in this file"</span> doi)
        (goto-char (point-max))

    (<span class="org-keyword">when</span> (not (looking-back <span class="org-string">"\n\n"</span> (min 3 (point))))
      (insert <span class="org-string">"\n\n"</span>))

        (doi-utils-insert-bibtex-entry-from-doi doi))))


(<span class="org-keyword">defun</span> <span class="org-function-name">orcb-local-download-pdf</span> ()
  <span class="org-doc">"Try to get the pdf in an entry."</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">try to get pdf</span>
  (<span class="org-keyword">when</span> doi-utils-download-pdf
    (<span class="org-keyword">if</span> doi-utils-async-download
        (doi-utils-local-async-download-pdf)
      (doi-utils-local-get-bibtex-entry-pdf))))


(<span class="org-keyword">setq-default</span> org-ref-clean-bibtex-entry-hook '(org-ref-bibtex-format-url-if-doi
                                                orcb-key-comma
                                                org-ref-replace-nonascii
                                                orcb-&amp;
                                                orcb-%
                                                org-ref-title-case-article
                                                orcb-clean-year
                                                orcb-key
                                                orcb-clean-doi
                                                orcb-clean-pages
                                                orcb-check-journal
                                                org-ref-sort-bibtex-entry
                                                orcb-fix-spacing
                                                orcb-local-download-pdf))
</pre>
</div>

<p>
Format citation candidates properly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">org-ref-read-key</span> ()
  <span class="org-doc">"Read a key with completion."</span>
  (<span class="org-keyword">unless</span> bibtex-completion-display-formats-internal
    (bibtex-completion-init))
  (<span class="org-keyword">let*</span> ((bibtex-completion-bibliography (org-ref-find-bibliography))
     (candidates (mapcar (<span class="org-keyword">lambda</span> (entry)
                   (cons (bibtex-completion-format-entry entry (- (frame-width) 4))
                     (cdr entry)))
                 (bibtex-completion-candidates)))
     (choice (completing-read <span class="org-string">"org-ref BibTeX entries: "</span> candidates)))
    (cdr (assoc <span class="org-string">"=key="</span> (assoc choice candidates)))))
</pre>
</div>

<p>
BibTeX key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">evil-define-key</span> 'insert bibtex-mode-map (kbd <span class="org-string">"C-]"</span>) #'doi-utils-add-bibtex-entry-from-doi)
(<span class="org-keyword">evil-define-key</span> 'normal bibtex-mode-map (kbd <span class="org-string">"C-]"</span>) #'doi-utils-add-bibtex-entry-from-doi)

(<span class="org-keyword">evil-define-key</span> 'insert bibtex-mode-map (kbd <span class="org-string">"C-M-]"</span>) #'arxiv-local-get-pdf-add-bibtex-entry)
(<span class="org-keyword">evil-define-key</span> 'normal bibtex-mode-map (kbd <span class="org-string">"C-M-]"</span>) #'arxiv-local-get-pdf-add-bibtex-entry)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf0b4860" class="outline-3">
<h3 id="orgf0b4860">Export</h3>
<div class="outline-text-3" id="text-orgf0b4860">
<p>
Latex export options.
</p>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,12pt]{article}

\\usepackage[doublespacing]{setspace}
\\usepackage[margin=1in]{geometry}
\\usepackage{csquotes}
\\usepackage{amsmath}
\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage[style=apa,backend=biber]{biblatex}
\\usepackage[small]{titlesec}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,man]{apa6}

\\usepackage{csquotes}
\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage[style=apa,backend=biber]{biblatex}

\\renewcommand*{\\finalnamedelim}{ \\ifnumgreater{\\value{liststop}}{2}{\\finalandomma}{} \\addspace\\&amp;\\space}

\\usepackage[skip=0pt]{parskip}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,12pt,oneside]{book}
\\usepackage[margin=1in]{geometry}
\\usepackage{csquotes}
\\usepackage{amsmath}
\\usepackage{amssymb}
\\usepackage{gensymb}
\\usepackage{siunitx}
\\usepackage{float}
\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage{fancyhdr}
\\usepackage{xhfill}
\\usepackage[svgnames]{xcolor}
\\usepackage[explicit]{titlesec}
\\usepackage[defaultsans,scale=1]{opensans}
\\usepackage[T1]{fontenc}
\\usepackage{anyfontsize}
\\usepackage[many]{tcolorbox}
\\usepackage{amsthm}
\\usepackage{tikz}
\\usepackage{microtype}
\\usepackage{adjustbox}

\\definecolor{title-foreground}{RGB}{230,230,230}
\\definecolor{subtitle-foreground}{RGB}{120,120,120}
\\definecolor{chapter-foreground}{RGB}{80,80,80}

\\definecolor{theorem-background}{RGB}{0,53,110}
\\definecolor{definition-background}{RGB}{0,87,153}
\\definecolor{example-background}{RGB}{86,152,179}
\\definecolor{note-background}{RGB}{0,53,110}

\\colorlet{rulecolor}{Gainsboro!40!Lavender}
\\titleformat{\\chapter}[display]
{\\filcenter}{\\mbox{}\\xrfill[0.4ex]{3pt}[rulecolor]\\textsc{\\large\\enspace\\chaptername~\\thechapter}\\enspace\\xrfill[0.4ex]{3pt}[rulecolor]\\mbox{}}{0.3ex}
{{\\color{rulecolor}\\titlerule[1pt]}\\vskip3ex\\huge\\sffamily\\color{chapter-foreground}#1}[\\vskip1.2ex{\\color{rulecolor}\\titlerule[1pt]}]

\\titleformat{\\section}{\\sffamily\\large}{\\thesection.}{.5em}{#1}
\\titleformat{\\subsection}{\\sffamily\\large}{\\thesubsection.}{.5em}{#1}

\\tcbuselibrary{theorems}

\\newtcbtheorem[number within=chapter]{old-theorem}{Theorem}{
  breakable,
  colback=theorem-background!10,
  colframe=theorem-background!55!black,
  fonttitle=\\bfseries\\sffamily}{th}

\\newtcbtheorem[number within=chapter]{old-exmp}{Example}{
  breakable,
  colback=example-background!10,
  colframe=example-background!55!black,
  fonttitle=\\bfseries\\sffamily}{ex}

\\newtcbtheorem[number within=chapter]{old-definition}{Definition}{
  breakable,
  colback=definition-background!10,
  colframe=definition-background!65!black,
  fonttitle=\\bfseries\\sffamily}{def}

\\newtcolorbox{note}[1][]{
  enhanced jigsaw,
  borderline west={2pt}{0pt}{note-background},
  sharp corners,
  boxrule=0pt,
  fonttitle={\\bfseries\\sffamily},
  coltitle={black},
  title={Note:\\ },
  attach title to upper,
  #1
}

\\renewenvironment{theorem}[1][]{%
  \\begin{old-theorem}{#1}{}%
    
}{%
  \\end{old-theorem}%
}

\\renewenvironment{exmp}{%
  \\begin{old-exmp}{}{}%
    
}{%
  \\end{old-exmp}%
}

\\renewenvironment{definition}{%
  \\begin{old-definition}{}{}%
    
}{%
  \\end{old-definition}%
}

\\newtheorem{exercise}{Exercise}
\\numberwithin{exercise}{chapter}
\\newtheorem{lemma}{Lemma}[theorem]
\\numberwithin{lemma}{chapter}
\\newtheorem{corollary}{Corollary}[theorem]
\\numberwithin{corollary}{chapter}

\\setlength{\\parskip}{.5em}
\\setlength{\\parindent}{0pt}

\\pagestyle{fancy}
\\fancyhf{}
\\renewcommand{\\chaptermark}[1]{\\markboth{#1}{}}
\\renewcommand{\\sectionmark}[1]{\\markright{SECTION \\thesection. \\uppercase{#1}}}
\\let\\oldtitle\\title
\\renewcommand{\\title}[1]{\\oldtitle{#1}\\def\\titletext{#1}}
\\fancyhead[L]{\\leftmark}
\\fancyhead[R]{\\titletext}
\\fancyfoot[C]{\\rightmark}
\\fancyfoot[R]{\\thepage}

\\newcommand*{\\textinrule}[3][]{%
  \\makebox[#2]{#1%
    \\leaders\\hrule height \\dimexpr.5ex+.2pt\\relax depth \\dimexpr -.5ex+.2pt\\relax \\hfill% Left rule
    \\enskip{#3}\\enskip% Text (and surrounding spaces)
    \\leaders\\hrule height \\dimexpr.5ex+.2pt\\relax depth \\dimexpr -.5ex+.2pt\\relax \\hfill\\kern0pt}% Right rule
}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-text">\\documentclass[a4paper,12pt,oneside]{book}
\\usepackage[margin=1in]{geometry}
\\usepackage{csquotes}
\\usepackage{amsmath}
\\usepackage{amssymb}
\\usepackage{gensymb}
\\usepackage{siunitx}

\\usepackage{float}

\\usepackage{graphicx}
\\usepackage[hidelinks]{hyperref}
\\usepackage{fancyhdr}
\\usepackage[explicit]{titlesec}

\\titleformat{\\chapter}{\\normalfont\\huge}{#1}{}{}
\\titleformat{\\section}{\\normalfont\\large}{}{.5em}{#1}
\\titleformat{\\subsection}{\\normalfont\\large}{}{.5em}{\\textit{#1}}

\\titlespacing{\\chapter}{0pt}{0pt}{1em}

\\usepackage{amsthm}
\\setlength{\\parskip}{.5em}
\\setlength{\\parindent}{0pt}
\\newtheoremstyle{boxed}{8pt}{8pt}{}{}{\\upshape\\bfseries}{.}{.5em}{}
\\theoremstyle{boxed}
\\newtheorem{theorem}{Theorem}
\\numberwithin{theorem}{chapter}
\\newtheorem{note}{Note}
\\numberwithin{note}{chapter}
\\newtheorem{exmp}{Example}
\\numberwithin{exmp}{chapter}
\\newtheorem{corollary}{Corollary}
\\numberwithin{corollary}{chapter}
\\newtheorem{exercise}{Exercise}
\\numberwithin{exercise}{chapter}
\\newtheorem{definition}{Definition}
\\numberwithin{definition}{chapter}
\\newtheorem{lemma}{Lemma}[theorem]
\\numberwithin{lemma}{chapter}
\\usepackage{mdframed}
\\BeforeBeginEnvironment{theorem}{\\begin{mdframed}}
\\AfterEndEnvironment{theorem}{\\end{mdframed}}
\\BeforeBeginEnvironment{corollary}{\\begin{mdframed}}
\\AfterEndEnvironment{corollary}{\\end{mdframed}}
\\BeforeBeginEnvironment{exmp}{\\begin{mdframed}}
\\AfterEndEnvironment{exmp}{\\end{mdframed}}
\\BeforeBeginEnvironment{exercise}{\\begin{mdframed}}
\\AfterEndEnvironment{exercise}{\\end{mdframed}}
\\BeforeBeginEnvironment{definition}{\\begin{mdframed}}
\\AfterEndEnvironment{definition}{\\end{mdframed}}
\\pagestyle{fancy}
\\fancyhf{}

\\renewcommand{\\chaptermark}[1]{\\markboth{#1}{}}

\\let\\oldtitle\\title
\\renewcommand{\\title}[1]{\\oldtitle{#1}\\def\\titletext{#1}}
\\fancyhead[L]{\\leftmark}
\\fancyhead[R]{\\titletext}
\\fancyfoot[R]{\\thepage}

[NO-DEFAULT-PACKAGES]
[PACKAGES]
[EXTRA]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq</span> org-latex-default-packages-alist '())


(add-to-list 'org-latex-classes
             `(<span class="org-string">"assignment"</span>
               <span class="org-string">"</span>
<span class="org-string">&lt;&lt;org-latex-assignment-class&gt;&gt;"</span>
               (<span class="org-string">"\\section{%s}"</span> . <span class="org-string">"\\section*{%s}"</span>)
               (<span class="org-string">"\\subsection{%s}"</span> . <span class="org-string">"\\subsection*{%s}"</span>)
               (<span class="org-string">"\\subsubsection{%s}"</span> . <span class="org-string">"\\subsubsection*{%s}"</span>)
               (<span class="org-string">"\\paragraph{%s}"</span> . <span class="org-string">"\\paragraph*{%s}"</span>)
               (<span class="org-string">"\\subparagraph{%s}"</span> . <span class="org-string">"\\subparagraph*{%s}"</span>)))


(add-to-list 'org-latex-classes
             '(<span class="org-string">"apa6"</span>
               <span class="org-string">"</span>
<span class="org-string">&lt;&lt;org-latex-apa6-class&gt;&gt;"</span>
               (<span class="org-string">"\\section{%s}"</span> . <span class="org-string">"\\section*{%s}"</span>)
               (<span class="org-string">"\\subsection{%s}"</span> . <span class="org-string">"\\subsection*{%s}"</span>)
               (<span class="org-string">"\\subsubsection{%s}"</span> . <span class="org-string">"\\subsubsection*{%s}"</span>)
               (<span class="org-string">"\\paragraph{%s}"</span> . <span class="org-string">"\\paragraph*{%s}"</span>)
               (<span class="org-string">"\\subparagraph{%s}"</span> . <span class="org-string">"\\subparagraph*{%s}"</span>)))


(add-to-list 'org-latex-classes
             '(<span class="org-string">"math-document"</span>
               <span class="org-string">"</span>
<span class="org-string">&lt;&lt;org-latex-math-document-class&gt;&gt;"</span>
               (<span class="org-string">"\\chapter{%s}"</span> . <span class="org-string">"\\chapter{%s}"</span>)
               (<span class="org-string">"\\section{%s}"</span> . <span class="org-string">"\\section{%s}"</span>)
               (<span class="org-string">"\\subsection{%s}"</span> . <span class="org-string">"\\subsection{%s}"</span>)
               (<span class="org-string">"\\subsubsection{%s}"</span> . <span class="org-string">"\\subsubsection{%s}"</span>)
               (<span class="org-string">"\\paragraph{%s}"</span> . <span class="org-string">"\\paragraph{%s}"</span>)
               (<span class="org-string">"\\subparagraph{%s}"</span> . <span class="org-string">"\\subparagraph{%s}"</span>)))


(add-to-list 'org-latex-classes
             '(<span class="org-string">"math-homework"</span>
               <span class="org-string">"</span>
<span class="org-string">&lt;&lt;org-latex-math-homework-class&gt;&gt;"</span>
               (<span class="org-string">"\\chapter{%s}"</span> . <span class="org-string">"\\chapter{%s}"</span>)
               (<span class="org-string">"\\section*{%s}"</span> . <span class="org-string">"\\section*{%s}"</span>)
               (<span class="org-string">"\\subsection*{%s}"</span> . <span class="org-string">"\\subsection*{%s}"</span>)
               (<span class="org-string">"\\subsubsection*{%s}"</span> . <span class="org-string">"\\subsubsection*{%s}"</span>)
               (<span class="org-string">"\\paragraph{%s}"</span> . <span class="org-string">"\\paragraph{%s}"</span>)
               (<span class="org-string">"\\subparagraph{%s}"</span> . <span class="org-string">"\\subparagraph{%s}"</span>)))
</pre>
</div>


<p>
Custom export functions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">export-and-open-html</span> ()
  <span class="org-doc">"Export \"org-mode\" file to HTML and open it."</span>
  (<span class="org-keyword">interactive</span>)
  (shell-command (format <span class="org-string">"open -a Vivaldi '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">'"</span> (org-html-export-to-html))))


(<span class="org-keyword">defvar</span> <span class="org-variable-name">org-pdf-through-latex</span> t
  <span class="org-doc">"Export \"org-mode\" file to latex before converting to PDF. Otherwise, convert to HTML first."</span>)


(<span class="org-keyword">defun</span> <span class="org-function-name">export-and-open-pdf</span> (separate-window)
  <span class="org-doc">"Export \"org-mode\" file to PDF, then preview."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((output-path (format <span class="org-string">"%s.pdf"</span> (file-name-sans-extension (buffer-file-name)))))
    (<span class="org-keyword">if</span> org-pdf-through-latex
        (shell-command-to-string
         (format
          <span class="org-string">"latexmk -pdf -jobname=temp -f %s; rm *.aux *.fls *.log *.out *.fdb_latexmk; mv temp.pdf '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">'"</span>
          (org-latex-export-to-latex)
          output-path))
      (shell-command-to-string (format
                                <span class="org-string">"wkhtmltopdf --disable-smart-shrinking %s %s"</span>
                                (org-html-export-to-html) output-path)))
    (<span class="org-keyword">if</span> separate-window
        (find-file-other-window output-path)
      (find-file output-path))))


(<span class="org-keyword">defvar</span> <span class="org-variable-name">org-pdf-export-running</span> nil)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">org-pdf-export-has-queue</span> nil)


(<span class="org-keyword">defun</span> <span class="org-function-name">org-export-pdf-update</span> ()
  <span class="org-doc">"Export \"org-mode\" file to PDF in background."</span>
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">if</span> org-pdf-export-running
      (<span class="org-keyword">setq</span> org-pdf-export-has-queue t)
    (<span class="org-keyword">setq</span> org-pdf-export-running t)
    (<span class="org-keyword">let*</span> ((output-path (format <span class="org-string">"%s.pdf"</span> (file-name-sans-extension (buffer-file-name))))
           (output-buffer (generate-new-buffer <span class="org-string">"*Async shell command*"</span>))
           (inhibit-message t)
           (proc (<span class="org-keyword">save-window-excursion</span>
                   (async-shell-command
                    (format
                     <span class="org-string">"latexmk -pdf -jobname=temp -f %s; rm *.aux *.fls *.log *.out *.fdb_latexmk; mv temp.pdf '</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">'"</span>
                     (org-latex-export-to-latex)
                     output-path)
                    output-buffer)
                   (get-buffer-process output-buffer))))
      (<span class="org-keyword">if</span> (process-live-p proc)
          (set-process-sentinel proc #'(<span class="org-keyword">lambda</span> (process signal)
                                         (<span class="org-keyword">when</span> (memq (process-status process) '(exit signal))
                                           (<span class="org-keyword">setq</span> org-pdf-export-running nil)
                                           (kill-buffer <span class="org-string">"*Async shell command*"</span>)
                                           (shell-command-sentinel process signal)

                                           (<span class="org-keyword">when</span> org-pdf-export-has-queue
                                             (<span class="org-keyword">setq</span> org-pdf-export-has-queue nil)
                                             (org-export-pdf-update)))))))))
</pre>
</div>

<p>
Add head to org mode HTML export.
</p>

<div class="org-src-container">
<pre class="src src-javascript">document.addEventListener(<span class="org-string">'DOMContentLoaded'</span>, () =&gt; {
    document.querySelectorAll(<span class="org-string">'table.currency td.org-right'</span>).forEach(elem =&gt; {
        <span class="org-keyword">const</span> <span class="org-variable-name">text</span> = elem.innerText;
        <span class="org-keyword">if</span> (!isNaN(text)) {
            <span class="org-keyword">let</span> <span class="org-variable-name">num</span> = (Math.round(parseFloat(text) * 100) / 100).toFixed(2);
            elem.innerText = <span class="org-string">'$'</span> + num.toString().replace(<span class="org-string">/\\B(?=(\\d{3})+(?!\\d))/</span>g, <span class="org-string">','</span>);
        }
    });
});
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">org-html-custom-css-path</span> (concat emacs-configuration-directory <span class="org-string">"org_style.css"</span>)
  <span class="org-doc">"Path to default custom css."</span>)


<span class="org-comment-delimiter">;; </span><span class="org-comment">org-mode custom HTML head export</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">org-html-export-head-hook</span> (exporter)
  <span class="org-doc">"Insert custom inline head."</span>
  (<span class="org-keyword">when</span> (eq exporter 'html)
    (<span class="org-keyword">let*</span> ((dir (<span class="org-keyword">ignore-errors</span> (file-name-directory (buffer-file-name))))
           (path (concat dir <span class="org-string">"style.css"</span>))
           (homestyle (<span class="org-keyword">or</span> (null dir) (null (file-exists-p path))))
           (final (<span class="org-keyword">if</span> homestyle org-html-custom-css-path path)))
      (<span class="org-keyword">setq</span> org-html-head-include-default-style nil)
      (<span class="org-keyword">setq</span> org-html-head (concat
                           <span class="org-string">"&lt;style type=\"text/css\"&gt;\n"</span>
                           <span class="org-string">"&lt;!--/*--&gt;&lt;![CDATA[/*&gt;&lt;!--*/\n"</span>
                           (<span class="org-keyword">with-temp-buffer</span>
                             (insert-file-contents final)
                             (buffer-string))
                           <span class="org-string">"/*]]&gt;*/--&gt;\n"</span>
                           <span class="org-string">"&lt;/style&gt;\n"</span>
                           <span class="org-string">"\n"</span>
                           <span class="org-string">"&lt;script&gt;</span>
<span class="org-string">&lt;&lt;org-html-export-head-script&gt;&gt;</span>
<span class="org-string">&lt;/script&gt;"</span>)))))


(add-hook 'org-export-before-processing-hook #'org-html-export-head-hook)


(<span class="org-keyword">setq-default</span> org-html-mathjax-template
              <span class="org-string">"&lt;script type=\"text/x-mathjax-config\"&gt;</span>
<span class="org-string">    MathJax.Ajax.config.path[\"mhchem\"] = \"https://cdnjs.cloudflare.com/ajax/libs/mathjax-mhchem/3.3.2\";</span>
<span class="org-string">    MathJax.Hub.Config({</span>
<span class="org-string">        displayAlign: \"%ALIGN\",</span>
<span class="org-string">        displayIndent: \"%INDENT\",</span>

<span class="org-string">        \"HTML-CSS\": { scale: %SCALE,</span>
<span class="org-string">                        linebreaks: { automatic: \"%LINEBREAKS\" },</span>
<span class="org-string">                        webFont: \"%FONT\"</span>
<span class="org-string">                       },</span>
<span class="org-string">        SVG: {scale: %SCALE,</span>
<span class="org-string">              linebreaks: { automatic: \"%LINEBREAKS\" },</span>
<span class="org-string">              font: \"%FONT\"},</span>
<span class="org-string">        NativeMML: {scale: %SCALE},</span>
<span class="org-string">        TeX: { equationNumbers: {autoNumber: \"%AUTONUMBER\"},</span>
<span class="org-string">               MultLineWidth: \"%MULTLINEWIDTH\",</span>
<span class="org-string">               TagSide: \"%TAGSIDE\",</span>
<span class="org-string">               TagIndent: \"%TAGINDENT\",</span>
<span class="org-string">               extensions: [\"[mhchem]/mhchem.js\"]</span>
<span class="org-string">             },</span>
<span class="org-string">    });</span>
<span class="org-string">&lt;/script&gt;</span>
<span class="org-string">&lt;script src=\"%PATH\"&gt;&lt;/script&gt;"</span>)
</pre>
</div>

<p>
Color quote in org mode and export to HTML (English class).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">export-colored</span> (num simple-separatorp)
  (<span class="org-keyword">interactive</span>
   (list
    (read-number <span class="org-string">"How many people? "</span>)
    (y-or-n-p <span class="org-string">"Use simple separators? "</span>)))
  (<span class="org-keyword">if</span> (equal major-mode 'org-mode)
      (<span class="org-keyword">progn</span>
        (shell-command (format <span class="org-string">"~/tcolor %s %s %s"</span> (buffer-file-name) num simple-separatorp))
        (<span class="org-keyword">let</span> ((old-buffer-path (buffer-file-name)))
          (<span class="org-keyword">with-current-buffer</span> (find-file-noselect (<span class="org-keyword">with-temp-buffer</span>
                                                     (insert old-buffer-path)
                                                     (goto-char (point-min))
                                                     (replace-regexp <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">\\.org"</span> <span class="org-string">"\\1_color.org"</span>)
                                                     (buffer-string)))
            (shell-command (format <span class="org-string">"open %s"</span> (org-html-export-to-html))))))
    (message <span class="org-string">"Please make sure this a `.org` file."</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5c10477" class="outline-3">
<h3 id="org5c10477">Miscellaneous</h3>
<div class="outline-text-3" id="text-org5c10477">
<p>
Other config. Limit this section as much as possible.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">disable company mode for org-mode</span>
(add-hook 'org-mode-hook #'(<span class="org-keyword">lambda</span> () (company-mode -1)))
(add-hook 'text-mode-hook #'(<span class="org-keyword">lambda</span> () (company-mode -1)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">make sure M-h binding works</span>
(add-hook 'org-mode-hook
          (<span class="org-keyword">lambda</span> ()
            (define-key org-mode-map <span class="org-string">"\M-h"</span> nil)
            (global-set-key (kbd <span class="org-string">"M-h"</span>) 'evil-window-left)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">open link in the same window</span>
(add-to-list 'org-link-frame-setup '(file . find-file))
(<span class="org-keyword">setq-default</span> help-window-keep-selected t)


<span class="org-comment-delimiter">;; </span><span class="org-comment">recalculate table</span>
(define-key org-mode-map (kbd <span class="org-string">"C-M-'"</span>) #'org-table-recalculate)


<span class="org-comment-delimiter">;; </span><span class="org-comment">recalculate table</span>
(define-key org-mode-map (kbd <span class="org-string">"C-M-;"</span>) #'(<span class="org-keyword">lambda</span> ()
                                           (<span class="org-keyword">interactive</span>)
                                           (org-table-eval-formula '(4))))


<span class="org-comment-delimiter">;; </span><span class="org-comment">clear field</span>
(define-key org-mode-map (kbd <span class="org-string">"C-c SPC"</span>) #'org-table-blank-field)


<span class="org-comment-delimiter">;; </span><span class="org-comment">start timer</span>
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g t s"</span>) #'org-timer-start)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g t m"</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (message (org-timer-value-string))))
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g t d"</span>) #'org-timer-set-timer)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g t i"</span>) #'org-timer)
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g t ."</span>)
  #'(<span class="org-keyword">lambda</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((final-timer-value (string-trim (org-timer-value-string))))
        (<span class="org-keyword">let</span> ((inhibit-message t))
          (org-timer-stop))
        (message <span class="org-string">"Timer stopped at %s."</span> final-timer-value))))
(<span class="org-keyword">evil-define-key</span> 'normal org-mode-map (kbd <span class="org-string">"g t ,"</span>) #'org-timer-pause-or-continue)


<span class="org-comment-delimiter">;; </span><span class="org-comment">disable pairing for single quotes</span>
(sp-local-pair 'org-mode <span class="org-string">"'"</span> nil <span class="org-builtin">:actions</span> nil)


<span class="org-comment-delimiter">;; </span><span class="org-comment">create a definition for a term in notes</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">org-note-create-definition</span> (start end)
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
  (<span class="org-keyword">let</span> ((old-point (point))
        (inhibit-message t))
    (<span class="org-keyword">if</span> (use-region-p)
        (<span class="org-keyword">let*</span> ((text (buffer-substring start end))
               (title (concat (upcase (substring text 0 1)) (substring text 1))))
          (replace-region-contents start end
                                   (<span class="org-keyword">lambda</span> ()
                                     (format <span class="org-string">"[[*%s][%s]]"</span> title text)))
          (goto-char (point-max))
          (yas-expand-snippet
           (format
            <span class="org-string">"\n%s ${1:%s}\n\n$2/${1:$(if (or (not (yas-field-value 2)) (equal (yas-field-value 2) \"\")) yas-text (downcase yas-text))}/ $0"</span>
            (org-heading-asterisks) title)
           (point-max))
          (evil-insert-state))
      (goto-char (point-max))
      (yas-expand-snippet
       <span class="org-string">"\n`(org-heading-asterisks)` $1\n\n$2/${1:$(if (equal (yas-field-value 2) \"\") yas-text (downcase yas-text))}/ $0"</span>
       (point-max))
      (evil-insert-state))
    (org-mark-ring-push old-point)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">function for how many asterisks required to create heading</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">org-heading-asterisks</span> ()
  (make-string (<span class="org-keyword">if</span> (&gt; (org-outline-level) 0)
                   (max (org-outline-level) 2)
                 1) <span class="org-warning">?*))</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">stop creating bookmarks after refiling</span>
(plist-put org-bookmark-names-plist <span class="org-builtin">:last-capture</span> nil)
(plist-put org-bookmark-names-plist <span class="org-builtin">:last-refile</span> nil)
(plist-put org-bookmark-names-plist <span class="org-builtin">:last-capture-marker</span> nil)
</pre>
</div>

<p>
Open file in full screen, previewing latex (extremely hacky, intended as
basically a macro).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">expand-org-latex-workspace</span> ()
  (<span class="org-keyword">interactive</span>)
  (toggle-buffer-in-buffer-ring)
  (evil-goto-line)
  (org-latex-preview-pdf 1)
  (make-frame '((fullscreen . fullboth)))
  (export-and-open-pdf t)
  (evil-collection-pdf-view-goto-page)
  (toggle-buffer-in-buffer-ring)
  (evil-window-left 1))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc0503b1" class="outline-2">
<h2 id="orgc0503b1">Ichthys</h2>
<div class="outline-text-2" id="text-orgc0503b1">
<p>
Also known as &lt;&gt;&lt;, this is a scripture-finding mode I wrote.
</p>

<p>
Relevant config.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">ichthys-mode</span>
  <span class="org-builtin">:load-path</span> <span class="org-string">"lisp/"</span>
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">binding to insert link in org-mode</span>
  (define-key org-mode-map (kbd <span class="org-string">"C-c i"</span>) #'ichthys/insert-link)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">create a ring for Portuguese and English scriptures</span>
  (ichthys/create-lang-ring
   <span class="org-string">"~/Documents/Church/Ichthys/Emacs/Portuguese"</span>
   <span class="org-string">"~/Documents/Church/Ichthys/Emacs/English"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">use &lt;f9&gt; to cycle between languages</span>
  (define-key global-map (kbd <span class="org-string">"&lt;f9&gt;"</span>) #'ichthys/lang-ring-next))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga28ae22" class="outline-2">
<h2 id="orga28ae22">Games</h2>
<div class="outline-text-2" id="text-orga28ae22">
</div>
<div id="outline-container-org952f525" class="outline-3">
<h3 id="org952f525">Gomoku</h3>
<div class="outline-text-3" id="text-org952f525">
<p>
Style configuration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">gomoku</span>
  <span class="org-builtin">:config</span>
  (set-face-attribute 'gomoku-O nil
                      <span class="org-builtin">:weight</span> 'bold
                      <span class="org-builtin">:foreground</span> <span class="org-string">"#cc6666"</span>)

  (set-face-attribute 'gomoku-X nil
                      <span class="org-builtin">:weight</span> 'bold
                      <span class="org-builtin">:foreground</span> <span class="org-string">"#6ca17a"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-orged00148" class="outline-3">
<h3 id="orged00148">Pong</h3>
<div class="outline-text-3" id="text-orged00148">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">pong</span>
  <span class="org-builtin">:config</span>
  (define-key pong-mode-map (kbd <span class="org-string">"s"</span>) #'pong-move-left)
  (define-key pong-mode-map (kbd <span class="org-string">"d"</span>) #'pong-move-right)
  (define-key pong-mode-map (kbd <span class="org-string">"k"</span>) #'pong-move-up)
  (define-key pong-mode-map (kbd <span class="org-string">"j"</span>) #'pong-move-down))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org312aa38" class="outline-2">
<h2 id="org312aa38">Miscellaneous</h2>
<div class="outline-text-2" id="text-org312aa38">
<p>
For uncategorized config. Avoid adding to this section.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">configure .curve for json</span>
(add-to-list 'auto-mode-alist '(<span class="org-string">"\\.curve\\'"</span> . json-mode))


<span class="org-comment-delimiter">;; </span><span class="org-comment">remove bell sound</span>
(<span class="org-keyword">setq-default</span> ring-bell-function 'ignore)


<span class="org-comment-delimiter">;; </span><span class="org-comment">delete a file by moving it to trash</span>
(<span class="org-keyword">setq-default</span> delete-by-moving-to-trash t)
(<span class="org-keyword">setq-default</span> trash-directory <span class="org-string">"~/.Trash"</span>)


<span class="org-comment-delimiter">;; </span><span class="org-comment">stop making backup files</span>
(<span class="org-keyword">setq-default</span> make-backup-files nil)
</pre>
</div>
</div>

<div id="outline-container-orgf30af60" class="outline-3">
<h3 id="orgf30af60">Calendar</h3>
<div class="outline-text-3" id="text-orgf30af60">
<p>
Add holidays to calendar.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">calendar</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">holidays</span>)


(<span class="org-keyword">defvar</span> <span class="org-variable-name">custom-holidays</span>
  '((holiday-fixed 1 1 <span class="org-string">"New Year's Day"</span>)
    (holiday-float 1 1 3 <span class="org-string">"Martin Luther King Day"</span>)
    (holiday-fixed 2 2 <span class="org-string">"Groundhog Day"</span>)
    (holiday-fixed 2 14 <span class="org-string">"Valentine's Day"</span>)
    (holiday-float 2 1 3 <span class="org-string">"President's Day"</span>)
    (holiday-fixed 3 17 <span class="org-string">"St. Patrick's Day"</span>)
    (holiday-fixed 4 1 <span class="org-string">"April Fools' Day"</span>)
    (holiday-float 5 0 2 <span class="org-string">"Mother's Day"</span>)
    (holiday-float 5 1 -1 <span class="org-string">"Memorial Day"</span>)
    (holiday-fixed 6 14 <span class="org-string">"Flag Day"</span>)
    (holiday-fixed 6 19 <span class="org-string">"Juneteenth"</span>)
    (holiday-float 6 0 3 <span class="org-string">"Father's Day"</span>)
    (holiday-fixed 7 4 <span class="org-string">"Independence Day"</span>)
    (holiday-fixed 7 25 <span class="org-string">"Pioneer Day"</span>)
    (holiday-float 9 1 1 <span class="org-string">"Labor Day"</span>)
    (holiday-float 10 1 2 <span class="org-string">"Columbus Day"</span>)
    (holiday-fixed 10 31 <span class="org-string">"Halloween"</span>)
    (holiday-fixed 11 11 <span class="org-string">"Veteran's Day"</span>)
    (holiday-float 11 4 4 <span class="org-string">"Thanksgiving"</span>)
    (holiday-easter-etc)
    (holiday-fixed 12 25 <span class="org-string">"Christmas"</span>)
    (solar-equinoxes-solstices)
    (holiday-sexp calendar-daylight-savings-starts
                  (format <span class="org-string">"Daylight Saving Time Begins %s"</span>
                          (solar-time-string
                           (/ calendar-daylight-savings-starts-time . #1=((float 60)))
                           calendar-standard-time-zone-name)))
    (holiday-sexp calendar-daylight-savings-ends
                  (format <span class="org-string">"Daylight Saving Time Ends %s"</span>
                          (solar-time-string
                           (/ calendar-daylight-savings-ends-time . #1#)
                           calendar-daylight-time-zone-name)))
    (holiday-easter-etc -47 <span class="org-string">"Carnaval"</span>)
    (holiday-easter-etc -2 <span class="org-string">"Paix&#227;o de Cristo"</span>)
    (holiday-fixed 4 21 <span class="org-string">"Tiradentes"</span>)
    (holiday-fixed 5 1 <span class="org-string">"Dia do Trabalhador"</span>)
    (holiday-fixed 7 25 <span class="org-string">"Pioneer Day"</span>)
    (holiday-easter-etc 60 <span class="org-string">"Corpus Christi"</span>)
    (holiday-fixed 9 7 <span class="org-string">"Dia da Independ&#234;ncia do Brasil"</span>)
    (holiday-fixed 10 12 <span class="org-string">"Nossa Senhora Aparecida"</span>)
    (holiday-fixed 11 2 <span class="org-string">"Finados"</span>)
    (holiday-fixed 11 15 <span class="org-string">"Proclama&#231;&#227;o da Rep&#250;blica"</span>)
    (holiday-fixed 12 25 <span class="org-string">"Natal"</span>))
  <span class="org-doc">"Only the ones I want (though frankly, I'd like to observe more)."</span>)


(<span class="org-keyword">setq-default</span> org-agenda-include-diary t)
(<span class="org-keyword">setq-default</span> calendar-holidays custom-holidays)
</pre>
</div>

<p>
Key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'calendar-mode-hook #'(<span class="org-keyword">lambda</span> ()
                                  (evil-local-set-key 'normal (kbd <span class="org-string">"q"</span>) #'(<span class="org-keyword">lambda</span> ()
                                                                            (<span class="org-keyword">interactive</span>)
                                                                            (calendar-exit t)))))
</pre>
</div>

<p>
Evil leader key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span class="org-string">"DEL"</span> #'calendar)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee02a34" class="outline-3">
<h3 id="orgee02a34">Mac-specific</h3>
<div class="outline-text-3" id="text-orgee02a34">
<p>
Use <code>command</code> key as <code>meta</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> mac-command-modifier 'meta)
</pre>
</div>

<p>
Reveal in Finder.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">reveal-in-osx-finder</span>)
</pre>
</div>

<p>
Make sure frame is not fullscreen before quitting (causes Emacs to
crash).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">before-evil-quit</span> (orig-fun <span class="org-type">&amp;rest</span> args)
  <span class="org-doc">"Work around macOS fullscreen quit crash."</span>
  (<span class="org-keyword">if</span> (one-window-p)
      (set-frame-parameter nil 'fullscreen nil)))
(advice-add 'evil-quit <span class="org-builtin">:before</span> #'before-evil-quit)
</pre>
</div>

<p>
Evil leader keybindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(evil-leader/set-key <span class="org-string">"R"</span> 'reveal-in-osx-finder)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde536c8" class="outline-3">
<h3 id="orgde536c8">Edit with Emacs</h3>
<div class="outline-text-3" id="text-orgde536c8">
<p>
Use GhostText to edit with Emacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> <span class="org-constant">atomic-chrome</span>
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq-default</span> atomic-chrome-buffer-open-style 'full)


  (atomic-chrome-start-server))
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
